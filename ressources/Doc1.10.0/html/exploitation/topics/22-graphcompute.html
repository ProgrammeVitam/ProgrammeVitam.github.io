

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="fr" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="fr" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5.9. Recalcul des données graphe &mdash; Documentation VITAM - Documentation d&#39;exploitation 1.10.0-1</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="5.10. Reconstruction" href="30-reconstruction.html" />
    <link rel="prev" title="5.8. Sauvegarde des données graphe (Log shipping)" href="21-graphstorage.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> VITAM - Documentation d'exploitation
          

          
            
            <img src="../_static/logo_vitam.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.10.0-1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html#rappels">2. Rappels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prerequis-competences.html">3. Expertises requises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">4. Architecture de la solution logicielle VITAM</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="_toc.html">5. Exploitation globale</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="10-accessgrants.html">5.1. Gestion des accès</a></li>
<li class="toctree-l2"><a class="reference internal" href="11-adminportals.html">5.2. Portails d’administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="12-appconfig.html">5.3. Paramétrage &amp; configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="14-miseajour.html">5.4. Déploiement / mises à jour</a></li>
<li class="toctree-l2"><a class="reference internal" href="15-maintenance.html">5.5. Interruption / maintenance</a></li>
<li class="toctree-l2"><a class="reference internal" href="16-backup_restore.html">5.6. Sauvegarde / restauration</a></li>
<li class="toctree-l2"><a class="reference internal" href="20-batchs.html">5.7. Batchs et traitements</a></li>
<li class="toctree-l2"><a class="reference internal" href="21-graphstorage.html">5.8. Sauvegarde des données graphe (Log shipping)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.9. Recalcul des données graphe</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#declenchement">5.9.1. Déclenchement</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="30-reconstruction.html">5.10. Reconstruction</a></li>
<li class="toctree-l2"><a class="reference internal" href="31-pra.html">5.11. Plan de Reprise d’Activité (PRA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="40-resynchronisation.html">5.12. Resynchronisation d’une offre</a></li>
<li class="toctree-l2"><a class="reference internal" href="50-ontologies.html">5.13. Procédure d’exploitation suite a la création ou la modification d’une ontologie</a></li>
<li class="toctree-l2"><a class="reference internal" href="60-forcedpause.html">5.14. Procédure d’exploitation pour la mise en pause forcée d’une opération</a></li>
<li class="toctree-l2"><a class="reference internal" href="70-certificate-revocation.html">5.15. Procédure d’exploitation pour la révocation des certificats SIA et Personae</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../monitoring/_toc.html">6. Suivi de l’état du système</a></li>
<li class="toctree-l1"><a class="reference internal" href="../composants/_toc.html">7. Exploitation des composants de la solution logicielle VITAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../external_app.html">8. Intégration d’une application externe dans Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshoot/_toc.html">9. Aide à l’exploitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FAQ/_toc.html">10. Questions Fréquemment Posées</a></li>
<li class="toctree-l1"><a class="reference internal" href="../include/_toc.html">11. Exploitation par composant</a></li>
<li class="toctree-l1"><a class="reference internal" href="../annexes/_toc.html">12. Annexes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">VITAM - Documentation d'exploitation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="_toc.html">5. Exploitation globale</a> &raquo;</li>
        
      <li>5.9. Recalcul des données graphe</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/topics/22-graphcompute.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="recalcul-des-donnees-graphe">
<h1>5.9. Recalcul des données graphe<a class="headerlink" href="#recalcul-des-donnees-graphe" title="Lien permanent vers ce titre">¶</a></h1>
<p>Il est possible de recalculer les données du graphe en utilisant une requête DSL. En effet, dans le cadre de la procédure de PRA, il est nécessaire de pouvoir détecter les unités archivistiques ayant un graphe incohérent (construire le DSL requis) selon la procédure de déclenchement décrite ci-dessous.</p>
<p>Le recalcul de graphe permet de rétablir la cohérence des données <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a>.</p>
<div class="admonition caution">
<p class="first admonition-title">Prudence</p>
<p class="last">Cette procédure s’applique à partir de la version <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> R8.</p>
</div>
<div class="admonition caution">
<p class="first admonition-title">Prudence</p>
<p class="last">En cas de données de graphe incohérentes, le résultat des requêtes DSL sur les unités archivistiques pourra être incorrect et l’application des filtres de sécurité définis dans les contrats d’accès pourront ne pas être pris en compte.</p>
</div>
<div class="section" id="declenchement">
<h2>5.9.1. Déclenchement<a class="headerlink" href="#declenchement" title="Lien permanent vers ce titre">¶</a></h2>
<p>Le recalcul de graphe est déclenché par l’appel au point d’API porté par l’URL suivante : <code class="docutils literal notranslate"><span class="pre">http://{{</span> <span class="pre">ip_admin</span> <span class="pre">}}:{{</span> <span class="pre">vitam.metadata.port_admin</span> <span class="pre">}}/metadata/v1/computegraph</span></code></p>
<p>Exemple d’appel à l’aide de curl :</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span>curl -s -X POST -H &quot;X-Tenant-Id: &lt;tenant&gt;&quot; -H &quot;Content-Type: application/json&quot; --user &quot;${VITAM_ADMIN_AUTH}&quot; --data @${CURRENT_DIR}/dslQuery.json ${URL}
</pre></div>
</div>
<p>Exemple de query DSL (dslQuery.json) :</p>
<div class="code json highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;$roots&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">&quot;aeaqaaaaaqhdytymabdeialenehzphiaaaeq&quot;</span><span class="p">,</span>
    <span class="s2">&quot;aeaqaaaaaqhdytymabdeialenehzpbyaaajq&quot;</span>

<span class="o">...</span> <span class="p">,</span> <span class="s2">&quot;guid_n&quot;</span>
  <span class="p">],</span>
  <span class="s2">&quot;$query&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="s2">&quot;$projection&quot;</span><span class="p">:</span> <span class="p">{}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>La valeur utilisée pour la basic authentication sont issues du fichier vault.yaml et prennent la forme suivante VITAM_ADMIN_AUTH={{ admin_basic_auth_user }}:{{ admin_basic_auth_password }}.
* Le paramètre <code class="docutils literal notranslate"><span class="pre">adminUser</span></code> correspond à la valeur admin_basic_auth_user déclarée dans le fichier <code class="docutils literal notranslate"><span class="pre">vitam_security.yml</span></code>
* Le paramètre <code class="docutils literal notranslate"><span class="pre">adminPassword</span></code> correspond à la valeur admin_basic_auth_password déclarée dans le fichier <code class="docutils literal notranslate"><span class="pre">vault-vitam.yml</span></code></p>
<div class="admonition caution">
<p class="first admonition-title">Prudence</p>
<p class="last">Si le DSL ne contient pas uniquement $root, alors la valeur du tenant positionnée dans le header X-Tenant-Id est essentielle car les index ES sont organisés par tenant.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="30-reconstruction.html" class="btn btn-neutral float-right" title="5.10. Reconstruction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="21-graphstorage.html" class="btn btn-neutral" title="5.8. Sauvegarde des données graphe (Log shipping)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Ce document est distribué sous les termes de la Licence Ouverte V2.0

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'1.10.0-1',
              LANGUAGE:'fr',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>


<!DOCTYPE html>
<html class="writer-html4" lang="fr" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>6.2. Métriques &mdash; Documentation VITAM - Documentation d&#39;exploitation 3.0.16</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'3.0.16',
              LANGUAGE:'fr',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="6.3. API de de supervision" href="22-status-api.html" />
    <link rel="prev" title="6.1. Veille et patchs sécurité" href="10-veille.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> VITAM - Documentation d'exploitation
          

          
            
            <img src="../_static/logo_vitam.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.0.16
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html#rappels">2. Rappels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prerequis-competences.html">3. Expertises requises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">4. Architecture de la solution logicielle VITAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/_toc.html">5. Exploitation globale</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="_toc.html">6. Suivi de l’état du système</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="10-veille.html">6.1. Veille et patchs sécurité</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">6.2. Métriques</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration">6.2.1. Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#activation-desactivation">6.2.1.1. Activation/désactivation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#registres">6.2.1.2. Registres</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reporters">6.2.1.3. Reporters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fichier-de-configuration">6.2.1.4. Fichier de configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#metier">6.2.2. Métier</a></li>
<li class="toctree-l3"><a class="reference internal" href="#metriques-techniques">6.2.3. Métriques techniques</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#metriques-systeme-critiques">6.2.3.1. Métriques système critiques</a></li>
<li class="toctree-l4"><a class="reference internal" href="#indicateurs-de-sla">6.2.3.2. Indicateurs de SLA</a></li>
<li class="toctree-l4"><a class="reference internal" href="#indicateurs-de-performance">6.2.3.3. Indicateurs de performance</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#visualisation">6.2.4. Visualisation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#discover">6.2.4.1. Discover</a></li>
<li class="toctree-l4"><a class="reference internal" href="#visualize">6.2.4.2. Visualize</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dashboards">6.2.4.3. Dashboards</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="22-status-api.html">6.3. API de de supervision</a></li>
<li class="toctree-l2"><a class="reference internal" href="24-logs.html">6.4. Logs</a></li>
<li class="toctree-l2"><a class="reference internal" href="25-audit.html">6.5. Audit</a></li>
<li class="toctree-l2"><a class="reference internal" href="26-capacity_planning.html">6.6. Gestion de la capacité</a></li>
<li class="toctree-l2"><a class="reference internal" href="27-security_sup.html">6.7. Suivi de l’état de sécurité</a></li>
<li class="toctree-l2"><a class="reference internal" href="30-alerting.html">6.8. Alerting</a></li>
<li class="toctree-l2"><a class="reference internal" href="40-workflow.html">6.9. Suivi des Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="41-logbook-consistency.html">6.10. Cohérence des journaux</a></li>
<li class="toctree-l2"><a class="reference internal" href="50-timers-systems.html">6.11. Liste des <cite>timers</cite> systemd</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../composants/_toc.html">7. Exploitation des COTS de la solution logicielle VITAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../include/_toc.html">8. Exploitation des composants de la solution logicielle VITAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../external_app.html">9. Intégration d’une application externe dans Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshoot/_toc.html">10. Aide à l’exploitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FAQ/_toc.html">11. Questions Fréquemment Posées</a></li>
<li class="toctree-l1"><a class="reference internal" href="../annexes/_toc.html">12. Annexes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">VITAM - Documentation d'exploitation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="_toc.html">6. Suivi de l’état du système</a> &raquo;</li>
        
      <li>6.2. Métriques</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/monitoring/20-metriques.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="metriques">
<h1>6.2. Métriques<a class="headerlink" href="#metriques" title="Lien permanent vers ce titre">¶</a></h1>
<p>La solution logicielle <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> intègre une solution de <cite>monitoring</cite> des applications à l’aide de métriques.
L’exploitant peut, s’il le souhaite, changer la configuration des remontées de métriques, ou bien utiliser celle par défaut proposée dans <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a>.</p>
<div class="section" id="configuration">
<h2>6.2.1. Configuration<a class="headerlink" href="#configuration" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="activation-desactivation">
<h3>6.2.1.1. Activation/désactivation<a class="headerlink" href="#activation-desactivation" title="Lien permanent vers ce titre">¶</a></h3>
<p>Il est possible de définir les composants sur lesquels activer/désactiver ces métriques.
Pour cela, il faut éditer le fichier <code class="docutils literal notranslate"><span class="pre">deployment/environments/group_vars/all/vitam_vars.yml</span></code> et définir, pour chaque composant,la valeur de la directive <code class="docutils literal notranslate"><span class="pre">metrics_enabled</span></code> (true/false).</p>
<p>A l’issue, lancer la commande de dépploiement (se reporter au <a class="reference internal" href="../introduction.html#term-din"><span class="xref std std-term">DIN</span></a>).</p>
</div>
<div class="section" id="registres">
<h3>6.2.1.2. Registres<a class="headerlink" href="#registres" title="Lien permanent vers ce titre">¶</a></h3>
<p>Par défaut, 3 registres de métriques sont créés pour toutes les applications VITAM :</p>
<ul class="simple">
<li>les métriques de Jersey</li>
<li>les métriques de la JVM (Java Virtual Machine)</li>
<li>les métriques «&nbsp;métier&nbsp;»</li>
</ul>
<p><strong>JERSEY</strong> : Les métriques Jersey correspondent à 3 métriques, des <em>Timers</em>, des <em>Meters</em>, et des <em>ExceptionMeters</em> qui vont être enregistrées pour chaque URI des API Rest de VITAM.</p>
<ul class="simple">
<li>Les <em>Meters</em> font office de compteurs. Ils sont incrémentés de 1 chaque fois qu’une URI est requêtée.</li>
<li>Les <em>Timers</em> font office de chronomètres. Ils chronomètrent le temps de réponse d’une URI chaque fois que celle-ci est requêtée.</li>
<li>Les <em>ExceptionMeters</em> font office de compteurs. Ils sont incrémentés de 1 chaque fois qu’une URI soulève une Exception dans le code.</li>
</ul>
<p><strong>JVM</strong> : Les métriques JVM correspondent à des <em>Gauges</em> qui enregistrent des valeurs de ressources système utilisées par la Java Virtual Machine pour chaque application VITAM.</p>
<p><strong>BUSINESS</strong> : Les métriques métiers correspondent à des métriques de n’importe quel type qui peuvent remonter toute donnée considérée utile dans une application VITAM.</p>
</div>
<div class="section" id="reporters">
<h3>6.2.1.3. Reporters<a class="headerlink" href="#reporters" title="Lien permanent vers ce titre">¶</a></h3>
<p>Par défaut, 2 reporters de métriques sont disponibles pour les applications VITAM. Les reporters de métriques sont en charge de collecter les valeurs des métriques à des intervalles réguliers.</p>
<p><strong>LogBack</strong> : le reporter LogBack affiche les valeurs des métriques dans LogBack.</p>
<p><strong>ELASTICSEARCH</strong> : le reporter ElasticSearch sauvegarde les valeurs des métriques dans une base de données ElasticSearch qui peut être configurée dans le fichier de configuration.</p>
</div>
<div class="section" id="fichier-de-configuration">
<h3>6.2.1.4. Fichier de configuration<a class="headerlink" href="#fichier-de-configuration" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le fichier de configuration des métriques est situé dans <code class="docutils literal notranslate"><span class="pre">/vitam/conf/&lt;service_id&gt;/vitam.metrics.conf</span></code>. Ce fichier contient la documentation nécessaire pour configurer correctement les métriques. Une description des clés YAML y est disponible.</p>
</div>
</div>
<div class="section" id="metier">
<h2>6.2.2. Métier<a class="headerlink" href="#metier" title="Lien permanent vers ce titre">¶</a></h2>
<p>Aucun métrique n’a encore été défini à ce stade du projet.</p>
</div>
<div class="section" id="metriques-techniques">
<h2>6.2.3. Métriques techniques<a class="headerlink" href="#metriques-techniques" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="metriques-systeme-critiques">
<h3>6.2.3.1. Métriques système critiques<a class="headerlink" href="#metriques-systeme-critiques" title="Lien permanent vers ce titre">¶</a></h3>
<p>Aucun métrique n’a encore défini à ce stade du projet.</p>
</div>
<div class="section" id="indicateurs-de-sla">
<h3>6.2.3.2. Indicateurs de SLA<a class="headerlink" href="#indicateurs-de-sla" title="Lien permanent vers ce titre">¶</a></h3>
<p>Aucun indicateur n’a encore défini à ce stade du projet.</p>
</div>
<div class="section" id="indicateurs-de-performance">
<h3>6.2.3.3. Indicateurs de performance<a class="headerlink" href="#indicateurs-de-performance" title="Lien permanent vers ce titre">¶</a></h3>
<p>Aucun indicateur n’a encore défini à ce stade du projet.</p>
</div>
</div>
<div class="section" id="visualisation">
<h2>6.2.4. Visualisation<a class="headerlink" href="#visualisation" title="Lien permanent vers ce titre">¶</a></h2>
<p>Si un reporter de type <strong>ElasticSearch</strong> est configuré, alors les métriques peuvent être visualisées via l’application web <a class="reference external" href="https://www.elastic.co/fr/products/kibana">Kibana</a>.</p>
<p>L’application Kibana comporte 4 sections qui seront développées :</p>
<ul class="simple">
<li><strong>Discover</strong></li>
<li><strong>Visualize</strong></li>
<li><strong>Dashboards</strong></li>
<li><strong>Settings</strong></li>
</ul>
<p>Néanmoins si vous souhaitez travailler avec Kibana, il est judicieux de consulter la documentation officielle. Celle-ci n’ayant pour but qu’une présentation sommaire de l’outil.</p>
<div class="admonition seealso">
<p class="first admonition-title">Voir aussi</p>
<p class="last"><a class="reference external" href="https://www.elastic.co/guide/en/kibana/current/index.html">Documentation officielle de Kibana</a></p>
</div>
<div class="section" id="discover">
<h3>6.2.4.1. Discover<a class="headerlink" href="#discover" title="Lien permanent vers ce titre">¶</a></h3>
<p>La section <strong>Discover</strong> permet de consulter rapidement les données présentes dans un index d’ElasticSearch. Pour cela, il suffit de séléctionner un index dans la barre latérale gauche, de choisir les champs que l’on souhaite consulter (optionnel) et les données apparraissent triées par ordre chronologique décroissant.</p>
<p>Il est possible d’effectuer des recherches poussées sur les documents, comme des expressions régulières, grâce à la barre de recherche en haut de la page. Une fois la recherche executée, il peut être utile de la sauvegarder afin de la réutiliser pour des visualisations.</p>
<div class="figure align-center">
<img alt="../_images/kibana-discover.png" src="../_images/kibana-discover.png" />
</div>
</div>
<div class="section" id="visualize">
<h3>6.2.4.2. Visualize<a class="headerlink" href="#visualize" title="Lien permanent vers ce titre">¶</a></h3>
<p>La section <strong>Visualize</strong> permet de consulter les données présentes dans ElasticSearch à travers différents graphiques statistiques. Les graphiques disponibles sont :</p>
<ul class="simple">
<li><strong>Area chart</strong> : utile pour un regroupement de séries chronologiques dans lequel le total des séries est plus important que la différence entre plusieurs séries.</li>
<li><strong>Data table</strong> : un tableau de données classique.</li>
<li><strong>Line chart</strong> : graphique pour des séries temporelles. Très utile pour comparer deux séries entre elles.</li>
<li><strong>Markdown widget</strong> : utile pour insérer informations sur un dashboard Kibana.</li>
<li><strong>Metric</strong> : représentation d’une aggrégation de données sous la forme d’un seul nombre.</li>
<li><strong>Pie chart</strong> : un diagramme circulaire classique.</li>
<li><strong>Tile map</strong> :  représentation de coordonées géographiques sur une carte.</li>
<li><strong>Vertical bar chart</strong> : un histogramme classique.</li>
</ul>
<p>La barre latérale gauche du panneau de visualisation permet de configurer la donnée à représenter. Pour l’axe des Y, il est impératif d’utiliser un aggrégation (moyenne, minimum/maximum, écart type…) sur une valeur pour la représenter. En fonction du graphique sélectionné, il est possible de configurer l’axe des X, toujours au moyen d’aggrégations (dates, date range, terme…).</p>
<p>En haut se situe la même barre de recherche que sur la partie <strong>Discover</strong>, qui permet d’affiner son graphique en effectuant des tris sur sa donnée.</p>
<div class="figure align-center">
<img alt="../_images/kibana-visualization.png" src="../_images/kibana-visualization.png" />
</div>
</div>
<div class="section" id="dashboards">
<h3>6.2.4.3. Dashboards<a class="headerlink" href="#dashboards" title="Lien permanent vers ce titre">¶</a></h3>
<p>La section <strong>Dashboard</strong> permet de regrouper plusieurs graphiques pour constituer un dashboard. Pour ce faire il suffit d’importer des graphiques avec le bouton <strong>«&nbsp;+&nbsp;»</strong> en haut à droite.</p>
<div class="figure align-center">
<img alt="../_images/kibana-dashboards.png" src="../_images/kibana-dashboards.png" />
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="22-status-api.html" class="btn btn-neutral float-right" title="6.3. API de de supervision" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="10-veille.html" class="btn btn-neutral float-left" title="6.1. Veille et patchs sécurité" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright Ce document est distribué sous les termes de la Licence Ouverte V2.0.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
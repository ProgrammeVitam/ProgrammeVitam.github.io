

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Workflow d’administration d’un référentiel des services agent &mdash; documentation VITAM - Modèle de workflow 0.26.1</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Recherche" href="../search.html"/>
    <link rel="top" title="documentation VITAM - Modèle de workflow 0.26.1" href="../index.html"/>
        <link rel="up" title="MASTERDATA" href="_toc_masterdata.html"/>
        <link rel="next" title="Workflow d’administration et de mise à jour d’un référentiel des contrats d’entrée" href="ingest-contracts.html"/>
        <link rel="prev" title="Workflow d’import d’un référentiel des formats" href="formats.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> VITAM - Modèle de workflow
          

          
            
            <img src="../_static/LogoVitamGrand2.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.26.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../audit/_toc_audit.html">AUDIT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dip/_toc_dip.html">DIP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ingest/_toc_ingest.html">INGEST</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="_toc_masterdata.html">MASTERDATA</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="workflow-tree.html">Workflow d&#8217;import d&#8217;un arbre de positionnement</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html">Workflow d&#8217;administration d&#8217;un référentiel de règles de gestion</a></li>
<li class="toctree-l2"><a class="reference internal" href="formats.html">Workflow d&#8217;import d&#8217;un référentiel des formats</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Workflow d&#8217;administration d&#8217;un référentiel des services agent</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#processus-d-import-et-mise-a-jour-d-un-referentiel-de-services-agents-stp-import-agencies">Processus d&#8217;import  et mise à jour d&#8217;un référentiel de services agents (STP_IMPORT_AGENCIES)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#import-d-un-referentiel-de-services-agents-stp-import-agencies">Import d&#8217;un référentiel de services agents (STP_IMPORT_AGENCIES)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#verification-des-contrats-utilises-stp-import-agencies-used-contract">Vérification des contrats utilisés (STP_IMPORT_AGENCIES.USED_CONTRACT)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#verification-des-contrats-utilises-stp-import-agencies-used-au">Vérification des contrats utilisés (STP_IMPORT_AGENCIES.USED_AU)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creation-du-rapport-au-format-json-stp-agencies-report">Création du rapport au format JSON (STP_AGENCIES_REPORT)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sauvegarde-du-csv-d-import-stp-agencies-csv">Sauvegarde du CSV d&#8217;import (STP_AGENCIES_CSV)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sauvegarde-d-une-copie-de-la-base-de-donnee-stp-agencies-json">Sauvegarde d&#8217;une copie de la base de donnée (STP_AGENCIES_JSON)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#structure-du-rapport-d-administration-du-referentiel-des-regles-de-gestion">Structure du rapport d&#8217;administration du référentiel des règles de gestion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ingest-contracts.html">Workflow d&#8217;administration et de mise à jour d&#8217;un référentiel des contrats d&#8217;entrée</a></li>
<li class="toctree-l2"><a class="reference internal" href="access-contracts.html">Workflow d&#8217;administration d&#8217;un référentiel des contrats d&#8217;accès</a></li>
<li class="toctree-l2"><a class="reference internal" href="profiles.html">Workflow d&#8217;import d&#8217;un référentiel des profils</a></li>
<li class="toctree-l2"><a class="reference internal" href="security_profiles.html">Workflow d&#8217;administration d&#8217;un référentiel des profils de sécurité</a></li>
<li class="toctree-l2"><a class="reference internal" href="contextes.html">Workflow d&#8217;administration d&#8217;un référentiel des contextes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../traceability/_toc_traceability.html">TRACEABILITY</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rules_update/_toc_rules_update.html">UPDATE</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">VITAM - Modèle de workflow</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="_toc_masterdata.html">MASTERDATA</a> &raquo;</li>
      
    <li>Workflow d&#8217;administration d&#8217;un référentiel des services agent</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/masterdata/agencies.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="workflow-d-administration-d-un-referentiel-des-services-agent">
<h1>Workflow d&#8217;administration d&#8217;un référentiel des services agent<a class="headerlink" href="#workflow-d-administration-d-un-referentiel-des-services-agent" title="Lien permanent vers ce titre">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Lien permanent vers ce titre">¶</a></h2>
<p>Cette section décrit le processus (workflow) permettant d&#8217;importer un référentiel de services agents</p>
</div>
<div class="section" id="processus-d-import-et-mise-a-jour-d-un-referentiel-de-services-agents-stp-import-agencies">
<h2>Processus d&#8217;import  et mise à jour d&#8217;un référentiel de services agents (STP_IMPORT_AGENCIES)<a class="headerlink" href="#processus-d-import-et-mise-a-jour-d-un-referentiel-de-services-agents-stp-import-agencies" title="Lien permanent vers ce titre">¶</a></h2>
<p>L&#8217;import d&#8217;un référentiel de services agent permet de vérifier le formalisme de ce dernier, notamment que les données obligatoires sont bien présentes pour chacun des agents. Tous les éléments réalisés au cours de ce processus sont exécutés dans une seule étape. Cet import concerne aussi bien l&#8217;import initial (pas de services agents pré-existant) que la mise à jour du référentiel.</p>
<div class="section" id="import-d-un-referentiel-de-services-agents-stp-import-agencies">
<h3>Import d&#8217;un référentiel de services agents (STP_IMPORT_AGENCIES)<a class="headerlink" href="#import-d-un-referentiel-de-services-agents-stp-import-agencies" title="Lien permanent vers ce titre">¶</a></h3>
<blockquote>
<div><ul>
<li><p class="first"><strong>Type</strong> :  bloquant</p>
</li>
<li><p class="first"><strong>Règle</strong> :  le fichier rempli les conditions suivantes :</p>
<ul class="simple">
<li>il est au format CSV</li>
<li>les informations suivantes sont toutes décrites dans l&#8217;ordre exact pour chacun des services agents :<ul>
<li>Identifier</li>
<li>Name</li>
<li>Description (optionnel)</li>
</ul>
</li>
<li>l&#8217;identifiant doit être unique</li>
</ul>
</li>
<li><p class="first"><strong>Status</strong> :</p>
<ul>
<li><p class="first">OK : le fichier respecte les règles (STP_IMPORT_AGENCIES.OK=Succès du processus d&#8217;import du référentiel des services agents)</p>
</li>
<li><p class="first">KO :</p>
<blockquote>
<div><ul class="simple">
<li>Cas 1 : une information concernant les services agent est manquante (Identifier, Name, Description) (STP_IMPORT_AGENCIES.KO=Échec du processus d&#8217;import du référentiel des services agents)</li>
<li>Cas 2 : un service agent qui était présent dans la base a été supprimé (STP_IMPORT_AGENCIES.DELETION.KO=Échec du processus d&#8217;import du référentiel des services agents : Des services agents supprimés sont présents dans le référentiel des services agents)</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">FATAL : une erreur technique est survenue lors de l&#8217;import du référentiel des services agents (STP_IMPORT_AGENCIES.FATAL=Erreur fatale lors du processus d&#8217;import du référentiel des service agents)</p>
</li>
</ul>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="verification-des-contrats-utilises-stp-import-agencies-used-contract">
<h3>Vérification des contrats utilisés (STP_IMPORT_AGENCIES.USED_CONTRACT)<a class="headerlink" href="#verification-des-contrats-utilises-stp-import-agencies-used-contract" title="Lien permanent vers ce titre">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><strong>Règle</strong> :  contrôle des contrats utilisant des services agents modifiés</li>
<li><strong>Status</strong> :<ul>
<li>OK : aucun des services agent utilisés par des contrats d&#8217;accès n&#8217;a été modifié (STP_IMPORT_AGENCIES.USED_CONTRACT.OK=Succès du processus de vérification des services agents utilisés dans les contrats d&#8217;accès)</li>
<li>WARNING : un ou plusieurs services agent utilisé par des contrats d&#8217;accès ont été modifiés (STP_IMPORT_AGENCIES.USED_CONTRACT.WARNING=Avertissement lors du processus de vérification des services agents utilisés dans les contrats d&#8217;accès)</li>
<li>KO : pas de cas KO</li>
<li>FATAL : une erreur technique est survenue lors de la vérification des services agents utilisés dans les contrats d&#8217;accès (STP_IMPORT_AGENCIES.USED_CONTRACT.FATAL=Erreur fatale lors du processus de vérification des services agents utilisés dans les contrats d&#8217;accès)</li>
</ul>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="verification-des-contrats-utilises-stp-import-agencies-used-au">
<h3>Vérification des contrats utilisés (STP_IMPORT_AGENCIES.USED_AU)<a class="headerlink" href="#verification-des-contrats-utilises-stp-import-agencies-used-au" title="Lien permanent vers ce titre">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><strong>Règle</strong> :  contrôle des unité archivistiques référençant des serivces agents modifiés</li>
<li><strong>Status</strong> :<ul>
<li>OK : aucun service agent référencé par les unités archivistiques n&#8217;ont été modifiés (STP_IMPORT_AGENCIES.USED_AU.OK=Succès du processus de vérification des services agents utilisés par les unités archivistiques)</li>
<li>WARNING : au moins un service agent référencé par une unité archivistique a été modifié (STP_IMPORT_AGENCIES.USED_AU.WARNING=Avertissement lors du processus de vérification des services agents utilisés par les unités archivistiques)</li>
<li>KO : pas de cas KO</li>
<li>FATAL : une erreur technique est survenue lors de la vérification des services agents utilisés par les unités archivistiques (STP_IMPORT_AGENCIES.USED_AU.FATAL=Erreur fatale lors du processus de vérification des services agents utilisés par les unités archivistiques)</li>
</ul>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="creation-du-rapport-au-format-json-stp-agencies-report">
<h3>Création du rapport au format JSON (STP_AGENCIES_REPORT)<a class="headerlink" href="#creation-du-rapport-au-format-json-stp-agencies-report" title="Lien permanent vers ce titre">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><strong>Règle</strong> :  création du rapport d&#8217;import de référentiel des services agent</li>
<li><strong>Status</strong> :<ul>
<li>OK : le rapport d&#8217;import du référentiel des services agent a bien été créé (STP_AGENCIES_REPORT.OK=Succès du processus de génération du rapport d&#8217;import du référentiel des services agents)</li>
<li>KO : pas de cas KO</li>
<li>FATAL : une erreur technique est survenue lors de la création du rapport d&#8217;import de référentiel des services agents (STP_AGENCIES_REPORT.FATAL=Erreur fatale lors du processus de génération du rapport d&#8217;import du référentiel des services agents)</li>
</ul>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="sauvegarde-du-csv-d-import-stp-agencies-csv">
<h3>Sauvegarde du CSV d&#8217;import (STP_AGENCIES_CSV)<a class="headerlink" href="#sauvegarde-du-csv-d-import-stp-agencies-csv" title="Lien permanent vers ce titre">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><strong>Règle</strong> : sauvegarde de fichier d&#8217;import de référentiel des services agent</li>
<li><strong>Status</strong> :<ul>
<li>OK : le fichier d&#8217;import du référentiel des services agent a bien été sauvegardé (STP_IMPORT_AGENCIES_CSV.OK=Succès du processus d&#8217;enregistrement du fichier d&#8217;import du référentiel des services agents)</li>
<li>KO : pas de cas KO</li>
<li>FATAL : une erreur technique est survenue lors de la sauvegarde de fichier d&#8217;import de référentiel des services agent (STP_IMPORT_AGENCIES_CSV.FATAL=Erreur fatale lors du processus d&#8217;enregistrement du fichier d&#8217;import du référentiel des services agents)</li>
</ul>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="sauvegarde-d-une-copie-de-la-base-de-donnee-stp-agencies-json">
<h3>Sauvegarde d&#8217;une copie de la base de donnée (STP_AGENCIES_JSON)<a class="headerlink" href="#sauvegarde-d-une-copie-de-la-base-de-donnee-stp-agencies-json" title="Lien permanent vers ce titre">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><strong>Règle</strong> : création d&#8217;une copie de la base de données contenant le référentiel des services agent</li>
<li><strong>Status</strong> :<ul>
<li>OK : la copie de la base de donnée contenant le référentiel des services agent a été crée avec succès (STP_IMPORT_AGENCIES_JSON.OK=Succès du processus d&#8217;enregistrement de la base de donnée contenant le référentiel des services agents)</li>
<li>KO : pas de cas KO</li>
<li>FATAL : une erreur technique est survenue lors de la création d&#8217;une copie de la base de données contenant le référentiel des services agent (STP_IMPORT_AGENCIES_JSON.FATAL=Erreur fatale lors du processus d&#8217;enregistrement de la base de donnée contenant le référentiel des services agents)</li>
</ul>
</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="structure-du-rapport-d-administration-du-referentiel-des-regles-de-gestion">
<h2>Structure du rapport d&#8217;administration du référentiel des règles de gestion<a class="headerlink" href="#structure-du-rapport-d-administration-du-referentiel-des-regles-de-gestion" title="Lien permanent vers ce titre">¶</a></h2>
<p>Lorsqu&#8217;un nouveau référentiel est importé, la solution logicielle Vitam génère un rapport de l&#8217;opération. Ce rapport est en 3 parties :</p>
<blockquote>
<div><ul class="simple">
<li>&#8220;Journal des opérations&#8221; contient :<ul>
<li>evType : le type d&#8217;opération. Dans le cadre de ce rapport, il s&#8217;agit toujours de &#8220;STP_IMPORT_AGENCIES&#8221;</li>
<li>evDateTime : la date et l&#8217;heure de l&#8217;opération d&#8217;import</li>
<li>evId : l&#8217;identifiant de l&#8217;opération</li>
</ul>
</li>
<li>&#8220;Error&#8221; : détail les erreurs en indiquant :<ul>
<li>line : le numéro de la ligne du rapport CSV générant l&#8217;erreur</li>
<li>Code : le code d&#8217;erreur</li>
<li>Message : le message associée à l&#8217;erreur</li>
<li>Information additionnelle : une précision sur l&#8217;erreur, comme par exemple le contenu du champs qui l&#8217;a provoquée</li>
</ul>
</li>
<li>&#8220;InsertAgencies&#8221; : contient l&#8217;identifiant des services agents ajoutés</li>
<li>&#8220;UpdatedAgencies&#8221; : liste l&#8217;identifiant des services agents modifiés</li>
<li>&#8220;UsedAgencies By Contrat&#8221; : liste l&#8217;identifiant des services agents modifiés qui sont utilisés par des contrats d&#8217;accès</li>
<li>&#8220;UsedAgencies By AU&#8221; : liste l&#8217;identifiant des services agents modifiés qui sont utilisés dans des unités archivistique</li>
</ul>
</div></blockquote>
<p><strong>Exemple 1 : modification et ajout d&#8217;un service agent</strong></p>
<p>Le rapport généré est :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
      <span class="s2">&quot;Journal des op</span><span class="se">\u00E9</span><span class="s2">rations&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;evType&quot;</span><span class="p">:</span> <span class="s2">&quot;STP_IMPORT_AGENCIES&quot;</span><span class="p">,</span>
              <span class="s2">&quot;evDateTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2017-11-02T15:28:34.523&quot;</span><span class="p">,</span>
              <span class="s2">&quot;evId&quot;</span><span class="p">:</span> <span class="s2">&quot;aecaaaaaacevq6lcaamxsak7pvmsdbqaaaaq&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;InsertAgencies&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;fr.gouv.vitam.common.model.administration.AgenciesModel@5c13a55d&quot;</span><span class="p">],</span>
      <span class="s2">&quot;UpdatedAgencies&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Identifier0&quot;</span><span class="p">],</span>
      <span class="s2">&quot;UsedAgencies By Contrat&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Identifier0&quot;</span><span class="p">],</span>
      <span class="s2">&quot;UsedAgencies By AU&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Exemple 2 : tentative d&#8217;ajout d&#8217;un service agent</strong></p>
<p>Le rapport généré est :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
      <span class="s2">&quot;JDO&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;evType&quot;</span><span class="p">:</span> <span class="s2">&quot;STP_IMPORT_AGENCIES&quot;</span><span class="p">,</span>
              <span class="s2">&quot;evDateTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2017-11-02T15:36:03.976&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;line 4&quot;</span><span class="p">:</span> <span class="p">[{</span>
                      <span class="s2">&quot;Code&quot;</span><span class="p">:</span> <span class="s2">&quot;STP_IMPORT_AGENCIES_MISSING_INFORMATIONS.KO&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;Message&quot;</span><span class="p">:</span> <span class="s2">&quot;!STP_IMPORT_AGENCIES_MISSING_INFORMATIONS!&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;Information additionnelle&quot;</span><span class="p">:</span> <span class="s2">&quot;Name&quot;</span>
              <span class="p">}]</span>
      <span class="p">},</span>
      <span class="s2">&quot;usedAgenciesByContracts&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="s2">&quot;usedAgenciesByAU&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ingest-contracts.html" class="btn btn-neutral float-right" title="Workflow d’administration et de mise à jour d’un référentiel des contrats d’entrée" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="formats.html" class="btn btn-neutral" title="Workflow d’import d’un référentiel des formats" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Ce document est distribué sous les termes de la Licence Ouverte V2.0.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.26.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4.2.3. Paramétrages supplémentaires &mdash; documentation VITAM - Documentation d&#39;installation 0.26.1</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Recherche" href="../search.html"/>
    <link rel="top" title="documentation VITAM - Documentation d&#39;installation 0.26.1" href="../index.html"/>
        <link rel="up" title="4. Procédures d’installation / mise à jour" href="_toc.html"/>
        <link rel="next" title="4.2.4. Procédure de première installation" href="30-installation.html"/>
        <link rel="prev" title="4.2.2.2. Cas 2: Je dispose d’une PKI" href="certificats/pki_externe.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> VITAM - Documentation d'installation
          

          
            
            <img src="../_static/LogoVitamGrand2.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.26.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html#rappels">2. Rappels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pre_install/_toc.html">3. Prérequis à l&#8217;installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="_toc.html">4. Procédures d&#8217;installation / mise à jour</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="_toc.html#verifications-prealables">4.1. Vérifications préalables</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="_toc.html#procedures">4.2. Procédures</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="10-configuration.html">4.2.1. Configuration du déploiement</a></li>
<li class="toctree-l3"><a class="reference internal" href="20-certificats.html">4.2.2. Gestion des certificats</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">4.2.3. Paramétrages supplémentaires</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tuning-jvm">4.2.3.1. Tuning JVM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parametrage-de-l-antivirus-ingest-externe">4.2.3.2. Paramétrage de l&#8217;antivirus (ingest-externe)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parametrage-des-certificats-externes-externe">4.2.3.3. Paramétrage des certificats externes (*-externe)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parametrage-de-la-centralisation-des-logs-vitam">4.2.3.4. Paramétrage de la centralisation des logs Vitam</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fichiers-complementaires">4.2.3.5. Fichiers complémentaires</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="30-installation.html">4.2.4. Procédure de première installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="80-extras.html">4.2.5. Elements extras de l&#8217;installation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../update/_toc.html">5. Procédures de mise à jour</a></li>
<li class="toctree-l1"><a class="reference internal" href="../post_install/_toc.html">6. Post installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../annexes/_toc.html">7. Annexes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">VITAM - Documentation d'installation</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="_toc.html">4. Procédures d&#8217;installation / mise à jour</a> &raquo;</li>
      
    <li>4.2.3. Paramétrages supplémentaires</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/installation/21-addons.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="parametrages-supplementaires">
<h1>4.2.3. Paramétrages supplémentaires<a class="headerlink" href="#parametrages-supplementaires" title="Lien permanent vers ce titre">¶</a></h1>
<div class="section" id="tuning-jvm">
<span id="update-jvm"></span><h2>4.2.3.1. Tuning JVM<a class="headerlink" href="#tuning-jvm" title="Lien permanent vers ce titre">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Cette section est en cours de développement.</p>
</div>
<div class="admonition caution">
<p class="first admonition-title">Prudence</p>
<p class="last">en cas de colocalisation, bien prendre en compte la taille JVM de chaque composant (VITAM : -Xmx512m par défaut) pour éviter de swapper.</p>
</div>
<p>Un tuning fin des paramètres JVM de chaque composant VITAM est possible
Pour cela, il faut modifier le fichier <code class="docutils literal"><span class="pre">group_vars/all/jvm_opts.yml</span></code></p>
<p>Pour chaque composant, il est possible de modifier ces 3 variables:</p>
<ul class="simple">
<li>memory: paramètres Xms et Xmx</li>
<li>gc: parmètres gc</li>
<li>java: autres paramètres java</li>
</ul>
</div>
<div class="section" id="parametrage-de-l-antivirus-ingest-externe">
<h2>4.2.3.2. Paramétrage de l&#8217;antivirus (ingest-externe)<a class="headerlink" href="#parametrage-de-l-antivirus-ingest-externe" title="Lien permanent vers ce titre">¶</a></h2>
<p>L&#8217;antivirus utilisé par ingest-externe est modifiable (par défaut, ClamAV) ; pour cela :</p>
<ul>
<li><p class="first">Modifier le fichier <code class="docutils literal"><span class="pre">environments/group_vars/all/vitam_vars.yml</span></code> pour indiquer le nom de l&#8217;antivirus qui sera utilisé (norme : scan-&lt;nom indiqué dans vitam-vars.yml&gt;.sh)</p>
</li>
<li><p class="first">Créer un shell (dont l&#8217;extension doit être <code class="docutils literal"><span class="pre">.sh</span></code>) sous <code class="docutils literal"><span class="pre">environments/antivirus/</span></code> (norme : scan-&lt;nom indiqué dans vitam-vars.yml&gt;.sh) ; prendre comme modèle le fichier <code class="docutils literal"><span class="pre">scan-clamav.sh</span></code>. Ce script shell doit respecter le contrat suivant :</p>
<blockquote>
<div><ul>
<li><p class="first">Argument : chemin absolu du fichier à analyser</p>
</li>
<li><dl class="first docutils">
<dt>Sémantique des codes de retour</dt>
<dd><ul class="first last simple">
<li>0 : Analyse OK - pas de virus</li>
<li>1 : Analyse OK - virus trouvé et corrigé</li>
<li>2 : Analyse OK - virus trouvé mais non corrigé</li>
<li>3 : Analyse NOK</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Contenu à écrire dans stdout / stderr</dt>
<dd><ul class="first last simple">
<li>stdout : Nom des virus trouvés, un par ligne ; Si échec (code 3) : raison de l’échec</li>
<li>stderr : Log «&nbsp;brut&nbsp;» de l’antivirus</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="admonition caution">
<p class="first admonition-title">Prudence</p>
<p class="last">En cas de remplacement de clamAV par un autre antivirus, l&#8217;installation de celui-ci devient dès lors un prérequis de l&#8217;installation et le script doit être testé.</p>
</div>
</div>
<div class="section" id="parametrage-des-certificats-externes-externe">
<h2>4.2.3.3. Paramétrage des certificats externes (*-externe)<a class="headerlink" href="#parametrage-des-certificats-externes-externe" title="Lien permanent vers ce titre">¶</a></h2>
<p>Se reporter au chapitre dédié à la gestion des certificats: <a class="reference internal" href="20-certificats.html"><span class="doc">Gestion des certificats</span></a></p>
</div>
<div class="section" id="parametrage-de-la-centralisation-des-logs-vitam">
<h2>4.2.3.4. Paramétrage de la centralisation des logs Vitam<a class="headerlink" href="#parametrage-de-la-centralisation-des-logs-vitam" title="Lien permanent vers ce titre">¶</a></h2>
<p>2 cas sont possibles :</p>
<ul class="simple">
<li>Utiliser le sous-système de gestion des logs fournis par la solution logicielle VITAM ;</li>
<li>Utiliser un SIEM tiers.</li>
</ul>
<div class="section" id="gestion-par-vitam">
<h3>4.2.3.4.1. Gestion par Vitam<a class="headerlink" href="#gestion-par-vitam" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="docutils">
<dt>Pour une gestion des logs par Vitam, il est nécessaire de déclarer les serveurs ad-hoc dans le fichier d&#8217;inventaire pour les 3 groupes suivants:</dt>
<dd><ul class="first last simple">
<li>hosts-logstash</li>
<li>hosts-kibana-log</li>
<li>hosts-elasticsearch-log</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="redirection-des-logs-sur-un-siem-tiers">
<h3>4.2.3.4.2. Redirection des logs sur un SIEM tiers<a class="headerlink" href="#redirection-des-logs-sur-un-siem-tiers" title="Lien permanent vers ce titre">¶</a></h3>
<p>En configuration par défaut, les logs Vitam sont tout d&#8217;abord routés vers un serveur rsyslog installé sur chaque machine.
Il est possible d&#8217;en modifier le routage, qui par défaut redirige vers le serveur logstash via le protocole syslog en TCP.</p>
<p>Pour cela, il est nécessaire de placer un fichier de configuration dédié dans le dossier <code class="docutils literal"><span class="pre">/etc/rsyslog.d/</span></code> ; ce fichier sera automatiquement pris en compte par rsyslog. Pour la syntaxe de ce fichier de configuration rsyslog, se référer à la <a class="reference external" href="http://www.rsyslog.com/doc/v7-stable/">documentation rsyslog</a>.</p>
<div class="admonition tip">
<p class="first admonition-title">Astuce</p>
<p class="last">Pour cela, il peut être utile de s&#8217;inspirer du fichier de référence VITAM <code class="docutils literal"><span class="pre">deployment/ansible-vitam/roles/rsyslog/templates/vitam_transport.conf.j2</span></code> (attention, il s&#8217;agit d&#8217;un fichier template ansible, non directement convertible en fichier de configuration sans en ôter les directives jinja2).</p>
</div>
</div>
</div>
<div class="section" id="fichiers-complementaires">
<h2>4.2.3.5. Fichiers complémentaires<a class="headerlink" href="#fichiers-complementaires" title="Lien permanent vers ce titre">¶</a></h2>
<p>A titre informatif, le positionnement des variables ainsi que des dérivations des déclarations de variables sont effectuées dans les fichiers suivants :</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">environments</span></code> <code class="docutils literal"><span class="pre">/group_vars/all/vitam_vars.yml</span></code>, comme suit :</p>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nn">---</span>

<span class="c1">### global ###</span>

<span class="c1"># TODO MAYBE : permettre la surcharge avec une syntax du genre vitamopts.folder_root | default(vitam_default.folder_root) dans les templates ?</span>

<span class="l l-Scalar l-Scalar-Plain">vitam_defaults</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">folder</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">root_path</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">/vitam</span>
        <span class="l l-Scalar l-Scalar-Plain">folder_permission</span><span class="p p-Indicator">:</span> <span class="s">&quot;0750&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">conf_permission</span><span class="p p-Indicator">:</span> <span class="s">&quot;0640&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">users</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">vitam</span><span class="p p-Indicator">:</span> <span class="s">&quot;vitam&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">vitamdb</span><span class="p p-Indicator">:</span> <span class="s">&quot;vitamdb&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">group</span><span class="p p-Indicator">:</span> <span class="s">&quot;vitam&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">services</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">log_level</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">WARN</span>
        <span class="l l-Scalar l-Scalar-Plain">start_timeout</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">150</span>
        <span class="l l-Scalar l-Scalar-Plain">stop_timeout</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">3600</span>
        <span class="l l-Scalar l-Scalar-Plain">port_http_timeout</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">86400</span>
    <span class="c1"># Filter for the vitam package version to install</span>
    <span class="c1"># FIXME : commented as has to be removed becuase doesn&#39;t work under Debain</span>
    <span class="c1">#package_version: &quot;*&quot;</span>
    <span class="c1">### Trust X-SSL-CLIENT-CERT header for external api auth ? (true | false) ###</span>
    <span class="l l-Scalar l-Scalar-Plain">vitam_ssl_user_header</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="c1"># syslog_facility</span>
    <span class="l l-Scalar l-Scalar-Plain">syslog_facility</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">local0</span>


<span class="c1">### consul ###</span>
<span class="c1"># FIXME: Consul à la racine pour le moment à cause de problèmes de récursivité dans le parsing yaml</span>
<span class="c1"># TODO : consul_domain should be in inventory as choosable by customer</span>
<span class="l l-Scalar l-Scalar-Plain">consul_domain</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">consul</span>
<span class="l l-Scalar l-Scalar-Plain">consul_component</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">consul</span>
<span class="l l-Scalar l-Scalar-Plain">consul_folder_conf</span><span class="p p-Indicator">:</span> <span class="s">&quot;{{vitam_defaults.folder.root_path}}/conf/{{consul_component}}&quot;</span>



<span class="c1">### Composants Vitam ###</span>

<span class="l l-Scalar l-Scalar-Plain">vitam</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">accessexternal</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">vitam_component</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">access-external</span>
        <span class="l l-Scalar l-Scalar-Plain">host</span><span class="p p-Indicator">:</span> <span class="s">&quot;access-external.service.{{consul_domain}}&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">port_http</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">8102</span>
        <span class="l l-Scalar l-Scalar-Plain">port_admin</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">28102</span>
        <span class="l l-Scalar l-Scalar-Plain">port_https</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">8444</span>
        <span class="l l-Scalar l-Scalar-Plain">baseuri</span><span class="p p-Indicator">:</span> <span class="s">&quot;access-external&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">https_enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="l l-Scalar l-Scalar-Plain">secret_platform</span><span class="p p-Indicator">:</span> <span class="s">&quot;false&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">accessinternal</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">vitam_component</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">access-internal</span>
        <span class="l l-Scalar l-Scalar-Plain">host</span><span class="p p-Indicator">:</span> <span class="s">&quot;access-internal.service.{{consul_domain}}&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">port_http</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">8101</span>
        <span class="l l-Scalar l-Scalar-Plain">port_admin</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">28101</span>
        <span class="l l-Scalar l-Scalar-Plain">baseuri</span><span class="p p-Indicator">:</span> <span class="s">&quot;access-internal&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">https_enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="l l-Scalar l-Scalar-Plain">secret_platform</span><span class="p p-Indicator">:</span> <span class="s">&quot;true&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">functional_administration</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">vitam_component</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">functional-administration</span>
        <span class="l l-Scalar l-Scalar-Plain">host</span><span class="p p-Indicator">:</span> <span class="s">&quot;functional-administration.service.{{consul_domain}}&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">port_http</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">8004</span>
        <span class="l l-Scalar l-Scalar-Plain">port_admin</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">18004</span>
        <span class="l l-Scalar l-Scalar-Plain">baseuri</span><span class="p p-Indicator">:</span> <span class="s">&quot;functional-administration&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">https_enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="l l-Scalar l-Scalar-Plain">secret_platform</span><span class="p p-Indicator">:</span> <span class="s">&quot;true&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">cluster_name</span><span class="p p-Indicator">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">elasticsearch.data.cluster_name</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">ingestexternal</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">vitam_component</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ingest-external</span>
        <span class="l l-Scalar l-Scalar-Plain">host</span><span class="p p-Indicator">:</span> <span class="s">&quot;ingest-external.service.{{consul_domain}}&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">port_http</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">8001</span>
        <span class="l l-Scalar l-Scalar-Plain">port_admin</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">28001</span>
        <span class="l l-Scalar l-Scalar-Plain">port_https</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">8443</span>
        <span class="l l-Scalar l-Scalar-Plain">baseuri</span><span class="p p-Indicator">:</span> <span class="s">&quot;ingest-external&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">https_enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="l l-Scalar l-Scalar-Plain">secret_platform</span><span class="p p-Indicator">:</span> <span class="s">&quot;false&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">antivirus</span><span class="p p-Indicator">:</span> <span class="s">&quot;clamav&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">ingestinternal</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">vitam_component</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ingest-internal</span>
        <span class="l l-Scalar l-Scalar-Plain">host</span><span class="p p-Indicator">:</span> <span class="s">&quot;ingest-internal.service.{{consul_domain}}&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">port_http</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">8100</span>
        <span class="l l-Scalar l-Scalar-Plain">port_admin</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">28100</span>
        <span class="l l-Scalar l-Scalar-Plain">baseuri</span><span class="p p-Indicator">:</span> <span class="s">&quot;ingest-internal&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">https_enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="l l-Scalar l-Scalar-Plain">secret_platform</span><span class="p p-Indicator">:</span> <span class="s">&quot;true&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">ihm_demo</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">vitam_component</span><span class="p p-Indicator">:</span> <span class="s">&quot;ihm-demo&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">host</span><span class="p p-Indicator">:</span> <span class="s">&quot;{{groups[&#39;hosts-ihm-demo&#39;][0]}}&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">port_http</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">8002</span>
        <span class="l l-Scalar l-Scalar-Plain">port_admin</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">28002</span>
        <span class="l l-Scalar l-Scalar-Plain">baseurl</span><span class="p p-Indicator">:</span> <span class="s">&quot;/ihm-demo&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">static_content</span><span class="p p-Indicator">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">vitam_defaults.folder.root_path</span><span class="nv"> </span><span class="s">}}/app/ihm-demo/v1&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">baseuri</span><span class="p p-Indicator">:</span> <span class="s">&quot;ihm-demo&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">static_content_v2</span><span class="p p-Indicator">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">vitam_defaults.folder.root_path</span><span class="nv"> </span><span class="s">}}/app/ihm-demo/v2&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">baseuri_v2</span><span class="p p-Indicator">:</span> <span class="s">&quot;ihm-demo-v2&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">https_enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="l l-Scalar l-Scalar-Plain">secret_platform</span><span class="p p-Indicator">:</span> <span class="s">&quot;false&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">logbook</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">vitam_component</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">logbook</span>
        <span class="l l-Scalar l-Scalar-Plain">host</span><span class="p p-Indicator">:</span> <span class="s">&quot;logbook.service.{{consul_domain}}&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">port_http</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">9002</span>
        <span class="l l-Scalar l-Scalar-Plain">port_admin</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">29002</span>
        <span class="l l-Scalar l-Scalar-Plain">baseuri</span><span class="p p-Indicator">:</span> <span class="s">&quot;logbook&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">https_enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="l l-Scalar l-Scalar-Plain">secret_platform</span><span class="p p-Indicator">:</span> <span class="s">&quot;true&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">cluster_name</span><span class="p p-Indicator">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">elasticsearch.data.cluster_name</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">metadata</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">vitam_component</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">metadata</span>
        <span class="l l-Scalar l-Scalar-Plain">host</span><span class="p p-Indicator">:</span> <span class="s">&quot;metadata.service.{{consul_domain}}&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">port_http</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">8200</span>
        <span class="l l-Scalar l-Scalar-Plain">port_admin</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">28200</span>
        <span class="l l-Scalar l-Scalar-Plain">baseuri</span><span class="p p-Indicator">:</span> <span class="s">&quot;metadata&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">https_enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="l l-Scalar l-Scalar-Plain">secret_platform</span><span class="p p-Indicator">:</span> <span class="s">&quot;true&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">cluster_name</span><span class="p p-Indicator">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">elasticsearch.data.cluster_name</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">processing</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">vitam_component</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">processing</span>
        <span class="l l-Scalar l-Scalar-Plain">host</span><span class="p p-Indicator">:</span> <span class="s">&quot;processing.service.{{consul_domain}}&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">port_http</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">8203</span>
        <span class="l l-Scalar l-Scalar-Plain">port_admin</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">28203</span>
        <span class="l l-Scalar l-Scalar-Plain">baseuri</span><span class="p p-Indicator">:</span> <span class="s">&quot;processing&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">https_enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="l l-Scalar l-Scalar-Plain">secret_platform</span><span class="p p-Indicator">:</span> <span class="s">&quot;true&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">security_internal</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">vitam_component</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">security-internal</span>
        <span class="l l-Scalar l-Scalar-Plain">host</span><span class="p p-Indicator">:</span> <span class="s">&quot;security-internal.service.{{consul_domain}}&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">port_http</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">8005</span>
        <span class="l l-Scalar l-Scalar-Plain">port_admin</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">28005</span>
        <span class="l l-Scalar l-Scalar-Plain">baseuri</span><span class="p p-Indicator">:</span> <span class="s">&quot;security-internal&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">https_enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="l l-Scalar l-Scalar-Plain">secret_platform</span><span class="p p-Indicator">:</span> <span class="s">&quot;true&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">storageengine</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">vitam_component</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">storage</span>
        <span class="l l-Scalar l-Scalar-Plain">host</span><span class="p p-Indicator">:</span> <span class="s">&quot;storage.service.{{consul_domain}}&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">port_http</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">9102</span>
        <span class="l l-Scalar l-Scalar-Plain">port_admin</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">29102</span>
        <span class="l l-Scalar l-Scalar-Plain">baseuri</span><span class="p p-Indicator">:</span> <span class="s">&quot;storage-engine&quot;</span>
        <span class="c1"># FIXME: replace with https_enabled</span>
        <span class="l l-Scalar l-Scalar-Plain">test_tls_offer_enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="l l-Scalar l-Scalar-Plain">https_enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="l l-Scalar l-Scalar-Plain">secret_platform</span><span class="p p-Indicator">:</span> <span class="s">&quot;true&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">storageofferdefault</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">vitam_component</span><span class="p p-Indicator">:</span> <span class="s">&quot;offer&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">port_http</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">9900</span>
        <span class="l l-Scalar l-Scalar-Plain">port_admin</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">29900</span>
        <span class="l l-Scalar l-Scalar-Plain">port_https</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">9901</span>
        <span class="l l-Scalar l-Scalar-Plain">baseuri</span><span class="p p-Indicator">:</span> <span class="s">&quot;storage-offer-default&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">https_enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="l l-Scalar l-Scalar-Plain">secret_platform</span><span class="p p-Indicator">:</span> <span class="s">&quot;true&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">worker</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">vitam_component</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">worker</span>
        <span class="l l-Scalar l-Scalar-Plain">port_http</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">9104</span>
        <span class="l l-Scalar l-Scalar-Plain">port_admin</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">29104</span>
        <span class="l l-Scalar l-Scalar-Plain">baseuri</span><span class="p p-Indicator">:</span> <span class="s">&quot;worker&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">https_enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="l l-Scalar l-Scalar-Plain">secret_platform</span><span class="p p-Indicator">:</span> <span class="s">&quot;true&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">workspace</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">vitam_component</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">workspace</span>
        <span class="l l-Scalar l-Scalar-Plain">host</span><span class="p p-Indicator">:</span> <span class="s">&quot;workspace.service.{{consul_domain}}&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">port_http</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">8201</span>
        <span class="l l-Scalar l-Scalar-Plain">port_admin</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">28201</span>
        <span class="l l-Scalar l-Scalar-Plain">baseuri</span><span class="p p-Indicator">:</span> <span class="s">&quot;workspace&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">https_enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="l l-Scalar l-Scalar-Plain">secret_platform</span><span class="p p-Indicator">:</span> <span class="s">&quot;true&quot;</span>
</pre></div>
</td></tr></table></div>
</li>
</ul>
<p>** <code class="docutils literal"><span class="pre">environments</span></code> <code class="docutils literal"><span class="pre">/group_vars/all/cots_vars.yml</span></code>, comme suit :</p>
<blockquote>
<div><div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nn">---</span>

<span class="l l-Scalar l-Scalar-Plain">elasticsearch</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">log</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">host</span><span class="p p-Indicator">:</span> <span class="s">&quot;elasticsearch-log.service.{{</span><span class="nv"> </span><span class="s">consul_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">port_http</span><span class="p p-Indicator">:</span> <span class="s">&quot;9201&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">port_tcp</span><span class="p p-Indicator">:</span> <span class="s">&quot;9301&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">groupe</span><span class="p p-Indicator">:</span> <span class="s">&quot;log&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">baseuri</span><span class="p p-Indicator">:</span> <span class="s">&quot;elasticsearch-log&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">cluster_name</span><span class="p p-Indicator">:</span> <span class="s">&quot;elasticsearch-log&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">https_enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="l l-Scalar l-Scalar-Plain">data</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">host</span><span class="p p-Indicator">:</span> <span class="s">&quot;elasticsearch-data.service.{{</span><span class="nv"> </span><span class="s">consul_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">port_http</span><span class="p p-Indicator">:</span> <span class="s">&quot;9200&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">port_tcp</span><span class="p p-Indicator">:</span> <span class="s">&quot;9300&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">groupe</span><span class="p p-Indicator">:</span> <span class="s">&quot;data&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">baseuri</span><span class="p p-Indicator">:</span> <span class="s">&quot;elasticsearch-data&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">cluster_name</span><span class="p p-Indicator">:</span> <span class="s">&quot;elasticsearch-data&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">https_enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

<span class="l l-Scalar l-Scalar-Plain">mongodb</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">mongos_port</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">27017</span>
    <span class="l l-Scalar l-Scalar-Plain">mongoc_port</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">27018</span>
    <span class="l l-Scalar l-Scalar-Plain">mongod_port</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">27019</span>
    <span class="l l-Scalar l-Scalar-Plain">mongo_authentication</span><span class="p p-Indicator">:</span> <span class="s">&quot;true&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">host</span><span class="p p-Indicator">:</span> <span class="s">&quot;mongos.service.{{</span><span class="nv"> </span><span class="s">consul_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>

<span class="l l-Scalar l-Scalar-Plain">logstash</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">user</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">logstash</span>
    <span class="l l-Scalar l-Scalar-Plain">port</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">10514</span>
    <span class="l l-Scalar l-Scalar-Plain">rest_port</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">20514</span>

<span class="l l-Scalar l-Scalar-Plain">kibana</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">log</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">baseuri</span><span class="p p-Indicator">:</span> <span class="s">&quot;kibana_log&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">groupe</span><span class="p p-Indicator">:</span> <span class="s">&quot;log&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">port</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">5601</span>
    <span class="c1"># KWA FIXME : changing port doesn&#39;t work, yet (not taken into account in kibana configuration)</span>
    <span class="l l-Scalar l-Scalar-Plain">data</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">baseuri</span><span class="p p-Indicator">:</span> <span class="s">&quot;kibana_data&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">groupe</span><span class="p p-Indicator">:</span> <span class="s">&quot;data&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">port</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">5601</span>

<span class="l l-Scalar l-Scalar-Plain">cerebro</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">baseuri</span><span class="p p-Indicator">:</span> <span class="s">&quot;cerebro&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">port</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">9000</span>

<span class="l l-Scalar l-Scalar-Plain">siegfried</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">port</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">19000</span>

<span class="l l-Scalar l-Scalar-Plain">clamav</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">port</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">3310</span>

<span class="l l-Scalar l-Scalar-Plain">mongo_express</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">baseuri</span><span class="p p-Indicator">:</span> <span class="s">&quot;mongo-express&quot;</span>
</pre></div>
</td></tr></table></div>
</div></blockquote>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="30-installation.html" class="btn btn-neutral float-right" title="4.2.4. Procédure de première installation" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="certificats/pki_externe.html" class="btn btn-neutral" title="4.2.2.2. Cas 2: Je dispose d’une PKI" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Ce document est distribué sous les termes de la Licence Ouverte V2.0.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.26.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
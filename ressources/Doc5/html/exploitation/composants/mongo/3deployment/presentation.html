

<!DOCTYPE html>
<html class="writer-html4" lang="fr" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>7.2.9.4.1. Présentation &mdash; Documentation VITAM - Documentation d&#39;exploitation 5.0</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../../',
              VERSION:'5.0',
              LANGUAGE:'fr',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/translations.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Recherche" href="../../../search.html" />
    <link rel="next" title="7.2.9.4.2. Déploiement d’un cluster de développement" href="deployDev.html" />
    <link rel="prev" title="7.2.9.4. Topologies de déploiement et tolérance aux pannes" href="_toc.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> VITAM - Documentation d'exploitation
          

          
            
            <img src="../../../_static/logo_vitam.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                5.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html#rappels">2. Rappels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../prerequis-competences.html">3. Expertises requises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../architecture.html">4. Architecture de la solution logicielle VITAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../topics/_toc.html">5. Exploitation globale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../monitoring/_toc.html">6. Suivi de l’état du système</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../_toc.html">7. Exploitation des COTS de la solution logicielle VITAM</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../_toc.html#generalites">7.1. Généralités</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../_toc.html#cots">7.2. COTS</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../cerebro/_toc.html">7.2.1. Cerebro</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../consul/_toc.html">7.2.2. Consul</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../elasticsearch_interceptor/_toc.html">7.2.3. Kibana interceptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../elasticsearch_log/_toc.html">7.2.4. Elasticsearch chaîne de log</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../elasticsearch_vitam/_toc.html">7.2.5. Elasticsearch Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../grafana/_toc.html">7.2.6. Grafana</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../kibana/_toc.html">7.2.7. Kibana</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../log_server/_toc.html">7.2.8. Log server</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../_toc.html">7.2.9. MongoDB</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../0mongos/_toc.html">7.2.9.1. Service vitam-mongos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../1mongoc/_toc.html">7.2.9.2. Service vitam-mongoc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../2mongod/_toc.html">7.2.9.3. Service vitam-mongod</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="_toc.html">7.2.9.4. Topologies de déploiement et tolérance aux pannes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../4exploitation/_toc.html">7.2.9.5. Exploitation d’un cluster MongoDB</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../prometheus/_toc.html">7.2.10. Prometheus</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../restic/_toc.html">7.2.11. Restic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../siegfried/_toc.html">7.2.12. Siegfried</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../include/_toc.html">8. Exploitation des composants de la solution logicielle VITAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../external_app.html">9. Intégration d’une application externe dans Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../troubleshoot/_toc.html">10. Aide à l’exploitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../FAQ/_toc.html">11. Questions Fréquemment Posées</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../annexes/_toc.html">12. Annexes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">VITAM - Documentation d'exploitation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../_toc.html">7. Exploitation des COTS de la solution logicielle VITAM</a> &raquo;</li>
        
          <li><a href="../_toc.html">7.2.9. MongoDB</a> &raquo;</li>
        
          <li><a href="_toc.html">7.2.9.4. Topologies de déploiement et tolérance aux pannes</a> &raquo;</li>
        
      <li>7.2.9.4.1. Présentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/composants/mongo/3deployment/presentation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="presentation">
<h1>7.2.9.4.1. Présentation<a class="headerlink" href="#presentation" title="Lien permanent vers ce titre">¶</a></h1>
<p>Les clusters MongoDB déployés dans la solution Vitam sont par défaut, et obligatoirement, configurés pour supporter le sharding des bases de données metadata, logbook et offer. Aussi, les composants <code class="docutils literal notranslate"><span class="pre">vitam-mongos</span></code>, <code class="docutils literal notranslate"><span class="pre">vitam-mongoc</span></code> et <code class="docutils literal notranslate"><span class="pre">vitam-mongod</span></code> sont configurés pour fonctionner ensemble. Le déploiement automatique d’une mono-instance MongoDB (un seul et unique serveur mongod) n’est pas supporté.</p>
<p>Les topologies de déploiement des services <code class="docutils literal notranslate"><span class="pre">mongos</span></code>, ainsi que des <code class="docutils literal notranslate"><span class="pre">ReplicaSet</span></code> des services <code class="docutils literal notranslate"><span class="pre">mongoc</span></code> et <code class="docutils literal notranslate"><span class="pre">mongod</span></code>, restent à la main de l’administrateur technique Vitam. Les choix sont réalisés lors de l’installation de la solution Vitam, mais peuvent être modifiés à posteriori (avec potentiellement des temps de migration de données à prévoir).</p>
<p>Le nombre de composants <code class="docutils literal notranslate"><span class="pre">vitam-mongos</span></code> peut varier au cours de l’utilisation du système sans contrainte particulière. Le nombre de <code class="docutils literal notranslate"><span class="pre">Shards</span></code> déployés, lui par contre, s’il varie, impliquera des migrations de données, réalisées en tâche de fond. Les choix opérés par les concepteurs de la base de données MongoDB ne peuvent pas être modifiés mais permettent une migration sans altérer les performances du système. Un paragraphe entier détaille ce scénario ainsi que les contraintes et temps nécessaires à la réalisation complète de l’opération.</p>
<p>Le nombre de composants par <code class="docutils literal notranslate"><span class="pre">ReplicaSet</span></code> des services <code class="docutils literal notranslate"><span class="pre">mongoc</span></code> et <code class="docutils literal notranslate"><span class="pre">mongod</span></code> reste aussi un choix à la main de l’administrateur technique et peut aussi varier dans le temps. Il est aussi assujetti à une opération plus ou moins longue de synchronisation des données.
Il est important de respecter la contrainte MongoDB concernant le choix du nombre de membres d’un <code class="docutils literal notranslate"><span class="pre">ReplicaSet</span></code>. Pour des raisons liées à l’algorithme de l’élection d’un membre primaire, parmis les membres d’un <code class="docutils literal notranslate"><span class="pre">ReplicaSet</span></code> (cf. <a class="reference external" href="https://docs.mongodb.com/manual/core/replica-set-elections/">documentation officielle</a>), ce nombre doit être impair.</p>
<p>La tolérance aux pannes est directement liée au choix du nombre de membres déployés par <code class="docutils literal notranslate"><span class="pre">ReplicaSet</span></code> et particulièrement à la redondance physique des composants et équipements réseaux qui assurent la communication entre eux. Aussi, le coût de déploiement, en ressources matérielles, est extrêmement lié au niveau de tolérance selectionné.
Étant donné, la consommation importante de ressources matérielles par les services MongoDB (notamment en RAM), une option est laissée à la main de l’administrateur technique, pour configurer un <code class="docutils literal notranslate"><span class="pre">ReplicaSet</span></code> dans un mode particulier, nommé <code class="docutils literal notranslate"><span class="pre">PSSmin</span></code>, sans modifier le niveau de tolérance aux pannes. Ce point est détaillé ci-après.</p>
<p>Dans Vitam, la gestion du risque de la perte de données est centralisée au niveau des offres. Si un incident intervient sur le cluster <code class="docutils literal notranslate"><span class="pre">mongodb-data</span></code> provoquant une perte totale du service, un processus de reconstruction est prévu. Toutefois, il est important de noter que ce processus nécessite un temps relativement important, fonction de la volumétrie des données dans le système. Un autre processus de reconstruction du cluster <code class="docutils literal notranslate"><span class="pre">mongodb-offer</span></code> est prévu mais uniquement pour les offres chaudes. Dans le cas d’une offre froide, la reconstruction du cluster est réalisée par l’opération de restoration de la dernière sauvegarde réalisée sur le cluster.</p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="deployDev.html" class="btn btn-neutral float-right" title="7.2.9.4.2. Déploiement d’un cluster de développement" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="_toc.html" class="btn btn-neutral float-left" title="7.2.9.4. Topologies de déploiement et tolérance aux pannes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright Ce document est distribué sous les termes de la Licence Ouverte V2.0.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Workflow d’administration d’un référentiel de règles de gestion &mdash; documentation VITAM - Modèle de workflow 0.26.1</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Recherche" href="../search.html"/>
    <link rel="top" title="documentation VITAM - Modèle de workflow 0.26.1" href="../index.html"/>
        <link rel="up" title="MASTERDATA" href="_toc_masterdata.html"/>
        <link rel="next" title="Workflow d’import d’un référentiel des formats" href="formats.html"/>
        <link rel="prev" title="Workflow d’import d’un arbre de positionnement" href="workflow-tree.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> VITAM - Modèle de workflow
          

          
            
            <img src="../_static/LogoVitamGrand2.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.26.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../audit/_toc_audit.html">AUDIT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dip/_toc_dip.html">DIP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ingest/_toc_ingest.html">INGEST</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="_toc_masterdata.html">MASTERDATA</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="workflow-tree.html">Workflow d&#8217;import d&#8217;un arbre de positionnement</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Workflow d&#8217;administration d&#8217;un référentiel de règles de gestion</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#processus-d-administration-d-un-referentiel-de-regles-de-gestion-stp-import-rules">Processus d&#8217;administration d&#8217;un référentiel de règles de gestion (STP_IMPORT_RULES)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#controle-des-regles-de-gestion-check-rules">Contrôle des règles de gestion (CHECK_RULES)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creation-du-rapport-rules-report">Création du rapport (RULES_REPORT)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#persistance-des-donnees-en-base-commit-rules">Persistance des données en base (COMMIT_RULES)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sauvegarde-du-csv-stp-import-rules-csv">Sauvegarde du CSV (STP_IMPORT_RULES_CSV)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sauvegarde-du-json-stp-import-rules-json">Sauvegarde du JSON (STP_IMPORT_RULES_JSON)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#structure-du-rapport-d-administration-du-referentiel-des-regles-de-gestion">Structure du rapport d&#8217;administration du référentiel des règles de gestion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#exemples">Exemples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="formats.html">Workflow d&#8217;import d&#8217;un référentiel des formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="agencies.html">Workflow d&#8217;administration d&#8217;un référentiel des services agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="ingest-contracts.html">Workflow d&#8217;administration et de mise à jour d&#8217;un référentiel des contrats d&#8217;entrée</a></li>
<li class="toctree-l2"><a class="reference internal" href="access-contracts.html">Workflow d&#8217;administration d&#8217;un référentiel des contrats d&#8217;accès</a></li>
<li class="toctree-l2"><a class="reference internal" href="profiles.html">Workflow d&#8217;import d&#8217;un référentiel des profils</a></li>
<li class="toctree-l2"><a class="reference internal" href="security_profiles.html">Workflow d&#8217;administration d&#8217;un référentiel des profils de sécurité</a></li>
<li class="toctree-l2"><a class="reference internal" href="contextes.html">Workflow d&#8217;administration d&#8217;un référentiel des contextes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../traceability/_toc_traceability.html">TRACEABILITY</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rules_update/_toc_rules_update.html">UPDATE</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">VITAM - Modèle de workflow</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="_toc_masterdata.html">MASTERDATA</a> &raquo;</li>
      
    <li>Workflow d&#8217;administration d&#8217;un référentiel de règles de gestion</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/masterdata/rules.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="workflow-d-administration-d-un-referentiel-de-regles-de-gestion">
<h1>Workflow d&#8217;administration d&#8217;un référentiel de règles de gestion<a class="headerlink" href="#workflow-d-administration-d-un-referentiel-de-regles-de-gestion" title="Lien permanent vers ce titre">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Lien permanent vers ce titre">¶</a></h2>
<p>Cette section décrit le processus permettant d&#8217;importer et de mettre à jour un référentiel de règles de gestions dans la solution logicielle Vitam</p>
</div>
<div class="section" id="processus-d-administration-d-un-referentiel-de-regles-de-gestion-stp-import-rules">
<h2>Processus d&#8217;administration d&#8217;un référentiel de règles de gestion (STP_IMPORT_RULES)<a class="headerlink" href="#processus-d-administration-d-un-referentiel-de-regles-de-gestion-stp-import-rules" title="Lien permanent vers ce titre">¶</a></h2>
<p>Le processus d&#8217;import et de mise à jour d&#8217;un référentiel de règles de gestion permet de vérifier que les informations sont formalisées de la bonne manière dans le fichier soumis à la solution logicielle Vitam, que les données obligatoires ont bien été remplies pour chaque enregistrement et que dans le cas d&#8217;une mise à jour, on ne souhaite éliminer aucune règle déjà utilisée par une unité archivistique prise en charge dans la solution logicielle Vitam.</p>
<p>Tous les éléments réalisés au cours de ce processus sont exécutés dans une seule étape.</p>
<div class="section" id="controle-des-regles-de-gestion-check-rules">
<h3>Contrôle des règles de gestion (CHECK_RULES)<a class="headerlink" href="#controle-des-regles-de-gestion-check-rules" title="Lien permanent vers ce titre">¶</a></h3>
<ul class="simple">
<li><strong>Règle</strong> : contrôle qu&#8217;aucune règle supprimée du référentie n&#8217;est utilisé par une unité archivistique. Contrôle des règes modifiées utilisées par des unités archivistiques. Vérification que les informations obligatoires minimales ont bien été remplies pour chacune des règle, conformément aux exigences du référentiel des règles de gestion. La liste de ces exigences est décrite dans le document modèle de données.</li>
</ul>
<p>De plus le fichier rempli les conditions suivantes :</p>
<blockquote>
<div><ul>
<li><p class="first">il est au format CSV</p>
</li>
<li><p class="first">les informations suivantes sont toutes décrites dans cet ordre</p>
<blockquote>
<div><ul class="simple">
<li>RuleId</li>
<li>RuleType</li>
<li>RuleValue</li>
<li>RuleDescription</li>
<li>RuleDuration</li>
<li>RuleMeasurement</li>
</ul>
</div></blockquote>
<ul class="simple">
<li>Aucune règle supprimée n&#8217;est utilisée par une unité archivistique</li>
</ul>
</li>
</ul>
</div></blockquote>
<ul>
<li><p class="first"><strong>Type</strong> : bloquant</p>
</li>
<li><p class="first"><strong>Statuts</strong> :</p>
<blockquote>
<div><ul class="simple">
<li>OK : les règles ci-dessus sont respectées</li>
<li>WARNING : une règle modifiée par l&#8217;import du référentiel est actuellement utilisée par une unité archivistique (STP_IMPORT_RULES_UPDATED_RULES.WARNING)</li>
<li>KO : une des règles ci-dessus n&#8217;est pas respectée<ul>
<li>Le fichier importé n&#8217;est pas au format CSV (STP_IMPORT_RULES_NOT_CSV_FORMAT.KO)</li>
<li>Il existe plusieurs fois le même RuleId (STP_IMPORT_RULES_RULEID_DUPLICATION.KO)</li>
<li>Au moins une RuleType est incorrecte (STP_IMPORT_RULES_WRONG_RULETYPE_UNKNOW.KO)</li>
<li>Au moins une valeur obligatoire est manquante (STP_IMPORT_RULES_MISSING_INFORMATION.KO)</li>
<li>Des valeurs de durée sont incorrectes pour RuleMeasurement (STP_IMPORT_RULES_WRONG_RULEMEASUREMENT.KO)</li>
<li>Au moins un champs RuleDuration a une valeur incorrecte (STP_IMPORT_RULES_WRONG_RULEDURATION.KO)</li>
<li>L&#8217;association de RuleDuration et de RuleMeasurement doit être  inférieure ou égale à 999 ans (STP_IMPORT_RULES_WRONG_TOTALDURATION.KO)</li>
<li>Des règles supprimées sont actuellement utilisées (STP_IMPORT_RULES_DELETE_USED_RULES.KO)</li>
</ul>
</li>
<li>FATAL : une erreur technique est survenue lors du contrôle des règles de gestion (CHECK_RULES.FATAL=Erreur fatale lors du contrôle de la conformité du fichier de règles de gestion)</li>
</ul>
</div></blockquote>
</li>
</ul>
<p>{&#8220;JDO&#8221;:{&#8220;evType&#8221;:&#8221;STP_IMPORT_RULES&#8221;,&#8221;evDateTime&#8221;:&#8221;2017-11-02T13:50:22.389&#8221;},&#8221;error&#8221;:{},&#8221;usedDeletedRules&#8221;:[],&#8221;usedUpdatedRules&#8221;:[]}</p>
</div>
<div class="section" id="creation-du-rapport-rules-report">
<h3>Création du rapport (RULES_REPORT)<a class="headerlink" href="#creation-du-rapport-rules-report" title="Lien permanent vers ce titre">¶</a></h3>
<ul>
<li><p class="first"><strong>Règle</strong> : création du rapport d&#8217;import des règles</p>
</li>
<li><p class="first"><strong>Type</strong> : bloquant</p>
</li>
<li><p class="first"><strong>Statuts</strong> :</p>
<blockquote>
<div><ul class="simple">
<li>OK : Le rapport est généré</li>
<li>KO : pas de cas KO</li>
<li>FATAL : une erreur technique est survenue lors de la création du rapport (RULES_REPORT.FATAL = Erreur fatale lors de la génération du rapport d&#8217;import du référentiel des règles de gestion)</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="persistance-des-donnees-en-base-commit-rules">
<h3>Persistance des données en base (COMMIT_RULES)<a class="headerlink" href="#persistance-des-donnees-en-base-commit-rules" title="Lien permanent vers ce titre">¶</a></h3>
<ul>
<li><p class="first"><strong>Règle</strong> : enregistrement des données</p>
</li>
<li><p class="first"><strong>Type</strong> : bloquant</p>
</li>
<li><p class="first"><strong>Statuts</strong> :</p>
<blockquote>
<div><ul class="simple">
<li>OK : les données sont persistées en base</li>
<li>KO : pas de cas KO</li>
<li>FATAL : une erreur technique est survenue lors de la persistance des données en base (COMMIT_RULES.FATAL=Erreur fatale lors de la persistance des données en base)</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="sauvegarde-du-csv-stp-import-rules-csv">
<h3>Sauvegarde du CSV (STP_IMPORT_RULES_CSV)<a class="headerlink" href="#sauvegarde-du-csv-stp-import-rules-csv" title="Lien permanent vers ce titre">¶</a></h3>
<ul>
<li><p class="first"><strong>Règle</strong> : enregistrement du CSV d&#8217;import</p>
</li>
<li><p class="first"><strong>Type</strong> : bloquant</p>
</li>
<li><p class="first"><strong>Statuts</strong> :</p>
<blockquote>
<div><ul class="simple">
<li>OK : le CSV d&#8217;import est enregistré</li>
<li>KO : pas de cas KO</li>
<li>FATAL : une erreur technique est survenue lors de l&#8217;enregistrement du CSV d&#8217;import (STP_IMPORT_RULES_CSV.FATAL = Erreur fatale lors de l&#8217;enregistrement du fichier d&#8217;import du référentiel des règles de gestion)</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="sauvegarde-du-json-stp-import-rules-json">
<h3>Sauvegarde du JSON (STP_IMPORT_RULES_JSON)<a class="headerlink" href="#sauvegarde-du-json-stp-import-rules-json" title="Lien permanent vers ce titre">¶</a></h3>
<ul>
<li><p class="first"><strong>Règle</strong> : enregistrement d&#8217;une copie de la base de données</p>
</li>
<li><p class="first"><strong>Type</strong> : bloquant</p>
</li>
<li><p class="first"><strong>Statuts</strong> :</p>
<blockquote>
<div><ul class="simple">
<li>OK : une copie de la base de donnée nouvellement importée est enregistrée</li>
<li>KO : pas de cas KO</li>
<li>FATAL : une erreur technique est survenue lors de la copie de la base de donnée nouvellement importée (STP_IMPORT_RULES_JSON.FATAL = Erreur fatale lors de l&#8217;enregistrement de la copie du référentiel des règles de gestion)</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
</div>
<div class="section" id="structure-du-rapport-d-administration-du-referentiel-des-regles-de-gestion">
<h2>Structure du rapport d&#8217;administration du référentiel des règles de gestion<a class="headerlink" href="#structure-du-rapport-d-administration-du-referentiel-des-regles-de-gestion" title="Lien permanent vers ce titre">¶</a></h2>
<p>Lorsqu&#8217;un nouveau référentiel est importé, la solution logicielle Vitam génère un rapport de l&#8217;opération. Ce rapport est en 3 parties :</p>
<blockquote>
<div><ul>
<li><p class="first">&#8220;JDO&#8221; contient :</p>
<ul class="simple">
<li>evType : le type d&#8217;opération. Dans le cadre de ce rapport, il s&#8217;agit toujours de &#8220;STP_IMPORT_RULES&#8221;</li>
<li>evDateTime : la date et l&#8217;heure de l&#8217;opération d&#8217;import</li>
</ul>
</li>
<li><p class="first">&#8220;Error&#8221; : détail les erreurs en indiquant :</p>
<ul class="simple">
<li>line : le numéro de la ligne du rapport CSV générant l&#8217;erreur</li>
<li>Code : le code d&#8217;erreur</li>
<li>Message : le message associée à l&#8217;erreur</li>
<li>Information additionnelle : une précision sur l&#8217;erreur, comme par exemple le contenu du champs qui l&#8217;a provoquée</li>
</ul>
<ul class="simple">
<li>&#8220;usedDeletedRules&#8221; : contient l&#8217;intégralité des règles en cours d&#8217;utilisation dont la suppression a été demandée lors de la mise à jour du référentiel des règles de gestion. Chaque détail précise en plus la date de création de la règle, sa dernière mise à jour et sa version.</li>
<li>&#8220;usedUpdatedRules&#8221; : contient l&#8217;intégralité des règles en cours d&#8217;utilisation dont une mise à jour a été effectuée. Chaque détail précise en plus la date de création de la règle, sa dernière mise à jour et sa version.</li>
</ul>
</li>
</ul>
</div></blockquote>
<div class="section" id="exemples">
<h3>Exemples<a class="headerlink" href="#exemples" title="Lien permanent vers ce titre">¶</a></h3>
<p><strong>Exemple 1 : import initial d&#8217;un référentiel</strong></p>
<p>Le rapport généré est :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;JDO&quot;</span><span class="p">:{</span><span class="s2">&quot;evType&quot;</span><span class="p">:</span><span class="s2">&quot;STP_IMPORT_RULES&quot;</span><span class="p">,</span><span class="s2">&quot;evDateTime&quot;</span><span class="p">:</span><span class="s2">&quot;2017-11-02T13:50:22.389&quot;</span><span class="p">},</span><span class="s2">&quot;error&quot;</span><span class="p">:{},</span><span class="s2">&quot;usedDeletedRules&quot;</span><span class="p">:[],</span><span class="s2">&quot;usedUpdatedRules&quot;</span><span class="p">:[]}</span>
</pre></div>
</div>
<p><strong>Exemple 2 : mise à jour d&#8217;un référentiel existant</strong></p>
<p>Dans cette exemple, la mise à jour :</p>
<blockquote>
<div><ul class="simple">
<li>Essaye de modifier une RuleType d&#8217;une règle en lui mettant &#8220;AccessRulez&#8221; au lieu de &#8220;AccessRule&#8221;</li>
<li>Met à jour une règle de gestion en cours d&#8217;utilisation</li>
</ul>
</div></blockquote>
<p>Le rapport généré est :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
      <span class="s2">&quot;JDO&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;evType&quot;</span><span class="p">:</span> <span class="s2">&quot;STP_IMPORT_RULES&quot;</span><span class="p">,</span>
              <span class="s2">&quot;evDateTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2017-11-02T14:03:53.326&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;line 6&quot;</span><span class="p">:</span> <span class="p">[{</span>
                      <span class="s2">&quot;Code&quot;</span><span class="p">:</span> <span class="s2">&quot;STP_IMPORT_RULES_WRONG_RULETYPE_UNKNOW.KO&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;Message&quot;</span><span class="p">:</span> <span class="s2">&quot;Au moins une RuleType est incorrecte. RuleType autorisés : AppraisalRule, AccessRule, StorageRule, DisseminationRule, ReuseRule, ClassificationRule&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;Information additionnelle&quot;</span><span class="p">:</span> <span class="s2">&quot;AccessRulez&quot;</span>
              <span class="p">}]</span>
      <span class="p">},</span>
      <span class="s2">&quot;usedDeletedRules&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="s2">&quot;usedUpdatedRules&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;id=null, tenant=0, ruleId=APP-00001, ruleType=AppraisalRule, ruleValue=Dossier individuel d’agent civil, ruleDescription=Durée de conservation des dossiers individuels d’agents. L’échéance est calculée à partir de la date de naissance de l’agent, ruleDuration=70, ruleMeasurement=YEAR, creationDate=2017-11-02T14:03:52.374, updateDate=2017-11-02T14:03:52.374, version=0&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="formats.html" class="btn btn-neutral float-right" title="Workflow d’import d’un référentiel des formats" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="workflow-tree.html" class="btn btn-neutral" title="Workflow d’import d’un arbre de positionnement" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Ce document est distribué sous les termes de la Licence Ouverte V2.0.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.26.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
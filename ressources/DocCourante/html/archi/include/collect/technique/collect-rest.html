<!DOCTYPE html>
<html class="writer-html4" lang="fr" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>7.3.2.5. collect-rest &mdash; Documentation VITAM - Architecture 6.rc.1</title><link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
      <script>
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../../',
              VERSION:'6.rc.1',
              LANGUAGE:'fr',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/translations.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Recherche" href="../../../search.html" />
    <link rel="next" title="7.3.3. Sécurité" href="../securite/_toc.html" />
    <link rel="prev" title="7.3.2.2. Access-client" href="collect-client.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> VITAM - Architecture<img src="../../../_static/logo_vitam.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                6.rc.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html#rappels">2. Rappels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/_toc.html">3. Vue d’ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../archi-applicative/_toc.html">4. Architecture applicative</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../archi-exploit-infra/_toc.html">5. Architecture technique / exploitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../securite/_toc.html">6. Sécurité</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../_toc.html">7. Architecture détaillée</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../access/_toc.html">7.1. Access</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../batch-report/_toc.html">7.2. Batch-report</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../_toc.html">7.3. Access</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../fonctionnelle/basics.html">7.3.1. Généralités</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="_toc.html">7.3.2. Architecture Technique</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="introduction.html">7.3.2.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="collect-client.html">7.3.2.2. Access-client</a></li>
<li class="toctree-l4"><a class="reference internal" href="collect-client.html#utilisation">7.3.2.3. Utilisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="collect-client.html#le-client">7.3.2.4. Le client</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">7.3.2.5. collect-rest</a></li>
<li class="toctree-l4"><a class="reference internal" href="#transactionresource-java">7.3.2.6. -TransactionResource.java</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../securite/_toc.html">7.3.3. Sécurité</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../common/_toc.html">7.4. Common</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../functional-administration/_toc.html">7.5. Functional administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ihm-demo/_toc.html">7.6. IHM demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ihm-recette/_toc.html">7.7. IHM recette</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ingest/_toc.html">7.8. Ingest</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../internal-security/_toc.html">7.9. Security-Internal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../logbook/_toc.html">7.10. Logbook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../metadata/_toc.html">7.11. Metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../processing/_toc.html">7.12. Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../scheduler/_toc.html">7.13. Scheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../storage/_toc.html">7.14. Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical-administration/_toc.html">7.15. Technical administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../worker/_toc.html">7.16. Worker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../workspace/_toc.html">7.17. Workspace</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">VITAM - Architecture</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../../_toc.html">7. Architecture détaillée</a></li>
          <li class="breadcrumb-item"><a href="../_toc.html">7.3. Access</a></li>
          <li class="breadcrumb-item"><a href="_toc.html">7.3.2. Architecture Technique</a></li>
      <li class="breadcrumb-item active">7.3.2.5. collect-rest</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/include/collect/technique/collect-rest.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="collect-rest">
<h1>7.3.2.5. collect-rest<a class="headerlink" href="#collect-rest" title="Lien permanent vers ce titre">¶</a></h1>
<div class="section" id="presentation">
<h2>7.3.2.5.1. Présentation<a class="headerlink" href="#presentation" title="Lien permanent vers ce titre">¶</a></h2>
<p>A faire</p>
</div>
<div class="section" id="packages">
<h2>7.3.2.5.2. Packages:<a class="headerlink" href="#packages" title="Lien permanent vers ce titre">¶</a></h2>
<p><strong>fr.gouv.vitam.collect.dto</strong> : contient les objets entrants et sortants du service web d’application.</p>
<p><strong>fr.gouv.vitam.collect.exception</strong> : classes d’exceptions gérées par le module collecte.</p>
<p><strong>fr.gouv.vitam.collect.helpers</strong> : classes gérant la structure des objets en interne du module collecte.</p>
<p><strong>fr.gouv.vitam.collect.model</strong> : classes interne du module collecte.</p>
<p><strong>fr.gouv.vitam.collect.repository</strong> : classes pour mapper les objets de la base de données.</p>
<p><strong>fr.gouv.vitam.collect.resource</strong> : classe du controlleur REST qui contient les endpoints.</p>
<p><strong>fr.gouv.vitam.collect.server</strong> : classes de lancement du serveur d’application.</p>
<p><strong>fr.gouv.vitam.collect.service</strong> : classes fonctionnelles.</p>
</div>
<div class="section" id="fr-gouv-vitam-collect-resource">
<h2>7.3.2.5.3. fr.gouv.vitam.collect.resource<a class="headerlink" href="#fr-gouv-vitam-collect-resource" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="rest-api">
<h3>7.3.2.5.3.1. Rest API<a class="headerlink" href="#rest-api" title="Lien permanent vers ce titre">¶</a></h3>
<div class="line-block">
<div class="line"><a class="reference external" href="https://vitam/collect/v1/transactions">https://vitam/collect/v1/transactions</a></div>
<div class="line"><a class="reference external" href="https://vitam/collect/v1/units">https://vitam/collect/v1/units</a></div>
<div class="line"><a class="reference external" href="https://vitam/collect/v1/objects">https://vitam/collect/v1/objects</a>/{usage}/{version}</div>
<div class="line"><a class="reference external" href="https://vitam/collect/v1/objects">https://vitam/collect/v1/objects</a>/{usage}/{version}/binary</div>
<div class="line"><a class="reference external" href="https://vitam/collect/v1/transactions/close">https://vitam/collect/v1/transactions/close</a></div>
<div class="line"><a class="reference external" href="https://vitam/collect/v1/transactions/send">https://vitam/collect/v1/transactions/send</a></div>
<div class="line"><a class="reference external" href="https://vitam/collect/v1/projects">https://vitam/collect/v1/projects</a>/{projectId}/binary</div>
<div class="line"><a class="reference external" href="https://vitam/collect/v1/projects">https://vitam/collect/v1/projects</a>/{projectId}/units</div>
</div>
</div>
</div>
</div>
<div class="section" id="transactionresource-java">
<h1>7.3.2.6. -TransactionResource.java<a class="headerlink" href="#transactionresource-java" title="Lien permanent vers ce titre">¶</a></h1>
<p>classe controlleur REST
La classe contient actuellement 6 méthodes :</p>
<ol class="arabic simple">
<li>initTransaction()</li>
</ol>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span> <span class="nd">@Path</span><span class="p">(</span><span class="s">&quot;/transactions&quot;</span><span class="p">)</span>
  <span class="nd">@POST</span>
  <span class="nd">@Consumes</span><span class="p">(</span><span class="n">APPLICATION_JSON</span><span class="p">)</span>
  <span class="nd">@Produces</span><span class="p">(</span><span class="n">MediaType</span><span class="p">.</span><span class="na">APPLICATION_JSON</span><span class="p">)</span>
  <span class="nd">@Secured</span><span class="p">(</span><span class="n">permission</span> <span class="o">=</span>  <span class="n">TRANSACTION_CREATE</span><span class="p">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">&quot;Créer une transaction&quot;</span><span class="p">)</span>
  <span class="kd">public</span> <span class="n">Response</span> <span class="nf">initTransaction</span><span class="p">(</span><span class="n">TransactionDto</span> <span class="n">transactionDto</span><span class="p">)</span> <span class="p">{</span>

<span class="p">....</span>
</pre></div>
</div>
<ol class="arabic" start="2">
<li><p class="first">uploadArchiveUnit()</p>
<blockquote>
<div><p>Ajouter une unité archivistique</p>
</div></blockquote>
</li>
</ol>
<blockquote>
<div><div class="highlight-java notranslate"><div class="highlight"><pre><span></span>    <span class="nd">@Path</span><span class="p">(</span><span class="s">&quot;/transactions/{transactionId}/units&quot;</span><span class="p">)</span>
<span class="nd">@POST</span>
<span class="nd">@Consumes</span><span class="p">(</span><span class="n">MediaType</span><span class="p">.</span><span class="na">APPLICATION_JSON</span><span class="p">)</span>
<span class="nd">@Produces</span><span class="p">(</span><span class="n">MediaType</span><span class="p">.</span><span class="na">APPLICATION_JSON</span><span class="p">)</span>
<span class="nd">@Secured</span><span class="p">(</span><span class="n">permission</span> <span class="o">=</span>  <span class="n">TRANSACTION_UNIT_CREATE</span><span class="p">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">&quot;Créer une unité archivistique&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="n">Response</span> <span class="nf">uploadArchiveUnit</span><span class="p">(</span><span class="nd">@PathParam</span><span class="p">(</span><span class="s">&quot;transactionId&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">transactionId</span><span class="p">,</span> <span class="n">JsonNode</span> <span class="n">unitJsonNode</span><span class="p">)</span> <span class="p">{</span>

 <span class="p">...</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic" start="3">
<li><p class="first">uploadObjectGroup()</p>
<blockquote>
<div><dl class="docutils">
<dt>ajouter un object group a une unité archivistique</dt>
<dd><p class="first last">NB : the post X-Http-Method-Override header</p>
</dd>
</dl>
</div></blockquote>
</li>
</ol>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Path</span><span class="p">(</span><span class="s">&quot;/units/{unitId}/objects/{usage}/{version}&quot;</span><span class="p">)</span>
  <span class="nd">@POST</span>
  <span class="nd">@Consumes</span><span class="p">(</span><span class="n">MediaType</span><span class="p">.</span><span class="na">APPLICATION_JSON</span><span class="p">)</span>
  <span class="nd">@Produces</span><span class="p">(</span><span class="n">MediaType</span><span class="p">.</span><span class="na">APPLICATION_JSON</span><span class="p">)</span>
  <span class="nd">@Secured</span><span class="p">(</span><span class="n">permission</span> <span class="o">=</span>  <span class="n">TRANSACTION_OBJECT_UPSERT</span><span class="p">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">&quot;ajouter ou modifier un objet group&quot;</span><span class="p">)</span>
  <span class="kd">public</span> <span class="n">Response</span> <span class="nf">uploadObjectGroup</span><span class="p">(</span><span class="nd">@PathParam</span><span class="p">(</span><span class="s">&quot;unitId&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">unitId</span><span class="p">,</span>
                                    <span class="nd">@PathParam</span><span class="p">(</span><span class="s">&quot;usage&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">usageString</span><span class="p">,</span>
                                    <span class="nd">@PathParam</span><span class="p">(</span><span class="s">&quot;version&quot;</span><span class="p">)</span> <span class="n">Integer</span> <span class="n">version</span><span class="p">,</span>
                                    <span class="n">ObjectDto</span> <span class="n">objectDto</span><span class="p">)</span> <span class="p">{</span>
<span class="p">...</span>
</pre></div>
</div>
<ol class="arabic" start="4">
<li><p class="first">upload()</p>
<blockquote>
<div><p>méthode pour uploader un binaire</p>
</div></blockquote>
</li>
</ol>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span>     <span class="nd">@Path</span><span class="p">(</span><span class="s">&quot;/units/{unitId}/objects/{usage}/{version}/binary&quot;</span><span class="p">)</span>
 <span class="nd">@POST</span>
 <span class="nd">@Consumes</span><span class="p">(</span><span class="n">MediaType</span><span class="p">.</span><span class="na">APPLICATION_OCTET_STREAM</span><span class="p">)</span>
 <span class="nd">@Produces</span><span class="p">(</span><span class="n">MediaType</span><span class="p">.</span><span class="na">APPLICATION_JSON</span><span class="p">)</span>
 <span class="nd">@Secured</span><span class="p">(</span><span class="n">permission</span> <span class="o">=</span>  <span class="n">TRANSACTION_BINARY_UPSERT</span><span class="p">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">&quot;ajouter ou modifier un binaire&quot;</span><span class="p">)</span>
 <span class="kd">public</span> <span class="n">Response</span> <span class="nf">upload</span><span class="p">(</span><span class="nd">@PathParam</span><span class="p">(</span><span class="s">&quot;unitId&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">unitId</span><span class="p">,</span>
                        <span class="nd">@PathParam</span><span class="p">(</span><span class="s">&quot;usage&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">usageString</span><span class="p">,</span>
                        <span class="nd">@PathParam</span><span class="p">(</span><span class="s">&quot;version&quot;</span><span class="p">)</span> <span class="n">Integer</span> <span class="n">version</span><span class="p">,</span>
                        <span class="n">InputStream</span> <span class="n">uploadedInputStream</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">CollectException</span> <span class="p">{</span>
<span class="p">...</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li>closeTransaction()</li>
</ol>
<blockquote>
<div>fermeture de la transaction</div></blockquote>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Path</span><span class="p">(</span><span class="s">&quot;/transactions/{transactionId}/close&quot;</span><span class="p">)</span>
  <span class="nd">@POST</span>
  <span class="nd">@Consumes</span><span class="p">(</span><span class="n">APPLICATION_JSON</span><span class="p">)</span>
  <span class="nd">@Produces</span><span class="p">(</span><span class="n">MediaType</span><span class="p">.</span><span class="na">APPLICATION_JSON</span><span class="p">)</span>
  <span class="nd">@Secured</span><span class="p">(</span><span class="n">permission</span> <span class="o">=</span>  <span class="n">TRANSACTION_CLOSE</span><span class="p">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">&quot;Fermer une transaction&quot;</span><span class="p">)</span>
  <span class="kd">public</span> <span class="n">Response</span> <span class="nf">closeTransaction</span><span class="p">(</span><span class="nd">@PathParam</span><span class="p">(</span><span class="s">&quot;transactionId&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">transactionId</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">...</span>
</pre></div>
</div>
<ol class="arabic" start="6">
<li><p class="first">generateAndSendSip()</p>
<blockquote>
<div><p>génerer un SIP et l’envoyer a Vitam</p>
</div></blockquote>
</li>
</ol>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span>    <span class="nd">@Path</span><span class="p">(</span><span class="s">&quot;/transactions/{transactionId}/send&quot;</span><span class="p">)</span>
<span class="nd">@POST</span>
<span class="nd">@Consumes</span><span class="p">(</span><span class="n">APPLICATION_JSON</span><span class="p">)</span>
<span class="nd">@Produces</span><span class="p">(</span><span class="n">MediaType</span><span class="p">.</span><span class="na">APPLICATION_JSON</span><span class="p">)</span>
<span class="nd">@Secured</span><span class="p">(</span><span class="n">permission</span> <span class="o">=</span>  <span class="n">TRANSACTION_SEND</span><span class="p">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">&quot;Envoyer une transaction&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="n">Response</span> <span class="nf">generateAndSendSip</span><span class="p">(</span><span class="nd">@PathParam</span><span class="p">(</span><span class="s">&quot;transactionId&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">transactionId</span><span class="p">)</span> <span class="p">{</span>
 <span class="p">...</span>
</pre></div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="collect-client.html" class="btn btn-neutral float-left" title="7.3.2.2. Access-client" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../securite/_toc.html" class="btn btn-neutral float-right" title="7.3.3. Sécurité" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Ce document est distribué sous les termes de la Licence Ouverte V2.0.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
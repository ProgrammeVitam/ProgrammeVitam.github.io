<!DOCTYPE html>
<html class="writer-html4" lang="fr" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>5.5. Stockage des données &mdash; Documentation VITAM - Architecture 8.1.0</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="5.6. Concentration et exploitation des logs applicatifs" href="05-logs-architecture.html" />
    <link rel="prev" title="5.4. Architecture technique détaillée" href="03-technical-architecture.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            VITAM - Architecture
              <img src="../_static/logo_vitam.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                8.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html#rappels">2. Rappels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/_toc.html">3. Vue d’ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="../archi-applicative/_toc.html">4. Architecture applicative</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="_toc.html">5. Architecture technique / exploitation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="principes/_toc.html">5.1. Principes d’architecture technique</a></li>
<li class="toctree-l2"><a class="reference internal" href="01-services-techniques.html">5.2. Services techniques fournis par la solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="02-dependencies.html">5.3. Composants logiciels utilisés</a></li>
<li class="toctree-l2"><a class="reference internal" href="03-technical-architecture.html">5.4. Architecture technique détaillée</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.5. Stockage des données</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#strategies-de-stockage">5.5.1. Stratégies de stockage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#offre-filesystem">5.5.2. Offre filesystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="#offre-swift">5.5.3. Offre Swift</a></li>
<li class="toctree-l3"><a class="reference internal" href="#offre-s3">5.5.4. Offre S3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#offre-tape-library">5.5.5. Offre Tape-library</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="05-logs-architecture.html">5.6. Concentration et exploitation des logs applicatifs</a></li>
<li class="toctree-l2"><a class="reference internal" href="06-metrics-architecture.html">5.7. Métriques applicatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="07-deployment-tooling.html">5.8. Outillage de déploiement</a></li>
<li class="toctree-l2"><a class="reference internal" href="08-consul.html">5.9. Service registry</a></li>
<li class="toctree-l2"><a class="reference internal" href="10-it-services.html">5.10. Dépendances aux services d’infrastructures</a></li>
<li class="toctree-l2"><a class="reference internal" href="15-services.html">5.11. Composants déployés</a></li>
<li class="toctree-l2"><a class="reference internal" href="20-deployment-guidelines.html">5.12. Guidelines de déploiement</a></li>
<li class="toctree-l2"><a class="reference internal" href="25-resources.html">5.13. Eléments de dimensionnement</a></li>
<li class="toctree-l2"><a class="reference internal" href="90-flux-all.html">5.14. Matrice des flux</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../securite/_toc.html">6. Sécurité</a></li>
<li class="toctree-l1"><a class="reference internal" href="../include/_toc.html">7. Architecture détaillée</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">VITAM - Architecture</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="_toc.html">5. Architecture technique / exploitation</a></li>
      <li class="breadcrumb-item active">5.5. Stockage des données</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/archi-exploit-infra/04-data-storage.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="stockage-des-donnees">
<span id="datastorage"></span><h1>5.5. Stockage des données<a class="headerlink" href="#stockage-des-donnees" title="Lien permanent vers ce titre">¶</a></h1>
<div class="admonition seealso">
<p class="first admonition-title">Voir aussi</p>
<p class="last">Cette section s’appuie fortement sur <a class="reference internal" href="../archi-applicative/11-data-architecture-multisite.html"><span class="doc">la description de l’architecture des données</span></a>, en particulier en ce qui concerne les données d’archive.</p>
</div>
<p>Les offres de stockage <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> portent la référence des données concernant les archives hébergées par le système <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> : leur contenu binaire (<a class="reference internal" href="../introduction.html#term-bdo"><span class="xref std std-term">BDO</span></a>), mais également les métadonnées associées au sens large (<a class="reference internal" href="../introduction.html#term-au"><span class="xref std std-term">AU</span></a>, <a class="reference internal" href="../introduction.html#term-got"><span class="xref std std-term">GOT</span></a>, journaux).</p>
<p><a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> possède trois implémentations possibles d’offres de stockage «&nbsp;classiques&nbsp;» : l’implémentation basée sur un système de fichiers, l’implémentation Swift et l’implémentation S3.
En complément, une implémentation <em>Tape-library</em>, aussi désignée Offre froide, permet l’usage de robotique de cartouches magnétiques.</p>
<p><a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> peut stocker les données dans plusieurs offres de stockage en parallèle afin de se parer contre la perte de données. Les deux types d’offres peuvent être utilisées seuls ou ensemble sur des offres de stockage différentes : ainsi, on peut configurer <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> pour déposer les données dans 2 offres de stockage filesystem disjointes, ou dans une offre de stockage filesystem et une offre <a class="reference internal" href="../introduction.html#term-swift"><span class="xref std std-term">Swift</span></a>, ou encore dans une offre de stockage filesystem et 2 offres <a class="reference internal" href="../introduction.html#term-swift"><span class="xref std std-term">Swift</span></a> différentes (se basant sur 2 <em>clusters</em> <a class="reference internal" href="../introduction.html#term-swift"><span class="xref std std-term">Swift</span></a> distincts) ; tout dépend des contraintes de non-perte de données, de scalabilité et de résilience à la panne qui sont abordés dans la description des types d’offres ci-dessous. C’est la configuration des stratégies qui permet de définir les offres sur lesquelles vont être stockées les données.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Un mécanisme de resynchronisation d’une offre de stockage avec une autre, migrant de fait les données entre offres, est disponible en mode complet (la procédure est décrite dans le <a class="reference internal" href="../introduction.html#term-dex"><span class="xref std std-term">DEX</span></a>).</p>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Dans le but d’assurer au maximum la pérennité des données conservées dans le système <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a>, il est très fortement conseillé de stocker les données dans au moins 2 technologies de stockage différentes (ex: 2 stockages objets de constructeurs et technologies différentes, un stockage objet et un stockage bloc, 2 stockages bloc de constructeurs et technologies différentes, …)</p>
</div>
<div class="section" id="strategies-de-stockage">
<h2>5.5.1. Stratégies de stockage<a class="headerlink" href="#strategies-de-stockage" title="Lien permanent vers ce titre">¶</a></h2>
<p>VITAM permet de définir plusieurs stratégies de stockage sur une plateforme VITAM.</p>
<p>Plusieurs règles :</p>
<ul class="simple">
<li>une stratégie de plateforme VITAM est obligatoire</li>
<li>la stratégie de plateforme VITAM est utilisée par défaut</li>
<li>la définition d’une stratégie sur une donnée est immutable : on ne peut changer la stratégie d’un objet stocké</li>
</ul>
</div>
<div class="section" id="offre-filesystem">
<h2>5.5.2. Offre filesystem<a class="headerlink" href="#offre-filesystem" title="Lien permanent vers ce titre">¶</a></h2>
<p>L’offre filesystem permet de stocker les données sur un système de fichiers accessible localement par le composant «&nbsp;storage-offer&nbsp;».</p>
<p>Points positifs :</p>
<ul class="simple">
<li>facile à mettre en place</li>
<li>facile à exploiter</li>
<li>facile à sauvegarder</li>
</ul>
<p>Points négatifs :</p>
<ul>
<li><p class="first">pour une offre de stockage, seule une seule instance du service storage-offer peut être active à un instant donné, ce qui implique que cette offre :</p>
<blockquote>
<div><ul class="simple">
<li>n’est pas scalable par multi-instanciation (i.e. horizontalement) ;</li>
<li>ne possède pas de solution de haute disponibilité portée par la solution logicielle.</li>
</ul>
</div></blockquote>
</li>
</ul>
<p>Par conséquent, elle est particulièrement adaptée pour les déploiements de test ou de petite taille (ordre de grandeur : &lt; 10 To), mais est à déconseiller pour les déploiements sur des volumétries importantes.</p>
<div class="admonition caution">
<p class="first admonition-title">Prudence</p>
<p class="last">L’offre filesystem nécessite un système de fichiers acceptant les attributs étendus (ex: XFS) ; en particulier, il n’est donc pas possible d’héberger les données sur un montage NFS (NFS ne supportant pas les attributs étendus).</p>
</div>
</div>
<div class="section" id="offre-swift">
<h2>5.5.3. Offre Swift<a class="headerlink" href="#offre-swift" title="Lien permanent vers ce titre">¶</a></h2>
<p>L’offre Swift permet de stocker les données sur un stockage objet implémentant l”<a class="reference internal" href="../introduction.html#term-api"><span class="xref std std-term">API</span></a> <a class="reference internal" href="../introduction.html#term-swift"><span class="xref std std-term">Swift</span></a>.</p>
<p>Points positifs :</p>
<ul class="simple">
<li>scalable : storage-offer se comporte dans ce scénario comme une passerelle vers l”<a class="reference internal" href="../introduction.html#term-api"><span class="xref std std-term">API</span></a> <a class="reference internal" href="../introduction.html#term-swift"><span class="xref std std-term">Swift</span></a> ; il est donc multi-instanciable au sein d’une offre de stockage.</li>
<li>consomme une <a class="reference internal" href="../introduction.html#term-api"><span class="xref std std-term">API</span></a> normalisée : elle est donc compatible avec un grand nombre d’implémentations différentes de <a class="reference internal" href="../introduction.html#term-swift"><span class="xref std std-term">Swift</span></a>.</li>
</ul>
<p>Points négatifs :</p>
<ul class="simple">
<li>nécessite la mise en place et l’exploitation d’un stockage objet, ce qui est potentiellement plus complexe et moins courant que la mise à disposition d’un simple stockage bloc ou fichier.</li>
</ul>
<p>Par conséquent, elle est particulièrement adaptée pour les déploiements en production de forte volumétrie.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Dans cette version de la solution logicielle <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a>, l’implémentation <a class="reference internal" href="../introduction.html#term-swift"><span class="xref std std-term">Swift</span></a> n’est en théorie pas obligée de permettre l”<em>upload</em> de fichiers de taille non connue par avance (mode <em>chunk encoding</em>) ; cependant, aucun test pertinent n’a pu être effectué faute d’implémentation disponible. Merci de remonter à l’équipe support tout bug associé à ce comportement.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Avertissement</p>
<p class="last">Seule l”<a class="reference internal" href="../introduction.html#term-api"><span class="xref std std-term">API</span></a> d’authentification <em>keystone</em> v3 est aujourd’hui officiellement supportées par la solution logicielle <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a>. Les <a class="reference internal" href="../introduction.html#term-api"><span class="xref std std-term">API</span></a> d’authentification <em>keystone</em> v1 et v2 sont dépréciées.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">L’activation de la configuration de headers spécifiques Vitam lors des appels vers le stockage Swift est gérée par la variable <span class="xref std std-term">enableCustomHeaders</span> (boolean). Si activé, il faut éditer la variable <span class="xref std std-term">customHeaders</span> avec une liste de clé/valeur pour définir la liste des headers à envoyer au niveau des appels HTTP de l’offre vers le serveur de stockage Swift.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> utilise par défaut des connections HTTP persistantes (keep-alive) vers le serveur de stockage Swift si ce dernier les supporte. Si l’infrastructure réseau ou des Reverse-Proxy intermédiaires sont susceptibles de couper occasionnellement les connexions réseau, ceci peut causer des erreurs d’accès au serveur Swift distant. Il peut alors être pertinent de désactiver la persistance des connexions HTTP via le paramètre <span class="xref std std-term">swiftDisableKeepAlive</span> (peut avoir des impacts sur les performances d’accès à l’offre).</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Par tenant <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> utilisé, jusqu’à 17 <em>containers</em> sont créés.</p>
</div>
<p>La liste des <em>containers</em> est :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;units&quot;</span>
<span class="s2">&quot;objects&quot;</span>
<span class="s2">&quot;objectgroups&quot;</span>
<span class="s2">&quot;logbooks&quot;</span>
<span class="s2">&quot;reports&quot;</span>
<span class="s2">&quot;manifests&quot;</span>
<span class="s2">&quot;profiles&quot;</span>
<span class="s2">&quot;storagelog&quot;</span>
<span class="s2">&quot;storageaccesslog&quot;</span>
<span class="s2">&quot;storagetraceability&quot;</span>
<span class="s2">&quot;rules&quot;</span>
<span class="s2">&quot;dip&quot;</span>
<span class="s2">&quot;agencies&quot;</span>
<span class="s2">&quot;backup&quot;</span>
<span class="s2">&quot;backupoperations&quot;</span>
<span class="s2">&quot;unitgraph&quot;</span>
<span class="s2">&quot;objectgroupgraph&quot;</span>
<span class="s2">&quot;distributionreports&quot;</span>
<span class="s2">&quot;accessionregistersdetail&quot;</span>
<span class="s2">&quot;accessionregisterssymbolic&quot;</span>
<span class="s2">&quot;tmp&quot;</span>
<span class="s2">&quot;archivaltransferreply&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="offre-s3">
<h2>5.5.4. Offre S3<a class="headerlink" href="#offre-s3" title="Lien permanent vers ce titre">¶</a></h2>
<p>L’offre S3 permet de stocker les données sur un stockage objet implémentant l”<a class="reference internal" href="../introduction.html#term-api"><span class="xref std std-term">API</span></a> S3.</p>
<p>Les points positifs et négatifs sont les mêmes que pour l’offre <a class="reference internal" href="../introduction.html#term-swift"><span class="xref std std-term">Swift</span></a>.</p>
<p>L’offre S3 utilise le client java S3 du SDK Amazon V1. De ce fait la compatibilité du stockage avec l”<a class="reference internal" href="../introduction.html#term-api"><span class="xref std std-term">API</span></a> S3 sera limitée à sa compatibilité avec le client logiciel sélectionné.
Pour que <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> soit compatible avec l”<a class="reference internal" href="../introduction.html#term-api"><span class="xref std std-term">API</span></a> S3 les noms de conteneurs sont transformés pour obtenir des noms de <em>bucket</em> valides :</p>
<ul class="simple">
<li>remplacement de tous les caractères non alphanumériques par des “.”</li>
<li>suppression des “.” au début et à la fin</li>
<li>passage de tous les caractères en minuscule</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Dans le cas où l’implémentation S3 sous-jacente supporte le versioning des buckets ou la suppression logique des fichiers (aussi connue sous les appellations «&nbsp;soft delete&nbsp;» ou «&nbsp;delete markers&nbsp;»), ces fonctionnalités doivent alors être désactivées. En effet, l’activation des ces fonctionnalités cause une démultiplication de l’espace de stockage et la non suppression des données éliminées.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Dans cette version de la solution logicielle <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a>, l’implémentation S3 fournie par <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> nécessite la taille du fichier pour l’envoyer dans le stockage S3.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Par tenant VITAM utilisé, jusqu’à 17 <em>containers</em> (et donc <strong>buckets</strong>) sont créés.</p>
</div>
<p>La liste des <em>containers</em> est :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;units&quot;</span>
<span class="s2">&quot;objects&quot;</span>
<span class="s2">&quot;objectgroups&quot;</span>
<span class="s2">&quot;logbooks&quot;</span>
<span class="s2">&quot;reports&quot;</span>
<span class="s2">&quot;manifests&quot;</span>
<span class="s2">&quot;profiles&quot;</span>
<span class="s2">&quot;storagelog&quot;</span>
<span class="s2">&quot;storageaccesslog&quot;</span>
<span class="s2">&quot;storagetraceability&quot;</span>
<span class="s2">&quot;rules&quot;</span>
<span class="s2">&quot;dip&quot;</span>
<span class="s2">&quot;agencies&quot;</span>
<span class="s2">&quot;backup&quot;</span>
<span class="s2">&quot;backupoperations&quot;</span>
<span class="s2">&quot;unitgraph&quot;</span>
<span class="s2">&quot;objectgroupgraph&quot;</span>
<span class="s2">&quot;distributionreports&quot;</span>
<span class="s2">&quot;accessionregistersdetail&quot;</span>
<span class="s2">&quot;accessionregisterssymbolic&quot;</span>
<span class="s2">&quot;tmp&quot;</span>
<span class="s2">&quot;archivaltransferreply&quot;</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Avertissement</p>
<p class="last">Par défaut, le fournisseur Amazon définit une limite à 100 <em>buckets</em> ; il convient de revoir ce paramétrage dans le cas où la solution logicielle <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> doit gérer plus de <strong>5</strong> <em>tenants</em>.</p>
</div>
<p>La liste des API S3 utilisées par <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> est :</p>
<p><strong>Buckets</strong></p>
<ul class="simple">
<li>API : GET Bucket acl</li>
</ul>
<p>Exemple :</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[REQUEST (objectAPIHandlers).GetBucketACLHandler-fm] [160087199.728184] [2020-09-23 14:39:57 +0000]
GET /5.dbxuwfvoes/?acl
Host: 127.0.0.1:9999
X-Amz-Content-Sha256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
X-Amz-Date: 20200923T143957Z
Content-Length: 0
Connection: Keep-Alive
Authorization: AWS4-HMAC-SHA256 Credential=MKU4HW1K9HSST78MDY3T/20200923//s3/aws4_request, SignedHeaders=amz-sdk-invocation-id;amz-sdk-retry;content-type;host;user-agent;x-amz-content-sha256;x-amz-date, Signature=640458e964fd2caa14b0ffb4808ee99fdf5d232808a4a8e397c121ea77b00a74
User-Agent: aws-sdk-java/1.11.720 Linux/4.15.0-117-generic OpenJDK_64-Bit_Server_VM/11.0.8+10-post-Ubuntu-0ubuntu118.04.1 java/11.0.8 vendor/Ubuntu
Amz-Sdk-Retry: 0/0/500
Content-Type: application/octet-stream
Amz-Sdk-Invocation-Id: 8db9bb54-6dcf-c5d8-579a-c3dbd293f165
---
</pre></div>
</div>
<ul class="simple">
<li>API : PUT Bucket</li>
</ul>
<p>Exemple :</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[REQUEST (objectAPIHandlers).PutBucketHandler-fm] [160087200.043971] [2020-09-23 14:40:00 +0000]
PUT /5.dbxuwfvoes/
Host: 127.0.0.1:9999
Amz-Sdk-Invocation-Id: 9d77b44d-8d52-7065-1872-ac9975a63425
Amz-Sdk-Retry: 0/0/500
Authorization: AWS4-HMAC-SHA256 Credential=MKU4HW1K9HSST78MDY3T/20200923//s3/aws4_request, SignedHeaders=amz-sdk-invocation-id;amz-sdk-retry;content-type;host;user-agent;x-amz-content-sha256;x-amz-date, Signature=e03a2feaaff4538887a06ca53a7c4c9609effc6dbd34d9191ec461f3b5e43918
Connection: Keep-Alive
Content-Type: application/octet-stream
User-Agent: aws-sdk-java/1.11.720 Linux/4.15.0-117-generic OpenJDK_64-Bit_Server_VM/11.0.8+10-post-Ubuntu-0ubuntu118.04.1 java/11.0.8 vendor/Ubuntu
X-Amz-Content-Sha256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
X-Amz-Date: 20200923T144000Z
Content-Length: 0
---
</pre></div>
</div>
<ul class="simple">
<li>API : GET Bucket (List Objects)Version 2</li>
</ul>
<p>Exemple 1 :</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[REQUEST (objectAPIHandlers).ListObjectsV2Handler-fm] [160087204.792921] [2020-09-23 14:40:47 +0000]
GET /7.hvybpdxfsm/?list-type=2&amp;max-keys=1000&amp;fetch-owner=false
Host: 127.0.0.1:9999
Content-Type: application/octet-stream
Amz-Sdk-Invocation-Id: df03b558-11b5-1ce6-a69c-f1086718ee0b
Amz-Sdk-Retry: 0/0/500
User-Agent: aws-sdk-java/1.11.720 Linux/4.15.0-117-generic OpenJDK_64-Bit_Server_VM/11.0.8+10-post-Ubuntu-0ubuntu118.04.1 java/11.0.8 vendor/Ubuntu
X-Amz-Content-Sha256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
X-Amz-Date: 20200923T144047Z
Content-Length: 0
Connection: Keep-Alive
Authorization: AWS4-HMAC-SHA256 Credential=MKU4HW1K9HSST78MDY3T/20200923//s3/aws4_request, SignedHeaders=amz-sdk-invocation-id;amz-sdk-retry;content-type;host;user-agent;x-amz-content-sha256;x-amz-date, Signature=3331501246aee47854132b6d9deec6dce68468e6c70363d2901434f7753673c3
</pre></div>
</div>
<p>Exemple 2 :</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[REQUEST (objectAPIHandlers).ListObjectsV2Handler-fm] [160087204.796455] [2020-09-23 14:40:47 +0000]
GET /7.hvybpdxfsm/?list-type=2&amp;continuation-token=aeaaaaaaaabe6it7abvtgaluxnunfjqaaaaq188&amp;max-keys=1000&amp;fetch-owner=false
Host: 127.0.0.1:9999
Amz-Sdk-Retry: 0/0/500
Authorization: AWS4-HMAC-SHA256 Credential=MKU4HW1K9HSST78MDY3T/20200923//s3/aws4_request, SignedHeaders=amz-sdk-invocation-id;amz-sdk-retry;content-type;host;user-agent;x-amz-content-sha256;x-amz-date, Signature=c482925c51dcaa4fa8ab65ade329fc1e968726edb2c2fe0313345aeced2ea1e6
Content-Type: application/octet-stream
User-Agent: aws-sdk-java/1.11.720 Linux/4.15.0-117-generic OpenJDK_64-Bit_Server_VM/11.0.8+10-post-Ubuntu-0ubuntu118.04.1 java/11.0.8 vendor/Ubuntu
Content-Length: 0
Amz-Sdk-Invocation-Id: 8f314f3e-fde9-b341-6bc1-8c0b3a830ef3
X-Amz-Content-Sha256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
X-Amz-Date: 20200923T144047Z
Connection: Keep-Alive
</pre></div>
</div>
<p><strong>Objects</strong></p>
<ul class="simple">
<li>API : HEAD Object</li>
</ul>
<p>Exemple :</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[REQUEST (objectAPIHandlers).HeadObjectHandler-fm] [160087199.737232] [2020-09-23 14:39:57 +0000]
HEAD /5.dbxuwfvoes/aeaaaaaaaabe6it7abu44aluxnubyjiaaaaq
Host: 127.0.0.1:9999
Content-Type: application/octet-stream
User-Agent: aws-sdk-java/1.11.720 Linux/4.15.0-117-generic OpenJDK_64-Bit_Server_VM/11.0.8+10-post-Ubuntu-0ubuntu118.04.1 java/11.0.8 vendor/Ubuntu
X-Amz-Date: 20200923T143957Z
Connection: Keep-Alive
X-Amz-Content-Sha256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
Amz-Sdk-Invocation-Id: 3b849433-402b-b1fe-da13-d6d7ed267ff5
Amz-Sdk-Retry: 0/0/500
Authorization: AWS4-HMAC-SHA256 Credential=MKU4HW1K9HSST78MDY3T/20200923//s3/aws4_request, SignedHeaders=amz-sdk-invocation-id;amz-sdk-retry;content-type;host;user-agent;x-amz-content-sha256;x-amz-date, Signature=4a465630ac0523e27bb3dfaa6a573ee3a3516cc884ff037b11f947b309095041
---
</pre></div>
</div>
<ul class="simple">
<li>API : Delete Object</li>
</ul>
<p>Exemple :</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[REQUEST (objectAPIHandlers).DeleteObjectHandler-fm] [160087199.737773] [2020-09-23 14:39:57 +0000]
DELETE /5.dbxuwfvoes/aeaaaaaaaabe6it7abu44aluxnubyjiaaaaq
Host: 127.0.0.1:9999
Amz-Sdk-Invocation-Id: 7920dbea-9ac8-8928-8f48-b0a587738f24
X-Amz-Content-Sha256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
X-Amz-Date: 20200923T143957Z
Connection: Keep-Alive
Amz-Sdk-Retry: 0/0/500
Authorization: AWS4-HMAC-SHA256 Credential=MKU4HW1K9HSST78MDY3T/20200923//s3/aws4_request, SignedHeaders=amz-sdk-invocation-id;amz-sdk-retry;content-type;host;user-agent;x-amz-content-sha256;x-amz-date, Signature=1b5243ccfc2f43518d70a0a71fdc96971b8b16ab4ff2721648ad38b77ea48048
Content-Type: application/octet-stream
User-Agent: aws-sdk-java/1.11.720 Linux/4.15.0-117-generic OpenJDK_64-Bit_Server_VM/11.0.8+10-post-Ubuntu-0ubuntu118.04.1 java/11.0.8 vendor/Ubuntu
---
</pre></div>
</div>
<ul class="simple">
<li>API : GET Object</li>
</ul>
<p>Exemple :</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[REQUEST (objectAPIHandlers).GetObjectHandler-fm] [160087200.042941] [2020-09-23 14:40:00 +0000]
GET /5.dbxuwfvoes/aeaaaaaaaabe6it7abu44aluxnubyjiaaaaq
Host: 127.0.0.1:9999
X-Amz-Date: 20200923T144000Z
Content-Length: 0
Amz-Sdk-Invocation-Id: e146fb12-0283-af0d-83ef-fbcf01ad589d
Amz-Sdk-Retry: 0/0/500
Authorization: AWS4-HMAC-SHA256 Credential=MKU4HW1K9HSST78MDY3T/20200923//s3/aws4_request, SignedHeaders=amz-sdk-invocation-id;amz-sdk-retry;content-type;host;user-agent;x-amz-content-sha256;x-amz-date, Signature=687b0e4098bced5f3fb99bf9a7bb1a994532f65bb66a101889892fa1a55ed925
Content-Type: application/octet-stream
User-Agent: aws-sdk-java/1.11.720 Linux/4.15.0-117-generic OpenJDK_64-Bit_Server_VM/11.0.8+10-post-Ubuntu-0ubuntu118.04.1 java/11.0.8 vendor/Ubuntu
X-Amz-Content-Sha256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
Connection: Keep-Alive

&lt;BODY&gt;
---
</pre></div>
</div>
<ul class="simple">
<li>API : PUT Object</li>
</ul>
<p>Exemple :</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[REQUEST (objectAPIHandlers).PutObjectHandler-fm] [160087199.739414] [2020-09-23 14:39:57 +0000]
PUT /5.dbxuwfvoes/aeaaaaaaaabe6it7abu44aluxnubyjiaaaaq
Host: 127.0.0.1:9999
Amz-Sdk-Retry: 0/0/500
X-Amz-Content-Sha256: STREAMING-AWS4-HMAC-SHA256-PAYLOAD
X-Amz-Date: 20200923T143957Z
Content-Length: 7081
Connection: Keep-Alive
Expect: 100-continue
Amz-Sdk-Invocation-Id: f7ce7617-0563-19ea-1187-33811dc527ac
Authorization: AWS4-HMAC-SHA256 Credential=MKU4HW1K9HSST78MDY3T/20200923//s3/aws4_request, SignedHeaders=amz-sdk-invocation-id;amz-sdk-retry;content-length;content-type;host;user-agent;x-amz-content-sha256;x-amz-date;x-amz-decoded-content-length, Signature=02c10a4598ae8804e416c69249c6e214a100e145b9ec02f3ff3925a73f6b085f
Content-Type: application/octet-stream
User-Agent: aws-sdk-java/1.11.720 Linux/4.15.0-117-generic OpenJDK_64-Bit_Server_VM/11.0.8+10-post-Ubuntu-0ubuntu118.04.1 java/11.0.8 vendor/Ubuntu
X-Amz-Decoded-Content-Length: 6906

&lt;BODY&gt;
---
</pre></div>
</div>
<ul class="simple">
<li>API :  PUT Object - Copy</li>
</ul>
<p>Exemple :</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[REQUEST (objectAPIHandlers).CopyObjectHandler-fm] [160087200.056875] [2020-09-23 14:40:00 +0000]
PUT /5.dbxuwfvoes/aeaaaaaaaabe6it7abu44aluxnubyjiaaaaq
Host: 127.0.0.1:9999
X-Amz-Meta-Digest: 9ba9ef903b46798c83d46bcbd42805eb69ad1b6a8b72e929f87d72f5263a05ade47d8e2f860aece8b9e3acb948364fedf75a3367515cd912965ed22a246ea418
X-Amz-Date: 20200923T144000Z
Content-Length: 0
Content-Type: application/octet-stream
Amz-Sdk-Invocation-Id: a3de1f75-d08d-b7d6-ad23-7c16e23c4e4f
User-Agent: aws-sdk-java/1.11.720 Linux/4.15.0-117-generic OpenJDK_64-Bit_Server_VM/11.0.8+10-post-Ubuntu-0ubuntu118.04.1 java/11.0.8 vendor/Ubuntu
X-Amz-Content-Sha256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
X-Amz-Copy-Source: /5.dbxuwfvoes/aeaaaaaaaabe6it7abu44aluxnubyjiaaaaq
X-Amz-Meta-Digest-Type: SHA-512
X-Amz-Metadata-Directive: REPLACE
Connection: Keep-Alive
Amz-Sdk-Retry: 0/0/500
Authorization: AWS4-HMAC-SHA256 Credential=MKU4HW1K9HSST78MDY3T/20200923//s3/aws4_request, SignedHeaders=amz-sdk-invocation-id;amz-sdk-retry;content-length;content-type;host;user-agent;x-amz-content-sha256;x-amz-copy-source;x-amz-date;x-amz-meta-digest;x-amz-meta-digest-type;x-amz-metadata-directive, Signature=6a366171c7f83a9fed12402e9984aaab8148bb7f438cbf43465ee7ed8ae7b7dc
---
</pre></div>
</div>
</div>
<div class="section" id="offre-tape-library">
<h2>5.5.5. Offre Tape-library<a class="headerlink" href="#offre-tape-library" title="Lien permanent vers ce titre">¶</a></h2>
<p>L’offre <em>Tape-library</em>, aussi désignée <strong>Offre Froide</strong>, permet de stocker les données sur des librairies de cartouches magnétiques.</p>
<p>Elle s’appuie sur des commandes linux standard pour manipuler les éléments robotiques. Elle est donc à priori compatible avec tous les matériels compatibles Linux.</p>
<p>Points positifs :</p>
<ul class="simple">
<li>Froide : à contrario des offres disques déjà utilisables dans <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> (FS ou Objet), l’accès aux données sur les cartouches n’est pas immédiat. Il nécessite le montage des cartouches dans des lecteurs, qui sont en nombre limités. En cas de corruption des données des offres disques (par exemple, attaque de type <em>ransomware</em>), sa répercussion vers les données archivées sur cartouches serait très lente. C’est une garantie de sécurité supplémentaire.</li>
<li>Peu onéreuse pour le stockage des grands volumes : comparée à un stockage disque, un stockage bande est moins onéreux: 1 To de stockage sur LTO revient à 10€ HT.</li>
<li>Durabilité des bandes : 15-30 ans contre 5 ans pour les HDD/SSD, avec 20000 cycles de chargements/déchargements.</li>
<li>Possibilité de blocage physique des réécritures (WORM), de compression et de chiffrement natifs des données.</li>
<li>Externalisable : les cartouches peuvent être extraites de la librairie une fois les données inscrites, et stockées dans un local sécurisé tiers.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Dans sa version actuelle, <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> ne prend pas en charge les opérations d’externalisation. Ce process ne peut être réalisé que manuellement.</p>
</div>
<p>Points négatifs :</p>
<ul class="simple">
<li>N’est pas multi-instantiable : Pour une offre de stockage, seule une seule instance du service storage-offer peut être active à un instant donné (i.e. ne peut être déployée en haute disponibilité)</li>
<li>Nécessite une infrastructure lourde (hardware, hébergement…), coûteuse à installer et compliquée à exploiter.</li>
<li>Nécessite un espace de stockage disque local <code class="docutils literal notranslate"><span class="pre">/vitam/data/offer</span></code> conséquent (espace «&nbsp;tampon&nbsp;» pour écriture rapide + espace «&nbsp;cache&nbsp;» pour relecture des données).</li>
</ul>
<p>L’offre Tape-library utilise les commandes standard <code class="docutils literal notranslate"><span class="pre">mt</span></code>, <code class="docutils literal notranslate"><span class="pre">mtx</span></code> et <code class="docutils literal notranslate"><span class="pre">dd</span></code> pour manipuler les lecteurs de bandes et la librairie. Ces outils sont installés sur le serveur où est déployée l’offre froide.
Cette même machine doit également avoir accès à la librairie soit par attachement direct, soit par le biais d’un accès distant ( ex: iscsi )</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">L’usage des commandes <code class="docutils literal notranslate"><span class="pre">mt</span></code> et <code class="docutils literal notranslate"><span class="pre">mtx</span></code> nécessite des droits spécifiques. L’utilisateur vitam est automatiquement ajouté au groupe unix «&nbsp;tape&nbsp;» sur le serveur où est déployée l’offre froide.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Le dossier <code class="docutils literal notranslate"><span class="pre">/vitam/data/offer/</span></code> doit correspondre à une seule partition de système de fichiers (i.e. tout le contenu du dossier <code class="docutils literal notranslate"><span class="pre">/vitam/data/offer</span></code> doit appartenir au même point de montage). Le système de fichiers doit supporter les opérations de atomiques (type atomic rename / move) et la création de liens symboliques (ex. XFS, EXT4…)</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">Voir aussi</p>
<p class="last">Les principes de fonctionnement de l’offre froide sont décrits dans la documentation externe dédiée («&nbsp;Archivage sur Offre Froide&nbsp;»).</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="03-technical-architecture.html" class="btn btn-neutral float-left" title="5.4. Architecture technique détaillée" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="05-logs-architecture.html" class="btn btn-neutral float-right" title="5.6. Concentration et exploitation des logs applicatifs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Ce document est distribué sous les termes de la Licence Ouverte V2.0.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
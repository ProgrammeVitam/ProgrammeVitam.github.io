<!DOCTYPE html>
<html class="writer-html4" lang="fr" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>5.13. Eléments de dimensionnement &mdash; Documentation VITAM - Architecture 8.1.0</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="5.14. Matrice des flux" href="90-flux-all.html" />
    <link rel="prev" title="5.12. Guidelines de déploiement" href="20-deployment-guidelines.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            VITAM - Architecture
              <img src="../_static/logo_vitam.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                8.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html#rappels">2. Rappels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/_toc.html">3. Vue d’ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="../archi-applicative/_toc.html">4. Architecture applicative</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="_toc.html">5. Architecture technique / exploitation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="principes/_toc.html">5.1. Principes d’architecture technique</a></li>
<li class="toctree-l2"><a class="reference internal" href="01-services-techniques.html">5.2. Services techniques fournis par la solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="02-dependencies.html">5.3. Composants logiciels utilisés</a></li>
<li class="toctree-l2"><a class="reference internal" href="03-technical-architecture.html">5.4. Architecture technique détaillée</a></li>
<li class="toctree-l2"><a class="reference internal" href="04-data-storage.html">5.5. Stockage des données</a></li>
<li class="toctree-l2"><a class="reference internal" href="05-logs-architecture.html">5.6. Concentration et exploitation des logs applicatifs</a></li>
<li class="toctree-l2"><a class="reference internal" href="06-metrics-architecture.html">5.7. Métriques applicatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="07-deployment-tooling.html">5.8. Outillage de déploiement</a></li>
<li class="toctree-l2"><a class="reference internal" href="08-consul.html">5.9. Service registry</a></li>
<li class="toctree-l2"><a class="reference internal" href="10-it-services.html">5.10. Dépendances aux services d’infrastructures</a></li>
<li class="toctree-l2"><a class="reference internal" href="15-services.html">5.11. Composants déployés</a></li>
<li class="toctree-l2"><a class="reference internal" href="20-deployment-guidelines.html">5.12. Guidelines de déploiement</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.13. Eléments de dimensionnement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#compute">5.13.1. Compute</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#xsmall-developpement-local">5.13.1.1. «&nbsp;xsmall&nbsp;» : développement local</a></li>
<li class="toctree-l4"><a class="reference internal" href="#small-recette-simple-metier">5.13.1.2. «&nbsp;small&nbsp;» : recette simple métier</a></li>
<li class="toctree-l4"><a class="reference internal" href="#medium-production-pour-volumetries-moyennes">5.13.1.3. «&nbsp;medium&nbsp;» : production pour volumétries moyennes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#large-production-pour-volumetries-moyennes-avec-besoin-de-resilience">5.13.1.4. «&nbsp;large&nbsp;» :  production pour volumétries moyennes avec besoin de résilience</a></li>
<li class="toctree-l4"><a class="reference internal" href="#xlarge-production-pour-fortes-volumetries">5.13.1.5. «&nbsp;xlarge&nbsp;» : production pour fortes volumétries</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#stockage">5.13.2. Stockage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reseau-inter-site">5.13.3. Réseau : inter-site</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scalabilite">5.13.4. Scalabilité</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="90-flux-all.html">5.14. Matrice des flux</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../securite/_toc.html">6. Sécurité</a></li>
<li class="toctree-l1"><a class="reference internal" href="../include/_toc.html">7. Architecture détaillée</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">VITAM - Architecture</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="_toc.html">5. Architecture technique / exploitation</a></li>
      <li class="breadcrumb-item active">5.13. Eléments de dimensionnement</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/archi-exploit-infra/25-resources.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="elements-de-dimensionnement">
<h1>5.13. Eléments de dimensionnement<a class="headerlink" href="#elements-de-dimensionnement" title="Lien permanent vers ce titre">¶</a></h1>
<div class="admonition caution">
<p class="first admonition-title">Prudence</p>
<p class="last">Les abaques de dimensionnement sont étroitement liés à la nature de l’infrastructure sous-jacente et à l’usage qui est fait de la solution logicielle  <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a>. Par conséquent, les indications de volumétrie qui sont présentées dans la suite de ce document sont purement indicatives et relatives au système <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> dans sa version actuelle, installé sur les environnements de tests de la solution logicielle (qui sont opérés en environnement complètement virtualisé).</p>
</div>
<div class="admonition caution">
<p class="first admonition-title">Prudence</p>
<p class="last">Réaliser un benchmarking sur un environnement de test de charge (avec des jeux de données et une infrastructure similaires à celle de production) est fortement recommandé pour valider le bon dimensionnement de la plateforme.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Sauf mention contraire, les enveloppes de ressources ci-dessous comprennent notamment les composants associés à l’exploitation de la solution logicielle <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> et fournis dans le cadre de la solution (traitement et stockage des logs et des métriques, gestion des bases de données, …)</p>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p>Les configurations de référence ci-dessous sont données pour un seul site primaire comportant une seule offre de stockage. <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> préconise très fortement un déploiement comportant <em>a minima</em> 2 offres de stockage. En fonction des contraintes de disponibilité du système, il sera donc nécessaire :</p>
<ul class="last simple">
<li>Soit d’ajouter une autre offre de stockage (i.e. les composants storage-offer et mongo*-offer) dans le cas d’un déploiement mono-site ;</li>
<li>Soit d’ajouter un site secondaire comportant sa propre offre de stockage.</li>
</ul>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Un monitoring régulier de la plateforme (via prometheus par exemple) est nécessaire. En plus de permettre la vérification du bon fonctionnement de la solution, il permet également de valider son dimensionnement, et de le réadapter si besoin.</p>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Les composants <code class="docutils literal notranslate"><span class="pre">workspace</span></code> et <code class="docutils literal notranslate"><span class="pre">processing</span></code> sont mono-instantiables uniquement. De même, pour les composants <code class="docutils literal notranslate"><span class="pre">storage-offer</span></code> de type «&nbsp;Système de fichier&nbsp;» ou «&nbsp;Bandes magnétiques&nbsp;» (offre froide), une seule instance peut être déployée par offre. Les composants <code class="docutils literal notranslate"><span class="pre">storage-offer</span></code> de type «&nbsp;S3&nbsp;» ou «&nbsp;Swift&nbsp;» sont multi-instantiables.</p>
</div>
<div class="section" id="compute">
<h2>5.13.1. Compute<a class="headerlink" href="#compute" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="xsmall-developpement-local">
<h3>5.13.1.1. «&nbsp;xsmall&nbsp;» : développement local<a class="headerlink" href="#xsmall-developpement-local" title="Lien permanent vers ce titre">¶</a></h3>
<p>Adapté à un poste de développement ; ce déploiement ne comprend pas les composants d’exploitation de la solution <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a>. La chaîne de traitement de logs n’est pas déployée, et le même cluster mongodb est utilisé pour l’offre de stockage et les métadonnées.</p>
<p>Ce déploiement n’est pas adapté pour un fonctionnement en production.</p>
<table border="1" class="docutils" id="id1">
<caption><span class="caption-text">Dimensionnement XSmall</span><a class="headerlink" href="#id1" title="Lien permanent vers ce tableau">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Zone</th>
<th class="head">Composants</th>
<th class="head"># instances</th>
<th class="head">vCPU / instance</th>
<th class="head">RAM / instance</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ul class="first last simple">
<li>zone_access</li>
<li>zone_external</li>
<li>zone_applicative</li>
<li>zone_data</li>
<li>zone_storage</li>
<li>zone_admin</li>
</ul>
</td>
<td><ul class="first last simple">
<li>hosts_ihm_demo</li>
<li>hosts_ihm_recette</li>
<li>hosts_cerebro</li>
<li>hosts_ingest_external</li>
<li>hosts_access_external</li>
<li>hosts_ingest_internal</li>
<li>hosts_access_internal</li>
<li>hosts_storage_engine</li>
<li>hosts_workspace</li>
<li>hosts_processing</li>
<li>hosts_worker</li>
<li>hosts_functional_administration</li>
<li>hosts_logbook</li>
<li>hosts_security_internal</li>
<li>hosts_batch_report</li>
<li>hosts_scheduler</li>
<li>hosts_metadata</li>
<li>hosts_mongoc_data</li>
<li>hosts_mongos_data</li>
<li>hosts_mongod_data</li>
<li>hosts_elasticsearch_data</li>
<li>hosts_storage_offer_default (file)</li>
<li>hosts_consul_server</li>
</ul>
</td>
<td>1</td>
<td>4</td>
<td>16 Go</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>TOTAL GLOBAL ENV</td>
<td>vitam</td>
<td>1</td>
<td>4</td>
<td>16 Go</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Pour ce type d’environnement, il est recommandé de définir un paramètre <code class="docutils literal notranslate"><span class="pre">elasticsearch_memory</span></code> ( pour les composants <code class="docutils literal notranslate"><span class="pre">elasticsearch-log</span></code> et <code class="docutils literal notranslate"><span class="pre">elasticsearch-data</span></code>) avec une taille faible et compatible avec les ressources disponibles, afin de ne pas rencontrer de phénomènes de <a class="reference internal" href="../introduction.html#term-oom"><span class="xref std std-term">OOM</span></a>.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">Voir aussi</p>
<p class="last">Se reporter au <a class="reference internal" href="../introduction.html#term-din"><span class="xref std std-term">DIN</span></a> pour plus d’informations.</p>
</div>
</div>
<div class="section" id="small-recette-simple-metier">
<h3>5.13.1.2. «&nbsp;small&nbsp;» : recette simple métier<a class="headerlink" href="#small-recette-simple-metier" title="Lien permanent vers ce titre">¶</a></h3>
<p>Adapté à un environnement de recette simple d’application métier utilisant <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a>.</p>
<p>Ce déploiement n’est pas adapté pour un fonctionnement en production.</p>
<table border="1" class="docutils" id="id2">
<caption><span class="caption-text">Dimensionnement Small</span><a class="headerlink" href="#id2" title="Lien permanent vers ce tableau">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Zone</th>
<th class="head">Composants</th>
<th class="head"># instances</th>
<th class="head">vCPU / instance</th>
<th class="head">RAM / instance</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ul class="first last simple">
<li>zone_external</li>
<li>zone_applicative</li>
</ul>
</td>
<td><ul class="first last simple">
<li>hosts_ingest_external</li>
<li>hosts_access_external</li>
<li>hosts_ingest_internal</li>
<li>hosts_access_internal</li>
<li>hosts_storage_engine</li>
<li>hosts_workspace</li>
<li>hosts_processing</li>
<li>hosts_worker</li>
</ul>
</td>
<td>1</td>
<td>6</td>
<td>12 Go</td>
</tr>
<tr class="row-odd"><td><ul class="first last simple">
<li>zone_access</li>
<li>zone_applicative</li>
<li>zone_data</li>
</ul>
</td>
<td><ul class="first last simple">
<li>hosts_ihm_demo</li>
<li>hosts_ihm_recette</li>
<li>hosts_functional_administration</li>
<li>hosts_security_internal</li>
<li>hosts_logbook</li>
<li>hosts_batch_report</li>
<li>hosts_scheduler</li>
<li>hosts_metadata</li>
<li>hosts_mongoc_data</li>
<li>hosts_mongos_data</li>
<li>hosts_mongod_data</li>
<li>hosts_elasticsearch_data</li>
</ul>
</td>
<td>1</td>
<td>6</td>
<td>12 Go</td>
</tr>
<tr class="row-even"><td><ul class="first last simple">
<li>zone_storage</li>
<li>zone_admin</li>
</ul>
</td>
<td><ul class="first last simple">
<li>hosts_storage_offer_default (file)</li>
<li>hosts_mongoc_offer</li>
<li>hosts_mongos_offer</li>
<li>hosts_mongod_offer</li>
<li>hosts_elasticsearch_log</li>
<li>hosts_consul_server</li>
<li>hosts_logstash</li>
<li>hosts_kibana_log</li>
<li>hosts_cerebro</li>
<li>hosts_kibana_data</li>
</ul>
</td>
<td>1</td>
<td>6</td>
<td>12 Go</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>TOTAL GLOBAL ENV</td>
<td>vitam</td>
<td>3</td>
<td>18</td>
<td>36</td>
</tr>
</tbody>
</table>
<p>S’agissant d’un environnement de recette, l’utilisation de 2 offres de stockages ou de 2 sites est possible, mais non préconisée (il s’agit d’un environnement de recette métier, et non technique).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Pour ce type d’environnement, il est recommandé de définir un paramètre <code class="docutils literal notranslate"><span class="pre">elasticsearch_memory</span></code> ( pour les composants <code class="docutils literal notranslate"><span class="pre">elasticsearch-log</span></code> et <code class="docutils literal notranslate"><span class="pre">elasticsearch-data</span></code>) avec une taille faible et compatible avec les ressources disponibles, afin de ne pas rencontrer de phénomènes de <a class="reference internal" href="../introduction.html#term-oom"><span class="xref std std-term">OOM</span></a>.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">Voir aussi</p>
<p class="last">Se reporter au <a class="reference internal" href="../introduction.html#term-din"><span class="xref std std-term">DIN</span></a> pour plus d’informations.</p>
</div>
</div>
<div class="section" id="medium-production-pour-volumetries-moyennes">
<h3>5.13.1.3. «&nbsp;medium&nbsp;» : production pour volumétries moyennes<a class="headerlink" href="#medium-production-pour-volumetries-moyennes" title="Lien permanent vers ce titre">¶</a></h3>
<p>Adapté à un déploiement simple pour des volumétries moyennes (quelques To / an) ; seuls le worker et les composants stockant des données sont multi-instanciés (i.e. les bases de données et les offres de stockage). L’offre de stockage proposée est une offre de stockage «&nbsp;file&nbsp;», plus simple à exploiter et compatible avec une volumétrie moyenne.</p>
<p>Sur les 3 serveurs mongod et mongoc pour l’offre de stockage, l’un d’eux est déployé en tant qu’arbitre (participe au quorum du replica set, mais ne stocke pas de données).</p>
<table border="1" class="docutils" id="id3">
<caption><span class="caption-text">Dimensionnement Medium</span><a class="headerlink" href="#id3" title="Lien permanent vers ce tableau">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Zone</th>
<th class="head">Composants</th>
<th class="head"># instances</th>
<th class="head">vCPU / instance</th>
<th class="head">RAM / instance</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>zone_access</td>
<td><ul class="first last simple">
<li>hosts_ihm_demo</li>
</ul>
</td>
<td>1</td>
<td>1</td>
<td>2 Go</td>
</tr>
<tr class="row-odd"><td>zone_external</td>
<td><ul class="first last simple">
<li>hosts_ingest_external</li>
<li>hosts_access_external</li>
</ul>
</td>
<td>1</td>
<td>1</td>
<td>2 Go</td>
</tr>
<tr class="row-even"><td>zone_applicative</td>
<td><ul class="first last simple">
<li>hosts_ingest_internal</li>
<li>hosts_access_internal</li>
<li>hosts_functional_administration</li>
<li>hosts_logbook</li>
<li>hosts_security_internal</li>
<li>hosts_metadata</li>
</ul>
</td>
<td>1</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone_applicative</td>
<td><ul class="first last simple">
<li>hosts_storage_engine</li>
<li>hosts_workspace</li>
<li>hosts_batch_report</li>
<li>hosts_scheduler</li>
<li>hosts_processing</li>
</ul>
</td>
<td>1</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-even"><td>zone_applicative</td>
<td><ul class="first last simple">
<li>hosts_worker</li>
</ul>
</td>
<td>2</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone_storage</td>
<td><ul class="first last simple">
<li>hosts_storage_offer_default (file)</li>
<li>hosts_mongoc_offer (arbitre)</li>
<li>hosts_mongod_offer (arbitre)</li>
</ul>
</td>
<td>1</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-even"><td>zone_storage</td>
<td><ul class="first last simple">
<li>hosts_mongoc_offer</li>
<li>hosts_mongos_offer</li>
<li>hosts_mongod_offer</li>
</ul>
</td>
<td>2</td>
<td>2</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone_data</td>
<td><ul class="first last simple">
<li>hosts_mongoc_data</li>
<li>hosts_mongos_data</li>
<li>hosts_mongod_data</li>
<li>hosts_elasticsearch_data</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>8 Go</td>
</tr>
<tr class="row-even"><td>zone_admin</td>
<td><ul class="first last simple">
<li>hosts_elasticsearch_log</li>
<li>hosts_consul_server</li>
<li>hosts_logstash</li>
<li>hosts_kibana_log (x1 uniquement)</li>
<li>hosts_cerebro (x1 uniquement)</li>
<li>hosts_kibana_data (x1 uniquement)</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>8 Go</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>TOTAL GLOBAL ENV</td>
<td>vitam</td>
<td>15</td>
<td>50</td>
<td>80</td>
</tr>
</tbody>
</table>
<p>Comme précisé précédemment, ce dimensionnement ne contient qu’une seule offre de stockage ; il devra être complété de préférence par un deuxième site (avec le même dimensionnement), ou bien par une offre de stockage supplémentaire sur le site principal (en doublant les ressources allouées à la zone storage).</p>
</div>
<div class="section" id="large-production-pour-volumetries-moyennes-avec-besoin-de-resilience">
<h3>5.13.1.4. «&nbsp;large&nbsp;» :  production pour volumétries moyennes avec besoin de résilience<a class="headerlink" href="#large-production-pour-volumetries-moyennes-avec-besoin-de-resilience" title="Lien permanent vers ce titre">¶</a></h3>
<p>Adapté à un déploiement résilient pour des volumétries plus importantes (10 à 20 To / an) ; ce déploiement comprend au moins deux instances pour tous les composants le supportant, et passe à une offre de stockage objet Swift ou S3 (pour une meilleure scalabilité de l’offre).</p>
<table border="1" class="docutils" id="id4">
<caption><span class="caption-text">Dimensionnement Large</span><a class="headerlink" href="#id4" title="Lien permanent vers ce tableau">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Zone</th>
<th class="head">Composants</th>
<th class="head"># instances</th>
<th class="head">vCPU / instance</th>
<th class="head">RAM / instance</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>zone_access</td>
<td><ul class="first last simple">
<li>hosts_ihm_demo</li>
</ul>
</td>
<td>1</td>
<td>2</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone_external</td>
<td><ul class="first last simple">
<li>hosts_ingest_external</li>
<li>hosts_access_external</li>
</ul>
</td>
<td>2</td>
<td>1</td>
<td>4 Go</td>
</tr>
<tr class="row-even"><td>zone_applicative</td>
<td><ul class="first last simple">
<li>hosts_ingest_internal</li>
<li>hosts_access_internal</li>
<li>hosts_functional_administration</li>
</ul>
</td>
<td>2</td>
<td>1</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone_applicative</td>
<td><ul class="first last simple">
<li>hosts_logbook</li>
<li>hosts_batch_report</li>
<li>hosts_security_internal</li>
<li>hosts_metadata</li>
<li>hosts_storage_engine</li>
</ul>
</td>
<td>2</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-even"><td>zone_applicative</td>
<td><ul class="first last simple">
<li>hosts_worker</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone_applicative</td>
<td><ul class="first last simple">
<li>hosts_workspace</li>
<li>hosts_batch_report</li>
<li>hosts_scheduler</li>
<li>hosts_processing</li>
</ul>
</td>
<td>1</td>
<td>4</td>
<td>6 Go</td>
</tr>
<tr class="row-even"><td>zone_storage</td>
<td><ul class="first last simple">
<li>hosts_storage_offer_default (swift/s3)</li>
<li>hosts_mongoc_offer</li>
<li>hosts_mongos_offer</li>
<li>hosts_mongod_offer</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>8 Go</td>
</tr>
<tr class="row-odd"><td>zone_data</td>
<td><ul class="first last simple">
<li>hosts_elasticsearch_data</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>6 Go</td>
</tr>
<tr class="row-even"><td>zone_data</td>
<td><ul class="first last simple">
<li>hosts_mongoc_data</li>
<li>hosts_mongos_data</li>
</ul>
</td>
<td>3</td>
<td>2</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone_data</td>
<td><ul class="first last simple">
<li>hosts_mongod_data</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>12 Go</td>
</tr>
<tr class="row-even"><td>zone_admin</td>
<td><ul class="first last simple">
<li>hosts_logstash</li>
<li>hosts_kibana_log (x1 uniquement)</li>
<li>hosts_cerebro (x1 uniquement)</li>
<li>hosts_kibana_data (x1 uniquement)</li>
</ul>
</td>
<td>2</td>
<td>2</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone_admin</td>
<td><ul class="first last simple">
<li>hosts_elasticsearch_log</li>
<li>hosts_consul_server</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>8 Go</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>TOTAL GLOBAL ENV</td>
<td>vitam</td>
<td>28</td>
<td>88</td>
<td>168</td>
</tr>
</tbody>
</table>
<p>Comme précisé précédemment, ce dimensionnement ne contient qu’une seule offre de stockage ; il devra être complété de préférence par un deuxième site (avec le même dimensionnement), ou bien par une offre de stockage supplémentaire sur le site principal (en doublant les ressources allouées à la zone storage).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Le composant <code class="docutils literal notranslate"><span class="pre">batch-report</span></code> est multi-instanciable et peut donc être colocalisé avec les composants mono-instanciables suivants : <code class="docutils literal notranslate"><span class="pre">workspace</span></code> et <code class="docutils literal notranslate"><span class="pre">processing</span></code>. L’alternative est de colocaliser avec la zone applicative comprenant <code class="docutils literal notranslate"><span class="pre">logbook</span></code>, <code class="docutils literal notranslate"><span class="pre">security-internal</span></code>, <code class="docutils literal notranslate"><span class="pre">metadata</span></code> et <code class="docutils literal notranslate"><span class="pre">storage-engine</span></code>.</p>
</div>
</div>
<div class="section" id="xlarge-production-pour-fortes-volumetries">
<h3>5.13.1.5. «&nbsp;xlarge&nbsp;» : production pour fortes volumétries<a class="headerlink" href="#xlarge-production-pour-fortes-volumetries" title="Lien permanent vers ce titre">¶</a></h3>
<p>Adapté à un déploiement pour de fortes volumétries (ordre de grandeur des capacités d’ingest : &gt; 50 To / an, &gt; 100.10^6 objets / an). Ce déploiement implique la multi-instanciation de tous les composants le supportant et l’usage d’un stockage objet Swift ou S3.</p>
<table border="1" class="docutils" id="id5">
<caption><span class="caption-text">Dimensionnement XLarge</span><a class="headerlink" href="#id5" title="Lien permanent vers ce tableau">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Zone</th>
<th class="head">Composants</th>
<th class="head"># instances</th>
<th class="head">vCPU / instance</th>
<th class="head">RAM / instance</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>zone_access</td>
<td><ul class="first last simple">
<li>hosts_ihm_demo</li>
</ul>
</td>
<td>1</td>
<td>2</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone_external</td>
<td><ul class="first last simple">
<li>hosts_ingest_external</li>
<li>hosts_access_external</li>
</ul>
</td>
<td>2</td>
<td>2</td>
<td>4 Go</td>
</tr>
<tr class="row-even"><td>zone_applicative</td>
<td><ul class="first last simple">
<li>hosts_ingest_internal</li>
<li>hosts_access_internal</li>
</ul>
</td>
<td>2</td>
<td>2</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone_applicative</td>
<td><ul class="first last simple">
<li>hosts_logbook</li>
<li>hosts_security_internal</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-even"><td>zone_applicative</td>
<td><ul class="first last simple">
<li>hosts_metadata</li>
<li>hosts_functional_administration</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone_applicative</td>
<td><ul class="first last simple">
<li>hosts_processing</li>
</ul>
</td>
<td>1</td>
<td>2</td>
<td>4 Go</td>
</tr>
<tr class="row-even"><td>zone_applicative</td>
<td><ul class="first last simple">
<li>hosts_worker</li>
</ul>
</td>
<td>10</td>
<td>4</td>
<td>6 Go</td>
</tr>
<tr class="row-odd"><td>zone_applicative</td>
<td><ul class="first last simple">
<li>hosts_workspace</li>
</ul>
</td>
<td>1</td>
<td>8</td>
<td>8 Go</td>
</tr>
<tr class="row-even"><td>zone_applicative</td>
<td><ul class="first last simple">
<li>hosts_batch_report</li>
</ul>
</td>
<td>2</td>
<td>8</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone_applicative</td>
<td><ul class="first last simple">
<li>hosts_scheduler</li>
</ul>
</td>
<td>2</td>
<td>8</td>
<td>4 Go</td>
</tr>
<tr class="row-even"><td>zone_applicative</td>
<td><ul class="first last simple">
<li>hosts_storage_engine</li>
</ul>
</td>
<td>4</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone_storage</td>
<td><ul class="first last simple">
<li>hosts_storage_offer_default (swift/s3)</li>
</ul>
</td>
<td>2</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-even"><td>zone_storage</td>
<td><ul class="first last simple">
<li>hosts_mongoc_offer</li>
<li>hosts_mongos_offer</li>
</ul>
</td>
<td>3</td>
<td>2</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone_storage</td>
<td><ul class="first last simple">
<li>hosts_mongod_offer</li>
</ul>
</td>
<td>3</td>
<td>2</td>
<td>4 Go</td>
</tr>
<tr class="row-even"><td>zone_data</td>
<td><ul class="first last simple">
<li>hosts_elasticsearch_data</li>
</ul>
</td>
<td>6</td>
<td>6</td>
<td>12 Go</td>
</tr>
<tr class="row-odd"><td>zone_data</td>
<td><ul class="first last simple">
<li>hosts_mongoc_data</li>
<li>hosts_mongos_data</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>8 Go</td>
</tr>
<tr class="row-even"><td>zone_data</td>
<td><ul class="first last simple">
<li>hosts_mongod_data</li>
</ul>
</td>
<td>6</td>
<td>6</td>
<td>24 Go</td>
</tr>
<tr class="row-odd"><td>zone_admin</td>
<td><ul class="first last simple">
<li>hosts_logstash</li>
<li>hosts_kibana_log (x1 uniquement)</li>
<li>hosts_cerebro (x1 uniquement)</li>
<li>hosts_kibana_data (x1 uniquement)</li>
</ul>
</td>
<td>2</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-even"><td>zone_admin</td>
<td><ul class="first last simple">
<li>hosts_elasticsearch_log</li>
<li>hosts_consul_server</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>8 Go</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>TOTAL GLOBAL ENV</td>
<td>vitam</td>
<td>57</td>
<td>236</td>
<td>448</td>
</tr>
</tbody>
</table>
<p>Comme précisé précédemment, ce dimensionnement ne contient qu’une seule offre de stockage ; il devra être complété de préférence par un deuxième site (avec le même dimensionnement), ou bien par une offre de stockage supplémentaire sur le site principal (en doublant les ressources allouées à la zone storage).</p>
</div>
</div>
<div class="section" id="stockage">
<h2>5.13.2. Stockage<a class="headerlink" href="#stockage" title="Lien permanent vers ce titre">¶</a></h2>
<p>Plus que tout autre, le calcul du dimensionnement du stockage dépend étroitement de la nature des archives qui doivent être conservées dans la solution logicielle.</p>
<p>Les drivers principaux de dimensionnement des différents emplacements de stockage sont les suivants :</p>
<ul>
<li><p class="first">Répertoire «&nbsp;tmp&nbsp;» du composant <code class="docutils literal notranslate"><span class="pre">ingest-external</span></code> : ce répertoire doit pouvoir stocker les <a class="reference internal" href="../introduction.html#term-sip"><span class="xref std std-term">SIP</span></a> en cours d’analyse antivirus avant leur dépôt dans workspace ; sa taille dépend donc de la taille maximale des <a class="reference internal" href="../introduction.html#term-sip"><span class="xref std std-term">SIP</span></a> présents en entrée et du nombre d’ingest initiés en parallèle.</p>
</li>
<li><p class="first">Répertoire «&nbsp;data&nbsp;» du composant <code class="docutils literal notranslate"><span class="pre">workspace</span></code> : ce répertoire doit pouvoir stocker les données en cours de traitement (contenu décompressé des <a class="reference internal" href="../introduction.html#term-sip"><span class="xref std std-term">SIP</span></a> en cours d’ingest, des objets binaires en cours de préservation, ainsi que les exports de données <a class="reference internal" href="../introduction.html#term-dip"><span class="xref std std-term">DIP</span></a> en cours…) ; sa taille dépend donc de la taille maximale des <a class="reference internal" href="../introduction.html#term-sip"><span class="xref std std-term">SIP</span></a> présents en entrée et du nombre d’ingest et de préservation simultanés (en attente ou en cours de traitement) ainsi que du volume et de la durée de rétention des <a class="reference internal" href="../introduction.html#term-dip"><span class="xref std std-term">DIP</span></a> (par défault 7 jours, paramétrables dans la configuration du module <code class="docutils literal notranslate"><span class="pre">metadata</span></code>).</p>
</li>
<li><p class="first">Répertoire «&nbsp;tmp&nbsp;» du composant <code class="docutils literal notranslate"><span class="pre">worker</span></code> : ce répertoire doit pouvoir stocker les objets binaires en cours de traitement par le worker ; il s’agit généralement du produit <code class="docutils literal notranslate"><span class="pre">&quot;capacité</span> <span class="pre">du</span> <span class="pre">worker&quot;</span> <span class="pre">x</span> <span class="pre">&quot;taille</span> <span class="pre">maximale</span> <span class="pre">d'un</span> <span class="pre">objet</span> <span class="pre">binaire&quot;</span></code>.</p>
</li>
<li><p class="first">Répertoire «&nbsp;data&nbsp;» du composant <code class="docutils literal notranslate"><span class="pre">elasticsearch-data</span></code> : ce cluster stocke les métadonnées associées aux archives (<a class="reference internal" href="../introduction.html#term-got"><span class="xref std std-term">GOT</span></a> et <a class="reference internal" href="../introduction.html#term-au"><span class="xref std std-term">AU</span></a>) ainsi que les journaux d’opération. Pour ces éléments :</p>
<ul class="simple">
<li>La taille et la quantité des <a class="reference internal" href="../introduction.html#term-au"><span class="xref std std-term">AU</span></a> et des <a class="reference internal" href="../introduction.html#term-got"><span class="xref std std-term">GOT</span></a> dépend des données entrées dans <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> (facteur métier) ;</li>
<li>Le nombre d’opérations dépend de l’usage du système (et notamment de la granularité des <a class="reference internal" href="../introduction.html#term-sip"><span class="xref std std-term">SIP</span></a> en entrée). En ordre de grandeur, le journal d’une opération d’ingest a une taille brute de 50 Ko ; le journal d’une opération d’update, 5 Ko (d’après des mesures effectuées sur des environnements de tests de la solution logicielle) ;</li>
<li>Au niveau global du cluster, le rapport entre la donnée brute (entrée dans elasticsearch) et la donnée persistée est le produit <code class="docutils literal notranslate"><span class="pre">&quot;facteur</span> <span class="pre">de</span> <span class="pre">réplication&quot;</span> <span class="pre">x</span> <span class="pre">2</span></code> (le facteur 2 provient du champ <code class="docutils literal notranslate"><span class="pre">_source</span></code> qui contient le document original conservé par elasticsearch à côté des index) ;</li>
<li>La taille unitaire d’un répertoire «&nbsp;data&nbsp;» sur une instance se calcule ensuite en fonction du nombre de noeuds disponibles dans le cluster (l’hypothèse d’une répartition uniforme peut être retenue).</li>
</ul>
</li>
<li><p class="first">Répertoire «&nbsp;data&nbsp;» du composant <code class="docutils literal notranslate"><span class="pre">mongod-data</span></code> : ce cluster stocke les métadonnées associées aux archives (<a class="reference internal" href="../introduction.html#term-got"><span class="xref std std-term">GOT</span></a>, <a class="reference internal" href="../introduction.html#term-au"><span class="xref std std-term">AU</span></a> et <a class="reference internal" href="../introduction.html#term-lfc"><span class="xref std std-term">LFC</span></a> associé) ainsi que les journaux d’opération. Pour ces éléments :</p>
<ul class="simple">
<li>La taille et la quantité des AU et des GOT dépend du métier ;</li>
<li>Les <a class="reference internal" href="../introduction.html#term-lfc"><span class="xref std std-term">LFC</span></a> associés à une <a class="reference internal" href="../introduction.html#term-au"><span class="xref std std-term">AU</span></a> sont estimés à un peu moins de 5 Ko (d’après des mesures effectuées sur des environnements de tests de la solution logicielle) ;</li>
<li>Le nombre d’opérations dépend de l’usage du système (et notamment de la granularité des <a class="reference internal" href="../introduction.html#term-sip"><span class="xref std std-term">SIP</span></a> en entrée). En ordre de grandeur, le journal d’une opération d’ingest a une taille moyenne brute de 50 Ko ; le journal d’une opération d’update ou audit, 5 Ko (d’après des mesures effectuées sur des environnements de tests de la solution logicielle) ;</li>
<li>Au niveau global du cluster, le rapport entre la donnée brute (entrée dans MongoDB) et la donnée persistée est le produit <code class="docutils literal notranslate"><span class="pre">&quot;facteur</span> <span class="pre">de</span> <span class="pre">réplication&quot;</span> <span class="pre">x</span> <span class="pre">&quot;facteur</span> <span class="pre">d'expansion&quot;</span></code>. Le facteur d’expansion dépend de la base de données impactée, et il est fonction du taux d’indexation et de sa capacité de compression.  D’après des mesures effectuées sur des environnements de tests de la solution logicielle, ce facteur prend les valeurs suivantes :<ul>
<li>1,2 pour la base de données des métadonnées d’archive (<a class="reference internal" href="../introduction.html#term-au"><span class="xref std std-term">AU</span></a> &amp; <a class="reference internal" href="../introduction.html#term-got"><span class="xref std std-term">GOT</span></a>)</li>
<li>0,4 pour les journaux d’opération</li>
</ul>
</li>
<li>La taille unitaire d’un répertoire «&nbsp;data&nbsp;» sur une instance se calcule ensuite en fonction du nombre de noeuds disponibles dans le cluster (l’hypothèse d’une répartition uniforme peut être retenue, MongoDB opérant un rééquilibrage progressif des shards).</li>
</ul>
</li>
<li><p class="first">Répertoire «&nbsp;log&nbsp;» du composant storage : chaque écriture vers le stockage implique la création d’une entrée dans le journal des écritures du composant storage. Ainsi :</p>
<ul class="simple">
<li>La taille de ce répertoire dépend du nombre d’éléments écrits, et notamment : <a class="reference internal" href="../introduction.html#term-au"><span class="xref std std-term">AU</span></a>, <a class="reference internal" href="../introduction.html#term-got"><span class="xref std std-term">GOT</span></a>, <a class="reference internal" href="../introduction.html#term-bdo"><span class="xref std std-term">BDO</span></a>, journaux d’opérations ;</li>
<li>Pour les journaux d’opération : chaque journal implique au moins deux écritures à cause de sa sécurisation ;</li>
<li>Chaque entrée du journal des écritures a une taille moyenne de 500 octets (d’après des mesures effectuées sur des environnements de tests de la solution logicielle).</li>
</ul>
</li>
<li><p class="first">Espace de stockage du composant <code class="docutils literal notranslate"><span class="pre">storage-offer</span></code> pour le stockage pérenne des données conservées dans <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a>, qui comprend notamment :</p>
<ul class="simple">
<li>les <a class="reference internal" href="../introduction.html#term-au"><span class="xref std std-term">AU</span></a>, <a class="reference internal" href="../introduction.html#term-got"><span class="xref std std-term">GOT</span></a> et <a class="reference internal" href="../introduction.html#term-bdo"><span class="xref std std-term">BDO</span></a> ;</li>
<li>les journaux d’opération, de cycle de vie, d’écritures et d’accès ;</li>
<li>les autres données techniques persistées par Vitam (sécurisations des journaux, ATRs, rapports d’opérations…)</li>
</ul>
<p>Cette capacité doit être allouée selon le type de l’offre de cible :</p>
<ul class="simple">
<li>Système de fichiers : Répertoire «&nbsp;data&nbsp;» du composant <code class="docutils literal notranslate"><span class="pre">storage-offer</span></code> ;</li>
<li>Object store S3 ou Swift : Capacité de stockage dans l’object store «&nbsp;S3&nbsp;» ou «&nbsp;Swift&nbsp;» cible ;</li>
<li>Archivage sur bandes magnétiques : Capacité de stockage sur bibliothèque de bandes</li>
</ul>
</li>
<li><p class="first">Répertoire «&nbsp;tmp&nbsp;» du composant <code class="docutils literal notranslate"><span class="pre">storage-offer</span></code> : ce répertoire doit pouvoir stocker les rapports liés à l’audit comparatif des offres ; sa taille dépends du nombre de fichiers présents dans les conteneurs à comparer. Pour un conteneur contenant plus de 1 million de fichiers, prévoir environs 300 Mo d’espace disque.</p>
</li>
<li><p class="first">Répertoire «&nbsp;data&nbsp;» du composant <code class="docutils literal notranslate"><span class="pre">mongod-offer</span></code> : chaque écriture dans une offre de stockage implique la journalisation de cette écriture dans l’archivelog d’écriture. Le nombre d’entrées est le nombre de données écrites via storage (cf. point précédent) ; la taille unitaire d’une entrée dans ce log est 260 octets (d’après des mesures effectuées sur des environnements de tests de la solution logicielle).</p>
</li>
<li><p class="first">Répertoire «&nbsp;data&nbsp;» du composant <code class="docutils literal notranslate"><span class="pre">elasticsearch-log</span></code> : ce <em>cluster</em> stocke les logs techniques issus de l’application. Il est assez difficile de donner un dimensionnement analytique réaliste de ce composant (trop d’éléments entrant en jeu). Pour donner un ordre de grandeur purement indicatif, pour un système en ingest pur (i.e. sans accès), il a été observé une moyenne de 20 Ko de log brut par triplet (<a class="reference internal" href="../introduction.html#term-au"><span class="xref std std-term">AU</span></a>, <a class="reference internal" href="../introduction.html#term-got"><span class="xref std std-term">GOT</span></a>, <a class="reference internal" href="../introduction.html#term-bdo"><span class="xref std std-term">BDO</span></a>) entré dans le système.</p>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Pour le stockage sur bandes magnétiques (offre froide), il est à noter que :</p>
<ul class="last">
<li><p class="first">L’offre froide de Vitam ne supporte actuellement PAS l’élimination physique des données (seule une élimination logique est réalisée). De ce fait, la capacité de stockage allouée sur bandes &amp; cache disque doit contenir <strong>toutes les versions des données écrites</strong> (écritures + MAJ), et sur la <strong>totalité de la durée de vie</strong> de la solution déployée.</p>
</li>
<li><p class="first">En plus du stockage sur bande, le répertoire «&nbsp;data&nbsp;» du composant <code class="docutils literal notranslate"><span class="pre">storage-offer</span></code> est également utilisé :</p>
<ul class="simple">
<li>Comme espace «&nbsp;tampon&nbsp;» pour le stockage temporaire des objets à archiver. Il doit disposer de suffisamment d’espace pour contenir les données en cours d’archivage à l’instant T, le temps qu’elles soient écrites sur bande sur bande.</li>
<li>Comme espace «&nbsp;cache&nbsp;» pour le stockage des données à lire. Il doit disposer suffisamment d’espace pour contenir sur la <strong>durée de vie</strong> de la solution déployée :<ul>
<li>l’ensemble des métadonnées et leur journaux de cycle de vie (environs 10 Ko par <a class="reference internal" href="../introduction.html#term-au"><span class="xref std std-term">AU</span></a> ou <a class="reference internal" href="../introduction.html#term-got"><span class="xref std std-term">GOT</span></a>, pour chaque version écrite)</li>
<li>l’ensemble des données techniques (journaux de sécurisation, ATRs, rapports…)</li>
<li>suffisamment d’espace pour la mise à disposition des binaires en cours de lecture (binaires en cours d’export de données DIP ou de transfert, en cours de préservation…)</li>
</ul>
</li>
</ul>
<p>Pour une plateforme large de production, prévoir <em>à minima</em> 10 To de stockage disque pour le répertoire «&nbsp;data&nbsp;» du composant <code class="docutils literal notranslate"><span class="pre">storage-offer</span></code>.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="reseau-inter-site">
<h2>5.13.3. Réseau : inter-site<a class="headerlink" href="#reseau-inter-site" title="Lien permanent vers ce titre">¶</a></h2>
<p>Un lien réseau <a class="reference internal" href="../introduction.html#term-ip"><span class="xref std std-term">IP</span></a> doit exister entre les deux sites et respecter les flux décrits dans la matrice de flux externes (se reporter à <a class="reference internal" href="90-flux-all.html"><span class="doc">Matrice des flux</span></a>).</p>
<p>Le routage niveau 3 est permis sur ce lien, par translation d’adresse, mais pas par translation de port (i.e. chaque serveur devant être exposé sur le site 2 au site 1 peut exposer une adresse <a class="reference internal" href="../introduction.html#term-ip"><span class="xref std std-term">IP</span></a> <a class="reference internal" href="../introduction.html#term-wan"><span class="xref std std-term">WAN</span></a> visible depuis le site 1 différente de son adresse <a class="reference internal" href="../introduction.html#term-ip"><span class="xref std std-term">IP</span></a> <a class="reference internal" href="../introduction.html#term-lan"><span class="xref std std-term">LAN</span></a> locale).</p>
<p>Concernant ce lien intersite, les éléments permettant son dimensionnement sont les suivants :</p>
<ul class="simple">
<li>La latence est peu critique (elle joue principalement sur la performance des batchs, et pas des accès utilisateurs ; l’optimisation des performances se fera dans ce cas par l’augmentation des pools de threads de storage et l’augmentation de la capacité des workers) ;</li>
<li>Par contre, un débit adapté est requis ; dans cette version de <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a>, ce dernier peut se calculer à partir de la somme des débits d’ingest des <a class="reference internal" href="../introduction.html#term-au"><span class="xref std std-term">AU</span></a> + <a class="reference internal" href="../introduction.html#term-got"><span class="xref std std-term">GOT</span></a> + <a class="reference internal" href="../introduction.html#term-bdo"><span class="xref std std-term">BDO</span></a> + journaux.</li>
</ul>
</div>
<div class="section" id="scalabilite">
<h2>5.13.4. Scalabilité<a class="headerlink" href="#scalabilite" title="Lien permanent vers ce titre">¶</a></h2>
<p>De manière générale, la consommation en ressources (CPU/RAM/réseau/stockage) de <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> dépend de 3 grands cas d’utilisation :</p>
<ul class="simple">
<li>La quantité d’archives versées (<em>ingest</em>) : supporter plus d’ingest nécessite de renforcer les ressources disponibles pour les composants actifs lors d’un ingest : ingest-external, ingest-internal, processing, worker, workspace, logbook, metadata, storage, storage-offer, elasticsearch-data, mongodb ;</li>
<li>La quantité d’archives gérées (audit &amp; pérennisation) : dans cette version de <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a>, les fonctions liées à ces deux domaines sont limitées ; par conséquent, la quantité de données gérées a uniquement une influence sur les dépôts de données : storage, storage-offer, elasticsearch-data, mongodb ;</li>
<li>La quantité d’archives consultées (<em>access</em>) : supporter plus de requêtes concurrentes nécessite de renforcer les ressources disponibles pour les composants actifs lors d’une consultation : access-external, access-internal, logbook, metadata, storage, storage-offer, elasticsearch-data, mongodb.</li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="20-deployment-guidelines.html" class="btn btn-neutral float-left" title="5.12. Guidelines de déploiement" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="90-flux-all.html" class="btn btn-neutral float-right" title="5.14. Matrice des flux" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Ce document est distribué sous les termes de la Licence Ouverte V2.0.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
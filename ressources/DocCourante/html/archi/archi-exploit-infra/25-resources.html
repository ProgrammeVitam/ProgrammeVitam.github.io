

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5.13. Eléments de dimensionnement &mdash; documentation VITAM - Architecture 1.0.0</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Recherche" href="../search.html"/>
    <link rel="top" title="documentation VITAM - Architecture 1.0.0" href="../index.html"/>
        <link rel="up" title="5. Architecture technique / exploitation" href="_toc.html"/>
        <link rel="next" title="5.14. Matrice des flux" href="90-flux-all.html"/>
        <link rel="prev" title="5.12. Guidelines de déploiement" href="20-deployment-guidelines.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> VITAM - Architecture
          

          
            
            <img src="../_static/logo_vitam.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html#rappels">2. Rappels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/_toc.html">3. Vue d&#8217;ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="../archi-applicative/_toc.html">4. Architecture applicative</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="_toc.html">5. Architecture technique / exploitation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="principes/_toc.html">5.1. Principes d&#8217;architecture technique</a></li>
<li class="toctree-l2"><a class="reference internal" href="01-services-techniques.html">5.2. Services techniques fournis par la solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="02-dependencies.html">5.3. Composants logiciels utilisés</a></li>
<li class="toctree-l2"><a class="reference internal" href="03-technical-architecture.html">5.4. Architecture technique détaillée</a></li>
<li class="toctree-l2"><a class="reference internal" href="04-data-storage.html">5.5. Stockage des données</a></li>
<li class="toctree-l2"><a class="reference internal" href="05-logs-architecture.html">5.6. Concentration et exploitation des logs applicatifs</a></li>
<li class="toctree-l2"><a class="reference internal" href="06-metrics-architecture.html">5.7. Métriques applicatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="07-deployment-tooling.html">5.8. Outillage de déploiement</a></li>
<li class="toctree-l2"><a class="reference internal" href="08-consul.html">5.9. Service registry</a></li>
<li class="toctree-l2"><a class="reference internal" href="10-it-services.html">5.10. Dépendances aux services d&#8217;infrastructures</a></li>
<li class="toctree-l2"><a class="reference internal" href="15-services.html">5.11. Composants déployés</a></li>
<li class="toctree-l2"><a class="reference internal" href="20-deployment-guidelines.html">5.12. Guidelines de déploiement</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.13. Eléments de dimensionnement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#compute">5.13.1. Compute</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#xsmall-developpement-local">5.13.1.1. &#8220;xsmall&#8221; : développement local</a></li>
<li class="toctree-l4"><a class="reference internal" href="#small-recette-simple-metier">5.13.1.2. &#8220;small&#8221; : recette simple métier</a></li>
<li class="toctree-l4"><a class="reference internal" href="#medium-production-pour-volumetries-moyennes">5.13.1.3. &#8220;medium&#8221; : production pour volumétries moyennes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#large-production-pour-volumetries-moyennes-avec-besoin-de-resilience">5.13.1.4. &#8220;large&#8221; :  production pour volumétries moyennes avec besoin de résilience</a></li>
<li class="toctree-l4"><a class="reference internal" href="#xlarge-production-pour-fortes-volumetries">5.13.1.5. &#8220;xlarge&#8221; : production pour fortes volumétries</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#stockage">5.13.2. Stockage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reseau-inter-site">5.13.3. Réseau : inter-site</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scalabilite">5.13.4. Scalabilité</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="90-flux-all.html">5.14. Matrice des flux</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../securite/_toc.html">6. Securite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../include/_toc.html">7. Architecture détaillée</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">VITAM - Architecture</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="_toc.html">5. Architecture technique / exploitation</a> &raquo;</li>
      
    <li>5.13. Eléments de dimensionnement</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/archi-exploit-infra/25-resources.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="elements-de-dimensionnement">
<h1>5.13. Eléments de dimensionnement<a class="headerlink" href="#elements-de-dimensionnement" title="Lien permanent vers ce titre">¶</a></h1>
<div class="admonition caution">
<p class="first admonition-title">Prudence</p>
<p class="last">Les abaques de dimensionnement sont étroitement liés à la nature de l&#8217;infrastructure sous-jacente et à l&#8217;usage qui est fait du système VITAM. Par conséquent, les indications de volumétrie qui sont présentées dans la suite de ce document sont purement indicatives et relatives au système VITAM dans sa version actuelle, installé sur les environnements de tests de la solution logicielle (qui sont opérés en environnement complètement virtualisé).</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Sauf mention contraire, les enveloppes de resources ci-dessous comprennent notamment les composants associés à l&#8217;exploitation de la solution VITAM et fournis dans le cadre de la solution (traitement et stockage des logs et des métriques, gestion des bases de données, ...)</p>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p>Les configurations de référence ci-dessous sont données pour un seul site primaire comportant une seule offre de stockage. VITAM préconise très fortement un déploiement comportant a minima 2 offres de stockage. En fonction des contraintes de disponibilité du système, il sera donc nécessaire :</p>
<ul class="last simple">
<li>Soit d&#8217;ajouter une autre offre de stockage (i.e. les composants storage-offer et mongo*-offer) dans le cas d&#8217;un déploiement mono-site ;</li>
<li>Soit d&#8217;ajouter un site secondaire comportant sa propre offre de stockage.</li>
</ul>
</div>
<div class="section" id="compute">
<h2>5.13.1. Compute<a class="headerlink" href="#compute" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="xsmall-developpement-local">
<h3>5.13.1.1. &#8220;xsmall&#8221; : développement local<a class="headerlink" href="#xsmall-developpement-local" title="Lien permanent vers ce titre">¶</a></h3>
<p>Adapté à un poste de développement ; ce déploiement ne comprend pas les composants d&#8217;exploitation de la solution VITAM. La chaîne de traitement de logs n&#8217;est pas déployée, et le même cluster mongodb est utilisé pour l&#8217;offre de stockage et les métadonnées.</p>
<p>Ce déploiement n&#8217;est pas adapté pour un fonctionnement en production.</p>
<table border="1" class="docutils" id="id1">
<caption><span class="caption-text">Dimensionnement XSmall</span><a class="headerlink" href="#id1" title="Lien permanent vers ce tableau">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Zone</th>
<th class="head">Composants</th>
<th class="head"># instances</th>
<th class="head">vCPU / instance</th>
<th class="head">RAM / instance</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ul class="first last simple">
<li>zone-access</li>
<li>zone-external</li>
<li>zone-applicative</li>
<li>zone-data</li>
<li>zone-storage</li>
<li>zone-admin</li>
</ul>
</td>
<td><ul class="first last simple">
<li>hosts-ihm-demo</li>
<li>hosts-ihm-recette</li>
<li>hosts-cerebro</li>
<li>hosts-ingest-external</li>
<li>hosts-access-external</li>
<li>hosts-ingest-internal</li>
<li>hosts-access-internal</li>
<li>hosts-storage-engine</li>
<li>hosts-workspace</li>
<li>hosts-processing</li>
<li>hosts-worker</li>
<li>hosts-functional-administration</li>
<li>hosts-logbook</li>
<li>hosts-security-internal</li>
<li>hosts-metadata</li>
<li>hosts-mongoc-data</li>
<li>hosts-mongos-data</li>
<li>hosts-mongod-data</li>
<li>hosts-elasticsearch-data</li>
<li>hosts-storage-offer-default (file)</li>
<li>hosts-consul-server</li>
</ul>
</td>
<td>1</td>
<td>4</td>
<td>16 Go</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>TOTAL</td>
<td>vitam</td>
<td>1</td>
<td>4</td>
<td>16 Go</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="small-recette-simple-metier">
<h3>5.13.1.2. &#8220;small&#8221; : recette simple métier<a class="headerlink" href="#small-recette-simple-metier" title="Lien permanent vers ce titre">¶</a></h3>
<p>Adapté à un environnement de recette simple d&#8217;application métier utilisant VITAM.</p>
<p>Ce déploiement n&#8217;est pas adapté pour un fonctionnement en production.</p>
<table border="1" class="docutils" id="id2">
<caption><span class="caption-text">Dimensionnement Small</span><a class="headerlink" href="#id2" title="Lien permanent vers ce tableau">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Zone</th>
<th class="head">Composants</th>
<th class="head"># instances</th>
<th class="head">vCPU / instance</th>
<th class="head">RAM / instance</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ul class="first last simple">
<li>zone-external</li>
<li>zone-applicative</li>
</ul>
</td>
<td><ul class="first last simple">
<li>hosts-ingest-external</li>
<li>hosts-access-external</li>
<li>hosts-ingest-internal</li>
<li>hosts-access-internal</li>
<li>hosts-storage-engine</li>
<li>hosts-workspace</li>
<li>hosts-processing</li>
<li>hosts-worker</li>
</ul>
</td>
<td>1</td>
<td>6</td>
<td>12 Go</td>
</tr>
<tr class="row-odd"><td><ul class="first last simple">
<li>zone-access</li>
<li>zone-applicative</li>
<li>zone-data</li>
</ul>
</td>
<td><ul class="first last simple">
<li>hosts-ihm-demo</li>
<li>hosts-ihm-recette</li>
<li>hosts-cerebro</li>
<li>hosts-functional-administration</li>
<li>hosts-logbook</li>
<li>hosts-security-internal</li>
<li>hosts-metadata</li>
<li>hosts-mongoc-data</li>
<li>hosts-mongos-data</li>
<li>hosts-mongod-data</li>
<li>hosts-elasticsearch-data</li>
</ul>
</td>
<td>1</td>
<td>6</td>
<td>12 Go</td>
</tr>
<tr class="row-even"><td><ul class="first last simple">
<li>zone-storage</li>
<li>zone-admin</li>
</ul>
</td>
<td><ul class="first last simple">
<li>hosts-storage-offer-default (file)</li>
<li>hosts-mongoc-offer</li>
<li>hosts-mongos-offer</li>
<li>hosts-mongod-offer</li>
<li>hosts-elasticsearch-log</li>
<li>hosts-consul-server</li>
<li>hosts-logstash</li>
<li>hosts-kibana-log</li>
</ul>
</td>
<td>1</td>
<td>6</td>
<td>12 Go</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>TOTAL</td>
<td>vitam</td>
<td>3</td>
<td>18</td>
<td>36</td>
</tr>
</tbody>
</table>
<p>S&#8217;agissant d&#8217;un environnement de recette, l&#8217;utilisation de 2 offres de stockages ou de 2 sites est possible, mais non préconisée (il s&#8217;agit d&#8217;un environnement de recette métier, et non technique).</p>
</div>
<div class="section" id="medium-production-pour-volumetries-moyennes">
<h3>5.13.1.3. &#8220;medium&#8221; : production pour volumétries moyennes<a class="headerlink" href="#medium-production-pour-volumetries-moyennes" title="Lien permanent vers ce titre">¶</a></h3>
<p>Adapté à un déploiement simple pour des volumétries moyennes (quelques To / an) ; seuls le worker et les composants stockant des données sont multi-instanciés (i.e. les bases de données et les offres de stockage). L&#8217;offre de stockage proposée est une offre de stockage &#8220;file&#8221;, plus simple à exploiter et compatible avec une volumétrie moyenne.</p>
<p>Sur les 3 serveurs mongod et mongoc pour l&#8217;offre de stockage, l&#8217;un d&#8217;eux est déployé en tant qu&#8217;arbitre (participe au quorum du replica set, mais ne stocke pas de données).</p>
<table border="1" class="docutils" id="id3">
<caption><span class="caption-text">Dimensionnement Medium</span><a class="headerlink" href="#id3" title="Lien permanent vers ce tableau">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Zone</th>
<th class="head">Composants</th>
<th class="head"># instances</th>
<th class="head">vCPU / instance</th>
<th class="head">RAM / instance</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>zone-access</td>
<td><ul class="first last simple">
<li>hosts-ihm-demo</li>
<li>hosts-cerebro</li>
</ul>
</td>
<td>1</td>
<td>1</td>
<td>2 Go</td>
</tr>
<tr class="row-odd"><td>zone-external</td>
<td><ul class="first last simple">
<li>hosts-ingest-external</li>
<li>hosts-access-external</li>
</ul>
</td>
<td>1</td>
<td>1</td>
<td>2 Go</td>
</tr>
<tr class="row-even"><td>zone-applicative</td>
<td><ul class="first last simple">
<li>hosts-ingest-internal</li>
<li>hosts-access-internal</li>
<li>hosts-functional-administration</li>
<li>hosts-logbook</li>
<li>hosts-security-internal</li>
<li>hosts-metadata</li>
</ul>
</td>
<td>1</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone-applicative</td>
<td><ul class="first last simple">
<li>hosts-storage-engine</li>
<li>hosts-workspace</li>
<li>hosts-processing</li>
</ul>
</td>
<td>1</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-even"><td>zone-applicative</td>
<td><ul class="first last simple">
<li>hosts-worker</li>
</ul>
</td>
<td>2</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone-storage</td>
<td><ul class="first last simple">
<li>hosts-storage-offer-default (file)</li>
<li>hosts-mongoc-offer (arbitre)</li>
<li>hosts-mongod-offer (arbitre)</li>
</ul>
</td>
<td>1</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-even"><td>zone-storage</td>
<td><ul class="first last simple">
<li>hosts-mongoc-offer</li>
<li>hosts-mongos-offer</li>
<li>hosts-mongod-offer</li>
</ul>
</td>
<td>2</td>
<td>2</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone-data</td>
<td><ul class="first last simple">
<li>hosts-mongoc-data</li>
<li>hosts-mongos-data</li>
<li>hosts-mongod-data</li>
<li>hosts-elasticsearch-data</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>8 Go</td>
</tr>
<tr class="row-even"><td>zone-admin</td>
<td><ul class="first last simple">
<li>hosts-elasticsearch-log</li>
<li>hosts-consul-server</li>
<li>hosts-logstash</li>
<li>hosts-kibana-log (x1 uniquement)</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>8 Go</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>TOTAL</td>
<td>vitam</td>
<td>15</td>
<td>50</td>
<td>80</td>
</tr>
</tbody>
</table>
<p>Comme précisé précédemment, ce dimensionnement ne contient qu&#8217;une seule offre de stockage ; il devra être complété de préférence par un deuxième site (avec le même dimensionnement), ou bien par une offre de stockage supplémentaire sur le site principal (en doublant les resources allouées à la zone storage).</p>
</div>
<div class="section" id="large-production-pour-volumetries-moyennes-avec-besoin-de-resilience">
<h3>5.13.1.4. &#8220;large&#8221; :  production pour volumétries moyennes avec besoin de résilience<a class="headerlink" href="#large-production-pour-volumetries-moyennes-avec-besoin-de-resilience" title="Lien permanent vers ce titre">¶</a></h3>
<p>Adapté à un déploiement résilient pour des volumétries plus importantes (10 à 20 To / an) ; ce déploiement comprend au moins deux instances pour tous les composants le supportant, et passe à une offre de stockage de type swift (pour une meilleure scalabilité de l&#8217;offre).</p>
<table border="1" class="docutils" id="id4">
<caption><span class="caption-text">Dimensionnement Large</span><a class="headerlink" href="#id4" title="Lien permanent vers ce tableau">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Zone</th>
<th class="head">Composants</th>
<th class="head"># instances</th>
<th class="head">vCPU / instance</th>
<th class="head">RAM / instance</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>zone-access</td>
<td><ul class="first last simple">
<li>hosts-ihm-demo</li>
<li>hosts-cerebro</li>
</ul>
</td>
<td>1</td>
<td>2</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone-external</td>
<td><ul class="first last simple">
<li>hosts-ingest-external</li>
<li>hosts-access-external</li>
</ul>
</td>
<td>2</td>
<td>1</td>
<td>4 Go</td>
</tr>
<tr class="row-even"><td>zone-applicative</td>
<td><ul class="first last simple">
<li>hosts-ingest-internal</li>
<li>hosts-access-internal</li>
<li>hosts-functional-administration</li>
</ul>
</td>
<td>2</td>
<td>1</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone-applicative</td>
<td><ul class="first last simple">
<li>hosts-logbook</li>
<li>hosts-security-internal</li>
<li>hosts-metadata</li>
<li>hosts-storage-engine</li>
</ul>
</td>
<td>2</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-even"><td>zone-applicative</td>
<td><ul class="first last simple">
<li>hosts-worker</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone-applicative</td>
<td><ul class="first last simple">
<li>hosts-workspace</li>
<li>hosts-processing</li>
</ul>
</td>
<td>1</td>
<td>4</td>
<td>6 Go</td>
</tr>
<tr class="row-even"><td>zone-storage</td>
<td><ul class="first last simple">
<li>hosts-storage-offer-default (swift)</li>
<li>hosts-mongoc-offer</li>
<li>hosts-mongos-offer</li>
<li>hosts-mongod-offer</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>8 Go</td>
</tr>
<tr class="row-odd"><td>zone-data</td>
<td><ul class="first last simple">
<li>hosts-elasticsearch-data</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>6 Go</td>
</tr>
<tr class="row-even"><td>zone-data</td>
<td><ul class="first last simple">
<li>hosts-mongoc-data</li>
<li>hosts-mongos-data</li>
</ul>
</td>
<td>3</td>
<td>2</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone-data</td>
<td><ul class="first last simple">
<li>hosts-mongod-data</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>12 Go</td>
</tr>
<tr class="row-even"><td>zone-admin</td>
<td><ul class="first last simple">
<li>hosts-logstash</li>
<li>hosts-kibana-log</li>
</ul>
</td>
<td>2</td>
<td>2</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone-admin</td>
<td><ul class="first last simple">
<li>hosts-elasticsearch-log</li>
<li>hosts-consul-server</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>8 Go</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>TOTAL</td>
<td>vitam</td>
<td>28</td>
<td>88</td>
<td>168</td>
</tr>
</tbody>
</table>
<p>Comme précisé précédemment, ce dimensionnement ne contient qu&#8217;une seule offre de stockage ; il devra être complété de préférence par un deuxième site (avec le même dimensionnement), ou bien par une offre de stockage supplémentaire sur le site principal (en doublant les resources allouées à la zone storage).</p>
</div>
<div class="section" id="xlarge-production-pour-fortes-volumetries">
<h3>5.13.1.5. &#8220;xlarge&#8221; : production pour fortes volumétries<a class="headerlink" href="#xlarge-production-pour-fortes-volumetries" title="Lien permanent vers ce titre">¶</a></h3>
<p>Adapté à un déploiement pour de fortes volumétries (ordre de grandeur des capacités d&#8217;ingest : &gt; 50 To / an, &gt; 100.10^6 objets / an). Ce déploiement implique la multi-instanciation de tous les composants le supportant et l&#8217;usage d&#8217;un stockage objet Swift.</p>
<table border="1" class="docutils" id="id5">
<caption><span class="caption-text">Dimensionnement XLarge</span><a class="headerlink" href="#id5" title="Lien permanent vers ce tableau">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Zone</th>
<th class="head">Composants</th>
<th class="head"># instances</th>
<th class="head">vCPU / instance</th>
<th class="head">RAM / instance</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>zone-access</td>
<td><ul class="first last simple">
<li>hosts-ihm-demo</li>
<li>hosts-cerebro</li>
</ul>
</td>
<td>1</td>
<td>2</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone-external</td>
<td><ul class="first last simple">
<li>hosts-ingest-external</li>
<li>hosts-access-external</li>
</ul>
</td>
<td>2</td>
<td>2</td>
<td>4 Go</td>
</tr>
<tr class="row-even"><td>zone-applicative</td>
<td><ul class="first last simple">
<li>hosts-ingest-internal</li>
<li>hosts-access-internal</li>
</ul>
</td>
<td>2</td>
<td>2</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone-applicative</td>
<td><ul class="first last simple">
<li>hosts-logbook</li>
<li>hosts-security-internal</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-even"><td>zone-applicative</td>
<td><ul class="first last simple">
<li>hosts-metadata</li>
<li>hosts-functional-administration</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone-applicative</td>
<td><ul class="first last simple">
<li>hosts-processing</li>
</ul>
</td>
<td>1</td>
<td>2</td>
<td>4 Go</td>
</tr>
<tr class="row-even"><td>zone-applicative</td>
<td><ul class="first last simple">
<li>hosts-worker</li>
</ul>
</td>
<td>10</td>
<td>4</td>
<td>6 Go</td>
</tr>
<tr class="row-odd"><td>zone-applicative</td>
<td><ul class="first last simple">
<li>hosts-workspace</li>
</ul>
</td>
<td>1</td>
<td>8</td>
<td>8 Go</td>
</tr>
<tr class="row-even"><td>zone-applicative</td>
<td><ul class="first last simple">
<li>hosts-storage-engine</li>
</ul>
</td>
<td>4</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone-storage</td>
<td><ul class="first last simple">
<li>hosts-storage-offer-default (swift)</li>
</ul>
</td>
<td>2</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-even"><td>zone-storage</td>
<td><ul class="first last simple">
<li>hosts-mongoc-offer</li>
<li>hosts-mongos-offer</li>
</ul>
</td>
<td>3</td>
<td>2</td>
<td>4 Go</td>
</tr>
<tr class="row-odd"><td>zone-storage</td>
<td><ul class="first last simple">
<li>hosts-mongod-offer</li>
</ul>
</td>
<td>3</td>
<td>2</td>
<td>4 Go</td>
</tr>
<tr class="row-even"><td>zone-data</td>
<td><ul class="first last simple">
<li>hosts-elasticsearch-data</li>
</ul>
</td>
<td>6</td>
<td>6</td>
<td>12 Go</td>
</tr>
<tr class="row-odd"><td>zone-data</td>
<td><ul class="first last simple">
<li>hosts-mongoc-data</li>
<li>hosts-mongos-data</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>8 Go</td>
</tr>
<tr class="row-even"><td>zone-data</td>
<td><ul class="first last simple">
<li>hosts-mongod-data</li>
</ul>
</td>
<td>6</td>
<td>6</td>
<td>24 Go</td>
</tr>
<tr class="row-odd"><td>zone-admin</td>
<td><ul class="first last simple">
<li>hosts-logstash</li>
<li>hosts-kibana-log</li>
</ul>
</td>
<td>2</td>
<td>4</td>
<td>4 Go</td>
</tr>
<tr class="row-even"><td>zone-admin</td>
<td><ul class="first last simple">
<li>hosts-elasticsearch-log</li>
<li>hosts-consul-server</li>
</ul>
</td>
<td>3</td>
<td>4</td>
<td>8 Go</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>TOTAL</td>
<td>vitam</td>
<td>58</td>
<td>224</td>
<td>436</td>
</tr>
</tbody>
</table>
<p>Comme précisé précédemment, ce dimensionnement ne contient qu&#8217;une seule offre de stockage ; il devra être complété de préférence par un deuxième site (avec le même dimensionnement), ou bien par une offre de stockage supplémentaire sur le site principal (en doublant les resources allouées à la zone storage).</p>
</div>
</div>
<div class="section" id="stockage">
<h2>5.13.2. Stockage<a class="headerlink" href="#stockage" title="Lien permanent vers ce titre">¶</a></h2>
<p>Plus que tout autre, le calcul du dimensionnement du stockage dépend étroitement de la nature des archives qui doivent être conservées dans la solution logicielle.</p>
<p>Les drivers principaux de dimensionnement des différents emplacements de stockage sont les suivants :</p>
<ul>
<li><p class="first">Répertoire &#8220;tmp&#8221; du composant ingest-external : ce répertoire doit pouvoir stocker les SIP en cours d&#8217;analyse antivirus avant leur dépôt dans workspace ; sa taille dépend donc de la taille maximale des SIP présents en entrée et du nombre d&#8217;ingest initiés en parallèle ;</p>
</li>
<li><p class="first">Répertoire &#8220;data&#8221; du composant workspace : ce répertoire doit pouvoir stocker le contenu décompressé des SIP en cours d&#8217;ingest ; sa taille dépend donc de la taille maximale des SIP présents en entrée et du nombre d&#8217;ingest simultanés (en attente ou en cours de traitement) ;</p>
</li>
<li><p class="first">Répertoire &#8220;tmp&#8221; du composant worker : ce répertoire doit pouvoir stocker les objets binaires en cours de traitement par le worker ; il s&#8217;agit généralement du produit <code class="docutils literal"><span class="pre">&quot;capacité</span> <span class="pre">du</span> <span class="pre">worker&quot;</span> <span class="pre">x</span> <span class="pre">&quot;taille</span> <span class="pre">maximale</span> <span class="pre">d'un</span> <span class="pre">objet</span> <span class="pre">binaire&quot;</span></code></p>
</li>
<li><p class="first">Répertoire &#8220;data&#8221; du composant elasticsearch-data : ce cluster stocke les métadonnées associées aux archives (GOT et AU) ainsi que les journaux d&#8217;opération. Pour ces éléments :</p>
<blockquote>
<div><ul class="simple">
<li>La taille et la quantité des AU et des GOT dépend des données entrées dans VITAM (facteur métier) ;</li>
<li>Le nombre d&#8217;opérations dépend de l&#8217;usage du système (et notamment de la granularité des SIP en entrée). En ordre de grandeur, le journal d&#8217;une opération d&#8217;ingest a une taille brute de 50 Ko ; le journal d&#8217;une opération d&#8217;update, 5 Ko (d&#8217;après des mesures effectuées sur des environnements de tests de la solution logicielle)</li>
<li>Au niveau global du cluster, le rapport entre la donnée brute (entrée dans elasticsearch) et la donnée persistée est le produit <code class="docutils literal"><span class="pre">&quot;facteur</span> <span class="pre">de</span> <span class="pre">réplication&quot;</span> <span class="pre">x</span> <span class="pre">2</span></code> (le facteur 2 provient du champ <code class="docutils literal"><span class="pre">_source</span></code> qui contient le document original conservé par elasticsearch à côté des index)</li>
<li>La taille unitaire d&#8217;un répertoire &#8220;data&#8221; sur une instance se calcule ensuite en fonction du nombre de noeuds disponibles dans le cluster (l&#8217;hypothèse d&#8217;une répartition uniforme peut être retenue)</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Répertoire &#8220;data&#8221; du composant mongod-data : ce cluster stocke les métadonnées associées aux archives (GOT, AU et LFC associé) ainsi que les journaux d&#8217;opération. Pour ces éléments :</p>
<blockquote>
<div><ul>
<li><p class="first">La taille et la quantité des AU et des GOT dépend du métier ;</p>
</li>
<li><p class="first">Les LFC associés à une AU sont estimés à un moins de 5 Ko (d&#8217;après des mesures effectuées sur des environnements de tests de la solution logicielle) ;</p>
</li>
<li><p class="first">Le nombre d&#8217;opérations dépend de l&#8217;usage du système (et notamment de la granularité des SIP en entrée). En ordre de grandeur, le journal d&#8217;une opération d&#8217;ingest a une taille moyenne brute de 50 Ko ; le journal d&#8217;une opération d&#8217;update ou audit, 5 Ko (d&#8217;après des mesures effectuées sur des environnements de tests de la solution logicielle)</p>
</li>
<li><p class="first">Au niveau global du cluster, le rapport entre la donnée brute (entrée dans MongoDB) et la donnée persistée est le produit <code class="docutils literal"><span class="pre">&quot;facteur</span> <span class="pre">de</span> <span class="pre">réplication&quot;</span> <span class="pre">x</span> <span class="pre">&quot;facteur</span> <span class="pre">d'expansion&quot;</span></code>. Le facteur d&#8217;expansion dépend de la base de données impactée, et il est fonction du taux d&#8217;indexation et de sa capacité de compression.  D&#8217;après des mesures effectuées sur des environnements de tests de la solution logicielle, ce facteur prend les valeurs suivantes :</p>
<blockquote>
<div><ul class="simple">
<li>1,2 pour la base de données des métadonnées d&#8217;archive (AU &amp; GOT)</li>
<li>0,4 pour les journaux d&#8217;opération</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">La taille unitaire d&#8217;un répertoire &#8220;data&#8221; sur une instance se calcule ensuite en fonction du nombre de noeuds disponibles dans le cluster (l&#8217;hypothèse d&#8217;une répartition uniforme peut être retenue, MongoDB opérant un rééquilibrage progressif des shards)</p>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Répertoire &#8220;log&#8221; du composant storage : chaque écriture vers le stockage implique la création d&#8217;une entrée dans le journal des écritures du composant storage. Ainsi :</p>
<blockquote>
<div><ul class="simple">
<li>La taille de ce répertoire dépend du nombre d&#8217;éléments écrits, et notamment : AU, GOT, BDO, journaux d&#8217;opérations ;</li>
<li>Pour les journaux d&#8217;opération : chaque journal implique au moins deux écritures à cause de sa sécurisation ;</li>
<li>Chaque entrée du journal des écritures a une taille moyenne de 500 octets (d&#8217;après des mesures effectuées sur des environnements de tests de la solution logicielle)</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Répertoire &#8220;data&#8221; du composant storage-offer (en configuration &#8220;file&#8221;), ou taille de l&#8217;object storage swift utilisé (pour un storage-offer en configuration &#8220;swift&#8221;) : il s&#8217;agit du stockage pérenne des données conservées dans VITAM, qui comprend notamment :</p>
<blockquote>
<div><ul class="simple">
<li>les AU, GOT et BDO ;</li>
<li>les journaux d&#8217;opération ;</li>
<li>les journaux sécurisés</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Répertoire &#8220;data&#8221; du composant mongod-offer : chaque écriture dans une offre de stockage implique la journalisation de cette écriture dans l&#8217;archivelog d&#8217;écriture. Le nombre d&#8217;entrées est le nombre de données écrites via storage (cf. point précédent) ; la taille unitaire d&#8217;une entrée dans ce log est 260 octets (d&#8217;après des mesures effectuées sur des environnements de tests de la solution logicielle)</p>
</li>
<li><p class="first">Répertoire &#8220;data&#8221; du composant elasticsearch-log : ce cluster stocke les logs techniques issus de l&#8217;application. Il est assez difficile de donner un dimensionnement analytique réaliste de ce composant (trop d&#8217;éléments entrant en jeu). Pour donner un ordre de grandeur purement indicatif, pour un système en ingest pur (i.e. sans accès), il a été observé une moyenne de 20 Ko de log brut par triplet (AU, GOT, BDO) entré dans le système.</p>
</li>
</ul>
</div>
<div class="section" id="reseau-inter-site">
<h2>5.13.3. Réseau : inter-site<a class="headerlink" href="#reseau-inter-site" title="Lien permanent vers ce titre">¶</a></h2>
<p>Un lien réseau IP doit exister entre les deux sites et respecter les flux décrits dans la matrice de flux externes (<a class="reference internal" href="90-flux-all.html"><span class="doc">Matrice des flux</span></a>).</p>
<p>Le routage niveau 3 est permis sur ce lien, par translation d&#8217;adresse, mais pas par translation de port (i.e. chaque serveur devant être exposé sur le site 2 au site 1 peut exposer une adresse IP WAN visible depuis le site 1 différente de son adresse IP LAN locale).</p>
<p>Concernant ce lien intersite, les éléments permettant son dimensionnement sont les suivants :</p>
<ul class="simple">
<li>La latence est peu critique (elle joue principalement sur la performance des batchs, et pas des accès utilisateurs ; l&#8217;optimisation des performances se fera dans ce cas par l&#8217;augmentation des pools de threads de storage et l&#8217;augmentation de la capacité des workers)</li>
<li>Par contre, un débit adapté est requis ; dans cette version de VITAM, ce dernier peut se calculer à partir de la somme des débits d&#8217;ingest des AU + GOT + BDO + journaux.</li>
</ul>
</div>
<div class="section" id="scalabilite">
<h2>5.13.4. Scalabilité<a class="headerlink" href="#scalabilite" title="Lien permanent vers ce titre">¶</a></h2>
<p>De manière générale, la consommation en resources (CPU/RAM/réseau/stockage) de VITAM dépend de 3 grands cas d&#8217;utilisation :</p>
<ul class="simple">
<li>La quantité d&#8217;archives versées (ingest) : supporter plus d&#8217;ingest nécessite de renforcer les resources disponibles pour les composants actifs lors d&#8217;un ingest : ingest-external, ingest-internal, processing, worker, workspace, storage, storage-offer, logbook, metadata, elasticsearch-data, mongodb ;</li>
<li>La quantité d&#8217;archives gérées (audit &amp; pérennisation) : dans cette version de VITAM, les fonctions liées à ces deux domaines sont limitées ; par conséquent, la quantité de données gérées a uniquement une influence sur les dépôts de données : elasticsearch-data, mongodb, storage, storage-offer ;</li>
<li>La quantité d&#8217;archives consultées (access) : supporter plus de requêtes concurrentes nécessite de renforcer les resources disponibles pour les composants actifs lors d&#8217;une consultation : access-external, access-internal, metadata, storage, storage-offer, elasticsearch-data, mongodb.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Les composants de référentiels (functional-administration, security-internal), même s&#8217;ils sont utilisés dans la plupart des scénarii métier, bénéficient d&#8217;un fort effet de cache du côté des clients de ces services ; par conséquent, ils sont moins sensibles que les autres à l&#8217;augmentation de capacité.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="90-flux-all.html" class="btn btn-neutral float-right" title="5.14. Matrice des flux" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="20-deployment-guidelines.html" class="btn btn-neutral" title="5.12. Guidelines de déploiement" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Ce document est distribué sous les termes de la Licence Ouverte V2.0.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
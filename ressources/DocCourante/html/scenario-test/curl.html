

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="fr" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="fr" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tests curl &mdash; Documentation VITAM - Scénarios de test 1.10.3</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Recherche" href="search.html" />
    <link rel="prev" title="Guide d’écriture des tests Cucumber" href="guide_cucumber.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> VITAM - Scénarios de test
          

          
            
            <img src="_static/logo_vitam.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.10.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Objectif du document</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests_manuels.html">Tests Manuels</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests_automatises.html">Tests Automatisés</a></li>
<li class="toctree-l1"><a class="reference internal" href="ecriture.html">Ecriture des TNR</a></li>
<li class="toctree-l1"><a class="reference internal" href="guide_cucumber.html">Guide d’écriture des tests Cucumber</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tests curl</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#api-externes">API Externes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ingest">Ingest</a></li>
<li class="toctree-l3"><a class="reference internal" href="#access">Access</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#units">Units</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#administration-fonctionnelle">Administration fonctionnelle</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#api-internes">API Internes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Ingest</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Access</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Administration fonctionnelle</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#notes">Notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#personae">Personae</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">VITAM - Scénarios de test</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Tests curl</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/curl.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tests-curl">
<h1>Tests curl<a class="headerlink" href="#tests-curl" title="Lien permanent vers ce titre">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Lien permanent vers ce titre">¶</a></h2>
<p>cUrl, est l’abréviation de «&nbsp;client URL request library&nbsp;».</p>
<p>C’est un outil en ligne de commande permettant notamment, dans le cas qui nous intéresse, de simuler des requêtes HTTP.</p>
<p>Il permet entre autres d’exécuter toutes les méthodes offertes par le REST : POST, PUT, GET, DELETE, HEAD.</p>
<p>Cette documentation a pour but de fournir une panoplie de jeux de test curl afin de pouvoir tester au maximum les API offertes par VITAM.</p>
<p>Pour toutes ces requêtes, il conviendra d’adapter l’uri en fonction de l’environnement à tester (eg: remplacer {env.programmevitam.fr}).</p>
</div>
<div class="section" id="api-externes">
<h2>API Externes<a class="headerlink" href="#api-externes" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="ingest">
<h3>Ingest<a class="headerlink" href="#ingest" title="Lien permanent vers ce titre">¶</a></h3>
<p><em>Ingest d’un fichier se trouvant dans le dossier baseUploadPath</em>
Le fichier doit se trouver dans le répertoire configuré dans le fichier de configuration (baseUploadPath) puis, exécuter :
<code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-v</span> <span class="pre">-X</span> <span class="pre">POST</span> <span class="pre">-k</span> <span class="pre">--key</span> <span class="pre">vitam-vitam_1.key</span> <span class="pre">--cert</span> <span class="pre">vitam-vitam_1.pem</span> <span class="pre">'{env.programmevitam.fr}/ingest-external/v1/ingests'</span> <span class="pre">-H</span> <span class="pre">'X-Tenant-Id:</span> <span class="pre">0'</span> <span class="pre">-H</span> <span class="pre">'X-Access-Contract-Id:</span> <span class="pre">ContratTNR'</span> <span class="pre">-H</span> <span class="pre">'Content-Type:</span> <span class="pre">application/json;charset=UTF-8'</span> <span class="pre">-H</span> <span class="pre">'Accept:</span> <span class="pre">application/json'</span> <span class="pre">-H</span> <span class="pre">'X-Context-Id:</span> <span class="pre">DEFAULT_WORKFLOW'</span> <span class="pre">-H</span> <span class="pre">'X-ACTION:</span> <span class="pre">RESUME'</span> <span class="pre">--data-binary</span> <span class="pre">'{&quot;path&quot;:</span> <span class="pre">&quot;SIP_OK_2_0.zip&quot;}'</span></code></p>
</div>
<div class="section" id="access">
<h3>Access<a class="headerlink" href="#access" title="Lien permanent vers ce titre">¶</a></h3>
<div class="section" id="units">
<h4>Units<a class="headerlink" href="#units" title="Lien permanent vers ce titre">¶</a></h4>
<p><em>Mise à jour d’une unité archivistique :</em>
<code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-v</span> <span class="pre">-X</span> <span class="pre">PUT</span> <span class="pre">-k</span> <span class="pre">--key</span> <span class="pre">vitam-vitam_1.key</span> <span class="pre">--cert</span> <span class="pre">vitam-vitam_1.pem</span> <span class="pre">'https://{env.programmevitam.fr}/access-external/v1/units/aeaqaaaaaahmtusqabz5oalc4p2zu5aaaaaq'</span> <span class="pre">-H</span> <span class="pre">'X-Tenant-Id:</span> <span class="pre">0'</span> <span class="pre">-H</span> <span class="pre">'X-Access-Contract-Id:</span> <span class="pre">ContratTNR'</span> <span class="pre">-H</span> <span class="pre">'Content-Type:</span> <span class="pre">application/json'</span> <span class="pre">-H</span> <span class="pre">'Accept:</span> <span class="pre">application/json'</span> <span class="pre">--data-binary</span> <span class="pre">'{</span> <span class="pre">&quot;$action&quot;:</span> <span class="pre">[</span> <span class="pre">{</span> <span class="pre">&quot;$set&quot;:</span> <span class="pre">{</span> <span class="pre">&quot;Title&quot;:</span> <span class="pre">&quot;Montparnasse.txt&quot;</span> <span class="pre">}</span> <span class="pre">}</span> <span class="pre">]</span> <span class="pre">}'</span> <span class="pre">--compressed</span></code></p>
</div>
</div>
<div class="section" id="administration-fonctionnelle">
<h3>Administration fonctionnelle<a class="headerlink" href="#administration-fonctionnelle" title="Lien permanent vers ce titre">¶</a></h3>
<p><em>Import d’un référentiel d’agents :</em>
<code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-v</span> <span class="pre">-X</span> <span class="pre">POST</span> <span class="pre">-k</span> <span class="pre">--key</span> <span class="pre">vitam-vitam_1.key</span> <span class="pre">--cert</span> <span class="pre">vitam-vitam_1.pem</span> <span class="pre">'https://{env.programmevitam.fr}/admin-external/v1/agencies'</span> <span class="pre">-H</span> <span class="pre">'X-Tenant-Id:</span> <span class="pre">0'</span> <span class="pre">-H</span> <span class="pre">'X-Access-Contract-Id:</span> <span class="pre">ContratTNR'</span> <span class="pre">-H</span> <span class="pre">'Content-Type:</span> <span class="pre">application/octet-stream;charset=UTF-8'</span> <span class="pre">-H</span> <span class="pre">'Accept:</span> <span class="pre">application/json'</span> <span class="pre">--data-binary</span> <span class="pre">&quot;&#64;agencies.csv&quot;</span> <span class="pre">-H</span> <span class="pre">'Transfer-Encoding:</span> <span class="pre">chunked'</span> <span class="pre">--compressed</span></code></p>
<p>//TODO</p>
</div>
</div>
<div class="section" id="api-internes">
<h2>API Internes<a class="headerlink" href="#api-internes" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="id1">
<h3>Ingest<a class="headerlink" href="#id1" title="Lien permanent vers ce titre">¶</a></h3>
<p>//TODO</p>
</div>
<div class="section" id="id2">
<h3>Access<a class="headerlink" href="#id2" title="Lien permanent vers ce titre">¶</a></h3>
<p>//TODO</p>
</div>
<div class="section" id="id3">
<h3>Administration fonctionnelle<a class="headerlink" href="#id3" title="Lien permanent vers ce titre">¶</a></h3>
<p>//TODO</p>
</div>
</div>
<div class="section" id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="personae">
<h3>Personae<a class="headerlink" href="#personae" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour toutes les requêtes curl de cette documentation, il est possible d’y ajouter un header qui sera pris en compte dans les journaux d’opération : X-Personal-Certificate.
Pour réaliser une telle prouesse, il s’agit simplement d’ajouter ceci à la commande curl ciblée (modifier le certificat en base 64 avec quelque chose de valable dans l’environnement, cf la collection PersonalCertificate) :
<code class="docutils literal notranslate"><span class="pre">-H</span> <span class="pre">'X-Personal-Certificate:MIIFRjCCAy6gAwIBAgIBAjANBgkqhkiG9w0BAQsFADAtMQswCQYDVQQGEwJGUjEOMAwGA1UEBxMFUGFyaXMxDjAMBgNVBAoTBVZJVEFNMCAXDTE3MDgwMTExMTcwMFoYDzk5OTkxMjMxMjM1OTU5WjAtMQswCQYDVQQGEwJGUjEOMAwGA1UEBxMFUGFyaXMxDjAMBgNVBAoTBVZJVEFNMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAmfwb+NP44Ygv94LOOTLhQdDLwwqiwuP3fe3qFs0hCWCEOIorFcJ3cwZ2tc8udFtK8HxLrLxwi7zZweGrwXjt4zfLtfregppt0Xw5RaJtgNReu5i/2AKgtcxscYH/0yG1bDQ3vT2tv0YH4jzdfXfwTVzytqAV1M/CNZlWbcBXqDyZLeYUm5i/Dufndj16j4hw24tBsQT1o92P5qdfPaieZc4jpscGiMmyNYwEKcbqo5wiGVsiD+sU9/JXHT2q1f18JcuwJ5/fqzsADPKXudBvibCSaANf+ZNpRaWZ7y6e/kUDs8yrp4YaXzb331ioOGk4JE9ylv1hY5l8IbbvWracaxJv3xm3EnIp9M2/VMHrrGlkVjmGBUydJDiRhUAgaqXNpezwWulweQunAelBCU4PjO40J6t2wdLi5+f+b0OLJHJg0N9xdFsKrqsAVpjaYpqnDAG2Evcw0GFUuFm10JVLCAVpi6EwgxMnwExaeSrUvNE7Sdu95z2G8yBR9tYvYve+iiq/LzkR3cxK+9Pw4xDIEgQ0ZTCvY/6SBnHdAe3tqs4kODs57BZW4DD9ytpT73BKMf7EeZAE3tJd9p40uw/b41VF9bJvoW1ammZMl4H2OwdJi7+5DAMbBC1X2kMGWRo06IM99q+TKpfrUK+p4b6NfcSdrfr+n28vd8pzp16VDoMCAwEAAaNvMG0wDAYDVR0TAQH/BAIwADAdBgNVHQ4EFgQUx0RltSTqHWXEisK78KQzn2SRpIkwCwYDVR0PBAQDAgSwMBEGCWCGSAGG+EIBAQQEAwIFoDAeBglghkgBhvhCAQ0EERYPeGNhIGNlcnRpZmljYXRlMA0GCSqGSIb3DQEBCwUAA4ICAQAZAZyzj7c5KBDLp0K324jUJB+oJAuf/D0vh0FqKvlCBTOLJsLfO2hsEL8ude5rVhP4goThIz1OjpnxFP+YmHUOtiQup21VGTaeTWn769/x6gRx/1eyJyws4ien/w7gBASLEKI7nGYAkeoYeZKWYTlfBgEisLwSsjcQeBeKcnUnuWJauiALPnBntkAnM7PotASA8Hk+dle9lng1sMlzHVcTVauCuvrk8WCec9ja56+b9N4JbaCwYFmMRlMzdBQU4LXrbqxlakpa2ua0mSzCKe8WHI9m5uCHhUi3fMa7KJsN5nBHkw63nFwGQwyRNQYgZiyhmzXtez/l+8f1quMAPoTIlsG+TBFW0s9+LqY8ufE9+8u8S1FynZlsgfIoKl2bKVXWWrZVfJ+S8mh6mH4V3MuhLwljv+/6HDZCc3FoY5eN/lyWI49Maz5W87bKqNyecYtrBlvML7k5UeOLtgNuUsTBlzFTxMkaQHOSpMyrHZ/yVPNVfuP3cCKvzMPHFGHzJZK0qvz4zdFdx7YzBq+I6YLvRES9b+DkvdrTOpZI2GjKuP5m13kcUjsFeqJR6rb+o1kJuCj/QMC2OjMXMlDqNa8mL5ooGQmYOzHkfq4vdKLG/Fvbpw2DDrwv9jKmw2l6eWLYzuIpvz7sqUHwi30wScXSm/FCKF9DjzODUpSkBvDiaA=='</span></code></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="guide_cucumber.html" class="btn btn-neutral" title="Guide d’écriture des tests Cucumber" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Ce document est distribué sous les termes de la Licence Ouverte V2.0

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'./',
              VERSION:'1.10.3',
              LANGUAGE:'fr',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/translations.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
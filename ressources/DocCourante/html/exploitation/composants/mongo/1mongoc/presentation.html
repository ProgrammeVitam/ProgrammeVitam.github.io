

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="fr" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="fr" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>7.2.8.2.1. Présentation &mdash; Documentation VITAM - Documentation d&#39;exploitation 3.0.1</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../../',
              VERSION:'3.0.1',
              LANGUAGE:'fr',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/translations.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Recherche" href="../../../search.html" />
    <link rel="next" title="7.2.8.2.2. Configuration / fichiers utiles" href="configuration.html" />
    <link rel="prev" title="7.2.8.2. Service vitam-mongoc" href="_toc.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> VITAM - Documentation d'exploitation
          

          
            
            <img src="../../../_static/logo_vitam.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html#rappels">2. Rappels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../prerequis-competences.html">3. Expertises requises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../architecture.html">4. Architecture de la solution logicielle VITAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../topics/_toc.html">5. Exploitation globale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../monitoring/_toc.html">6. Suivi de l’état du système</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../_toc.html">7. Exploitation des COTS de la solution logicielle VITAM</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../_toc.html#generalites">7.1. Généralités</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../_toc.html#cots">7.2. COTS</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../cerebro/_toc.html">7.2.1. Cerebro</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../consul/_toc.html">7.2.2. Consul</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../elasticsearch_interceptor/_toc.html">7.2.3. Kibana interceptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../elasticsearch_log/_toc.html">7.2.4. Elasticsearch chaîne de log</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../elasticsearch_vitam/_toc.html">7.2.5. Elasticsearch Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../kibana/_toc.html">7.2.6. Kibana</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../log_server/_toc.html">7.2.7. Log server</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../_toc.html">7.2.8. MongoDB</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../0mongos/_toc.html">7.2.8.1. Service vitam-mongos</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="_toc.html">7.2.8.2. Service vitam-mongoc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../2mongod/_toc.html">7.2.8.3. Service vitam-mongod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../3deployment/_toc.html">7.2.8.4. Topologies de déploiement et tolérance aux pannes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../4exploitation/_toc.html">7.2.8.5. Exploitation d’un cluster MongoDB</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../siegfried/_toc.html">7.2.9. Siegfried</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../include/_toc.html">8. Exploitation des composants de la solution logicielle VITAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../external_app.html">9. Intégration d’une application externe dans Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../troubleshoot/_toc.html">10. Aide à l’exploitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../FAQ/_toc.html">11. Questions Fréquemment Posées</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../annexes/_toc.html">12. Annexes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">VITAM - Documentation d'exploitation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../_toc.html">7. Exploitation des COTS de la solution logicielle VITAM</a> &raquo;</li>
        
          <li><a href="../_toc.html">7.2.8. MongoDB</a> &raquo;</li>
        
          <li><a href="_toc.html">7.2.8.2. Service vitam-mongoc</a> &raquo;</li>
        
      <li>7.2.8.2.1. Présentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/composants/mongo/1mongoc/presentation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="presentation">
<h1>7.2.8.2.1. Présentation<a class="headerlink" href="#presentation" title="Lien permanent vers ce titre">¶</a></h1>
<p>Le composant <code class="docutils literal notranslate"><span class="pre">vitam-mongoc</span></code> représente le service de configuration du cluster MongoDB déployé. Techniquement, il s’agit d’une instance du serveur de la base de données MongoDB (processus mongod) qui détient des bases et collections de configuration.</p>
<div class="admonition caution">
<p class="first admonition-title">Prudence</p>
<p class="last">Il est fortement recommandé de ne pas modifier ces collections, excepté lorsqu’un mode opératoire Vitam le mentionne ou à la demande explicite de l’éditeur de la base MongoDB.</p>
</div>
<p>Ce composant est déployé sous forme de <code class="docutils literal notranslate"><span class="pre">ReplicaSet</span></code>, c’est à dire un groupe de serveurs qui détiennent les mêmes données, afin de permettre une haute disponibilité du service ainsi qu’une réplication des données gérées.</p>
<p>A un instant donné, un serveur est identifié comme <code class="docutils literal notranslate"><span class="pre">Master</span></code> tandis que les autres serveurs sont identifiés comme <code class="docutils literal notranslate"><span class="pre">Slave</span></code>. Un serveur est appellé <code class="docutils literal notranslate"><span class="pre">membre</span></code> (d’un <code class="docutils literal notranslate"><span class="pre">ReplicaSet</span></code>). La réplication des données est réalisée, au travers d’une communication <code class="docutils literal notranslate"><span class="pre">Master/Slave</span></code>, sur les serveurs <code class="docutils literal notranslate"><span class="pre">Slave</span></code>, en reprenant les opérations (<code class="docutils literal notranslate"><span class="pre">OpLog</span></code>) réalisées sur le serveur <code class="docutils literal notranslate"><span class="pre">Master</span></code>. Le serveur <code class="docutils literal notranslate"><span class="pre">Master</span></code> est nommé membre <code class="docutils literal notranslate"><span class="pre">Primary</span></code> et les serveurs <code class="docutils literal notranslate"><span class="pre">Slave</span></code> sont nommés membres <code class="docutils literal notranslate"><span class="pre">Secondary</span></code>.
Un mécanisme de vérification du statut d’un membre permet de gérer la haute disponibilité : si le membre <code class="docutils literal notranslate"><span class="pre">Primary</span></code> devient indisponible, un membre <code class="docutils literal notranslate"><span class="pre">Secondary</span></code> sera élu pour devenir <code class="docutils literal notranslate"><span class="pre">Primary</span></code>. Ces concepts sont utilisés dans la configuration du cluster.</p>
<p>Toutes les requêtes d’écriture sont réalisées uniquement sur le membre <code class="docutils literal notranslate"><span class="pre">Primary</span></code>, alors que les requêtes de lecture peuvent aussi être réalisées sur les membres <code class="docutils literal notranslate"><span class="pre">Secondary</span></code>.
Pour gérer la consistance de la donnée entre les membres (concept <code class="docutils literal notranslate"><span class="pre">eventual</span> <span class="pre">consistency</span></code>), un mécanisme permet d’acquitter une écriture lorsque le membre <code class="docutils literal notranslate"><span class="pre">Primary</span></code> a pris en compte l’écriture (écris dans les logs d’opérations), et éventuellement lorsque l’écriture a été répliquée sur un, des ou l’ensemble des membres <code class="docutils literal notranslate"><span class="pre">Secondary</span></code>. Les requêtes Vitam sont executées avec ce mécanisme, configuré pour qu’une majorité de membre retourne un acquittement (voir <code class="docutils literal notranslate"><span class="pre">Write</span> <span class="pre">Concern</span></code> valué à <code class="docutils literal notranslate"><span class="pre">Majority</span></code>).
Le même mécanisme existe pour les lectures, à savoir, qu’une lecture peut éventuellement être vérifiée sur plusieurs membres afin d’assurer la consistance de la lecture. La encore, les requêtes Vitam sont executées avec ce mécasnime, configuré pour qu’une majorité de membres confirme disposer de la même donnée (voir <code class="docutils literal notranslate"><span class="pre">Read</span> <span class="pre">Concern</span></code> valué à <code class="docutils literal notranslate"><span class="pre">Majority</span></code>).
Les paramètres <code class="docutils literal notranslate"><span class="pre">Write</span> <span class="pre">Concern</span></code> et <code class="docutils literal notranslate"><span class="pre">Read</span> <span class="pre">Concern</span></code> positionnés à <code class="docutils literal notranslate"><span class="pre">Majority</span></code> permettent de configurer le niveau de consistance d’un <code class="docutils literal notranslate"><span class="pre">ReplicaSet</span></code> en jouant uniquement sur le nombre de membres déployés dans un <code class="docutils literal notranslate"><span class="pre">ReplicaSet</span></code>. Ces paramètres ne sont donc pas modifiables vis à vis des fichiers de paramétrage Vitam.</p>
<p>Le déploiement standard d’un <code class="docutils literal notranslate"><span class="pre">ReplicaSet</span></code> en production, est composé de 3 membres. Cet exemple de déploiement est nommé <code class="docutils literal notranslate"><span class="pre">PSS</span></code>, pour illustrer la composition du <code class="docutils literal notranslate"><span class="pre">ReplicaSet</span></code> avec des membres <code class="docutils literal notranslate"><span class="pre">Primary</span> <span class="pre">Secondary</span> <span class="pre">Secondary</span></code>. Avec cette topologie, les mécanismes pour garantir la consistance de la donnée (configurés avec la valeur <code class="docutils literal notranslate"><span class="pre">Majority</span></code>) permettent de s’assurer que la donnée est pris en compte par 2 membres (sur les 3).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">cette configuration permet une tolérance aux pannes satisfaisante. Toutefois, il est possible d’améliorer cette tolérance en ajoutant des membres. Consulter la documentation officielle pour plus de détail : <code class="docutils literal notranslate"><span class="pre">https://docs.mongodb.com/manual/core/replica-set-architectures/</span></code>.</p>
</div>
<p>La charge estimée du service <code class="docutils literal notranslate"><span class="pre">mongoc</span></code> est faible, aussi les ressources machines allouées peuvent être réduites (par exemple, 2 vCPU / 4 Go RAM).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">les tests de performance du système ont montrés que la colocalisation des services vitam-mongos et vitam-mongoc sur la même machine n’a pas d’impact.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="configuration.html" class="btn btn-neutral float-right" title="7.2.8.2.2. Configuration / fichiers utiles" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="_toc.html" class="btn btn-neutral float-left" title="7.2.8.2. Service vitam-mongoc" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Ce document est distribué sous les termes de la Licence Ouverte V2.0

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
<!DOCTYPE html>
<html class="writer-html4" lang="fr" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>5.3. Modules IHM Front &mdash; Documentation VITAM - Manuel de développement 6.1</title><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../_static/translations.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Recherche" href="../../search.html" />
    <link rel="next" title="5.4. IHM Front - Tests" href="ihm-tests.html" />
    <link rel="prev" title="5.2. IHM Front" href="ihm-front.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            VITAM - Manuel de développement
              <img src="../../_static/logo_vitam.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                6.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html#rappels">Rappels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-environnement.html">Configuration de l’environnement de développement</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../_toc.html">Détails par composant</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../access/_toc.html">1. Access</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collect/_toc.html">2. Collect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../common/_toc.html">3. Common</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functional-administration/_toc.html">4. Functional administration</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="_toc.html">5. IHM demo</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ihm-logbook-introduction.html">5.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="ihm-front.html">5.2. IHM Front</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">5.3. Modules IHM Front</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-archive-unit">5.3.1. Module archive-unit</a></li>
<li class="toctree-l4"><a class="reference internal" href="#affichage-dynamiquetable">5.3.2. Affichage dynamiqueTable</a></li>
<li class="toctree-l4"><a class="reference internal" href="#service-de-recherche">5.3.3. Service de recherche</a></li>
<li class="toctree-l4"><a class="reference internal" href="#service-d-affichage-des-mesures-d-un-objet-physique">5.3.4. Service d’affichage des mesures d’un objet physique</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ihm-tests.html">5.4. IHM Front - Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="ihm-logbook-dat.html">5.5. DAT : module IHM logbook operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="ihm-rest-raml.html">5.6. ihm-demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="ihm-tenant-id.html">5.7. IHM Front - Requêtes HTTP et Tenant ID</a></li>
<li class="toctree-l3"><a class="reference internal" href="ihm-authorization.html">5.8. Gestion des droits sur IHM demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="ihm-filter-requestID.html">5.9. IHM Filter for X-Request-ID</a></li>
<li class="toctree-l3"><a class="reference internal" href="ihm-demo-serveur.html">5.10. IHM Demo serveur</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ihm-recette/_toc.html">6. IHM demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ingest/_toc.html">7. Ingest</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internal-security/_toc.html">8. Security-Internal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logbook/_toc.html">9. Logbook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metadata/_toc.html">10. Metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../processing/_toc.html">11. Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scheduler/_toc.html">12. Scheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../storage/_toc.html">13. Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../technical-administration/_toc.html">14. Technical administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../worker/_toc.html">15. Worker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../workspace/_toc.html">16. Workspace</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../parallisation_tests.html">Parallélisation des tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plugin-icu-elasticsearch.html">Plugin ICU Elasticsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gestion-database.html">Gestion des bases de données</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../client-ressource-rest.html">Ressources et clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devstack_vm.html">Création d’une machine de dev contenant <em>Swift</em></a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">VITAM - Manuel de développement</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../_toc.html">Détails par composant</a></li>
          <li class="breadcrumb-item"><a href="_toc.html">5. IHM demo</a></li>
      <li class="breadcrumb-item active">5.3. Modules IHM Front</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/include/ihm-demo/ihm-modules.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="modules-ihm-front">
<h1>5.3. Modules IHM Front<a class="headerlink" href="#modules-ihm-front" title="Lien permanent vers ce titre">¶</a></h1>
<p>Cette documentation décrit les principaux modules réutilisables de l’IHM front (js)</p>
<div class="section" id="module-archive-unit">
<h2>5.3.1. Module archive-unit<a class="headerlink" href="#module-archive-unit" title="Lien permanent vers ce titre">¶</a></h2>
<p>Ce module ne comprends pas le module “archive-unit-search”
Ce module permet le processing et l’affichage des données liées à une Archive Unit.
Les directives utilisées sont:</p>
<ul class="simple">
<li>display-field qui permet d’afficher un champ en prenant en compte le mode édition</li>
<li>display-fieldtree qui permet d’afficher un ensemble de champs en utilisant le directive display-field avec des paramètres standards pour chaque champ</li>
</ul>
<div class="section" id="directive-display-field">
<h3>5.3.1.1. Directive display-field<a class="headerlink" href="#directive-display-field" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette directive permet d’afficher un champ “simple” en mode visualisation ou edition.
Un champ “simple” est un champ qui à simplement une valeur (Texte/nombre) et pas de sous-élément.</p>
<p>Usages:
Pour utiliser cette directive il suffit d’appeler la balise “&lt;display-field” en spécifiant les parametres suivants:</p>
<ul class="simple">
<li>field-label: Surcharge du nom du label</li>
<li>field-object: L’ensemble des propriétés de l’objet. Doit contenir au moins:</li>
</ul>
<p>– isModificationAllowed: vrai si le champ est éditable
– isFieldEdit: vrai si le champ est en cours d’édition
– fieldValue: La valeur affichée du champ</p>
<ul class="simple">
<li>edit-mode: Vrai si le formulaire est en mode édition</li>
<li>field-size: La valeur du XX dans la classe CSS de bootstrap col-md-XX.</li>
<li><dl class="first docutils">
<dt>intercept-user-change: Fonction de callback à appeler lorsque la champ est modifié</dt>
<dd>Cette fonction doit prendre un fieldSet en paramètres.</dd>
</dl>
</li>
</ul>
<p>Il est également possible de donner une valeur de surcharge pour la valeur du champ grâce à ce dernier paramètre:</p>
<ul class="simple">
<li>display-value: Affiche une valeur spécifique à la place de fieldValue (Le mode édition reprends la valeur réelle)</li>
</ul>
<p>Exemple:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-xs-12&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group col-md-6&quot;</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">display-field</span> <span class="na">field-label</span><span class="o">=</span><span class="s">&quot;&#39;Service producteur&#39;&quot;</span> <span class="na">field-size</span><span class="o">=</span><span class="s">&quot;&#39;11&#39;&quot;</span>
        <span class="na">intercept-user-change</span><span class="o">=</span><span class="s">&quot;$ctrl.interceptUserChanges(fieldSet)&quot;</span>
        <span class="na">field-object</span><span class="o">=</span><span class="s">&quot;$ctrl.mainFields[&#39;OriginatingAgency&#39;].content[0]&quot;</span> <span class="na">edit-mode</span><span class="o">=</span><span class="s">&quot;$ctrl.isEditMode&quot;</span><span class="p">&gt;</span>
     <span class="p">&lt;/</span><span class="nt">display-field</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="directive-display-fieldtree">
<h3>5.3.1.2. Directive display-fieldtree<a class="headerlink" href="#directive-display-fieldtree" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette directive permet d’afficher un champ et leurs sous élément si nécessaire de manière récursive.
- field-object: L’ensemble des propriétés de l’objet. Doit contenir au moins:</p>
<p>– isModificationAllowed: vrai si le champ est éditable
– isFieldEdit: vrai si le champ est en cours d’édition
– fieldValue: La valeur affichée du champ
– typeF: Le type de champ</p>
<blockquote>
<div>“P” correspond à un champs “parent” avec des sous éléments.
“S” correspond à un champ simple.</div></blockquote>
<p>– content: Tableau de fieldObject contenant les enfants de ce champ.</p>
<ul>
<li><p class="first">edit-mode: Vrai si le formulaire est en mode édition</p>
</li>
<li><p class="first">intercept-user-change: Fonction de callback à appeler lorsque la champ est modifié.</p>
<blockquote>
<div><p>Cette fonction doit prendre un fieldSet en paramètres.</p>
</div></blockquote>
</li>
</ul>
<p>Exemple:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;row archiveDesc panel-collapse collapse in&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;{{&#39;box&#39; + key}}&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">ng-repeat</span><span class="o">=</span><span class="s">&quot;fieldSet in $ctrl.managmentItems&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">display-fieldtree</span> <span class="na">intercept-user-change</span><span class="o">=</span><span class="s">&quot;$ctrl.interceptUserChanges(fieldSet)&quot;</span>
            <span class="na">field-object</span><span class="o">=</span><span class="s">&quot;fieldSet&quot;</span> <span class="na">edit-mode</span><span class="o">=</span><span class="s">&quot;$ctrl.isEditMode&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">display-fieldtree</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="affichage-des-libelles-des-champs">
<h3>5.3.1.3. Affichage des Libéllés des champs<a class="headerlink" href="#affichage-des-libelles-des-champs" title="Lien permanent vers ce titre">¶</a></h3>
<p>La fonction self.displayLabel du controller archive-unit permet de récupérer la valeur française des champs à afficher.</p>
<ul>
<li><p class="first">key: nom technique du champ à afficher</p>
</li>
<li><p class="first">parent: nom technique de son parent direct.</p>
<blockquote>
<div><p>permet de reconstituer la clé parent.key pour les champs “parent”</p>
</div></blockquote>
</li>
<li><p class="first">constantes: Nom du fichier de constantes à utiliser.</p>
<blockquote>
<div><p>Cela permet d’avoir plusieurs _id (par exemple) en fonction du context.
Les fichiers de constantes sont définis dans archive-unit.constant.js.
Les clés des constantes équivalent à «&nbsp;key&nbsp;» pour les champs simples et à “parent.key” pour les champs parent.</p>
</div></blockquote>
</li>
<li><p class="first">retourne le label si présent dans le fichier de constantes ou la clé (key) sinon.</p>
</li>
</ul>
<p>Exemple:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">fieldSet</span><span class="p">.</span><span class="nx">fieldId</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">parent</span> <span class="o">=</span> <span class="nx">fieldSet</span><span class="p">.</span><span class="nx">parent</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">constants</span> <span class="o">=</span> <span class="nx">ARCHIVE_UNIT_MODULE_OG_FIELD_LABEL</span><span class="p">;</span>
<span class="nx">fieldSet</span><span class="p">.</span><span class="nx">fieldName</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">displayLabel</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">parent</span><span class="p">,</span> <span class="nx">constants</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="affichage-dynamiquetable">
<h2>5.3.2. Affichage dynamiqueTable<a class="headerlink" href="#affichage-dynamiquetable" title="Lien permanent vers ce titre">¶</a></h2>
<p>Cette directive permet de dynamiser les tableaux de données pour sélectionner les colonnes à afficher.</p>
<ul>
<li><p class="first">custom-fields: Ce sont les champs dynamiques pour le tableau.</p>
<p>Ces objets doivent au moins avoir les champs “id” (Valeur technique et unique) et “label” (Valeur affichable à l’utilisateur).</p>
</li>
</ul>
<blockquote>
<div>selected-objects: Ce sont les objets sélectionnés à afficher. L’objet en etrée peut être un tableau vide et sera nourri par la directive</div></blockquote>
<p>Attention, pour des raisons d’ergonomie, il est demandé d’ajouter la classe CSS “dynamic-table-box” au div “panel-default” englobant.
Cela permet à ce div de devenir dynamique et de dépasser de la page si plus de colones sont affichés. Ainsi la scrollbar horizontale est accessible directement.</p>
</div>
<div class="section" id="service-de-recherche">
<h2>5.3.3. Service de recherche<a class="headerlink" href="#service-de-recherche" title="Lien permanent vers ce titre">¶</a></h2>
<p>Le service ProcessSearchService (process-search.service.js) permet de factoriser les actions de recherche et de globaliser son fonctionnement. Tout écran de recherche doit l’utiliser.</p>
<p>Il met à disposition une fonction d’initialisation (initAndServe) du service de recherche qui renvoie 3 functions possibles:</p>
<ul class="simple">
<li>processSearch - Lance la requête HTTP et traite le comportement d’erreur si besoin (Affichage du message / vider les résultats / …)</li>
<li>reinitForm - Efface tout les champs de recherche pour reprendre les valeurs initiales des champs et relance une recherche (si besoin).</li>
<li>onInputChange - Fonction qui peut être appelée par le contrôleur lors d’une modification d’un champ pour déclancher une réinitialisation de la recherche si le formulaire est revenu à son état initial.</li>
</ul>
<p>Aussi, en plus des autres paramètres (voir JS doc de la fonction initAndServe), l’initialisation prends en paramètre un objet “searchScope” qui doit être lié au scope et doit être de la forme suivante:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">searchScope</span> <span class="o">=</span> <span class="p">{</span>
   <span class="nx">form</span><span class="o">:</span> <span class="p">{</span><span class="cm">/* Valeurs initiales des champs de recherche (seront donc mises à jour par la vue et par le service) */</span><span class="p">},</span>
   <span class="nx">pagination</span><span class="o">:</span> <span class="p">{</span> <span class="cm">/* Valeurs des variables de pagination */</span> <span class="p">},</span>
   <span class="nx">error</span><span class="o">:</span> <span class="p">{</span> <span class="cm">/* Mise à jour des message d&#39;erreur */</span> <span class="p">},</span>
   <span class="nx">response</span><span class="o">:</span> <span class="p">{</span> <span class="cm">/*  */</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Ce service permet d’effectuer les actions suivantes de manière uniforme quelque soit le controller qui l’appelle:</p>
<ul class="simple">
<li>Obliger d’utiliser la chaîne de fonctions fournies (Evite d’avoir une implem differente sur chaque controller)</li>
<li>Gérer la réinitialisation des messages d’erreur lors du lancement d’une nouvelle recherche (searchScope.error)</li>
<li>Gérer la réinitialisation du nombre de résultats lors de chaque recherches (searchscope.response)</li>
<li>Gestion de la recherche automatique à l’initialisation de la page (Ou à la réinitialisation du formulaire)</li>
</ul>
<p>Par la suite, ce service pourra être complété par des directives (liste non exaustive) pour automatiser l’affichage des informations similaires:</p>
<ul class="simple">
<li>Messages d’erreur (On peut imaginer une directive à assossier à un formulaire qui affiche les boutons d’effactement multi-champs, le bouton de résultat et le message d’erreur en se basant sur le searchScope.form et searchScope.error)</li>
<li>Affichage des résultats (On peut imaginer une directive se basant sur searchScope.response déffinissant un pattern pour le tableau de résultat et le titre + Nb résultats).</li>
<li>Gestion de la pagination (On peut imaginer une directive se basant sur le searchScope.pagination et searchScope.response pour calculer les éléments de pagination).</li>
</ul>
</div>
<div class="section" id="service-d-affichage-des-mesures-d-un-objet-physique">
<h2>5.3.4. Service d’affichage des mesures d’un objet physique<a class="headerlink" href="#service-d-affichage-des-mesures-d-un-objet-physique" title="Lien permanent vers ce titre">¶</a></h2>
<p>Le service uneceMappingService à pour but d’aller chercher les unitées de mesures contenu dans le fichiers unece.json pour l’afficher dans une valeur compréhensible pour les utilisateurs</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ihm-front.html" class="btn btn-neutral float-left" title="5.2. IHM Front" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ihm-tests.html" class="btn btn-neutral float-right" title="5.4. IHM Front - Tests" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Ce document est distribué sous les termes de la Licence Ouverte V2.0.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="fr" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="fr" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>10.1. Analyse de premier niveau &mdash; Documentation VITAM - Documentation d&#39;exploitation 3.0.1</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'3.0.1',
              LANGUAGE:'fr',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="11. Questions Fréquemment Posées" href="../FAQ/_toc.html" />
    <link rel="prev" title="10. Aide à l’exploitation" href="_toc.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> VITAM - Documentation d'exploitation
          

          
            
            <img src="../_static/logo_vitam.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html#rappels">2. Rappels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prerequis-competences.html">3. Expertises requises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">4. Architecture de la solution logicielle VITAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/_toc.html">5. Exploitation globale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monitoring/_toc.html">6. Suivi de l’état du système</a></li>
<li class="toctree-l1"><a class="reference internal" href="../composants/_toc.html">7. Exploitation des COTS de la solution logicielle VITAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../include/_toc.html">8. Exploitation des composants de la solution logicielle VITAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../external_app.html">9. Intégration d’une application externe dans Vitam</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="_toc.html">10. Aide à l’exploitation</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">10.1. Analyse de premier niveau</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#etat-par-consul">10.1.1. Etat par Consul</a></li>
<li class="toctree-l3"><a class="reference internal" href="#etat-par-kibana">10.1.2. Etat par Kibana</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#playbook-ansible-pour-echanger-avec-le-support">10.2. Playbook ansible pour échanger avec le support</a></li>
<li class="toctree-l2"><a class="reference internal" href="#identification-des-au-non-conformes">10.3. Identification des AU non conformes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../FAQ/_toc.html">11. Questions Fréquemment Posées</a></li>
<li class="toctree-l1"><a class="reference internal" href="../annexes/_toc.html">12. Annexes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">VITAM - Documentation d'exploitation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="_toc.html">10. Aide à l’exploitation</a> &raquo;</li>
        
      <li>10.1. Analyse de premier niveau</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/troubleshoot/analyse.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="analyse-de-premier-niveau">
<h1>10.1. Analyse de premier niveau<a class="headerlink" href="#analyse-de-premier-niveau" title="Lien permanent vers ce titre">¶</a></h1>
<p>Cette section a pour but de présenter les premiers outils à utiliser pour réaliser une analyse de premier niveau, en cas de problème avec la solution logicielle <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a>.</p>
<div class="section" id="etat-par-consul">
<h2>10.1.1. Etat par Consul<a class="headerlink" href="#etat-par-consul" title="Lien permanent vers ce titre">¶</a></h2>
<p>Se connecter à l’IHM de Consul et recenser les états des composants de la solution logicielle <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a>.</p>
<img alt="../_images/consul_check.png" src="../_images/consul_check.png" />
<p>A l’heure actuelle, tous les composants doivent avoir un statut de couleur verte. Si ce n’est pas le cas :</p>
<ol class="arabic simple">
<li>seul un composant est KO, alors redémarrer le composant incriminé</li>
<li>si plusieurs services sont KO, suivre la procédure de redémarrage de VITAM</li>
<li>si tous les «&nbsp;check-DNS&nbsp;» (visible dans le détail des checks de chaque service) sont  KO, s’assurer que, sur les machines hébergeant VITAM, le fichier <code class="docutils literal notranslate"><span class="pre">/etc/resolv.conf</span></code> contient, en début de fichier, la ligne : <code class="docutils literal notranslate"><span class="pre">nameserver</span> <span class="pre">127.0.0.1</span></code>.</li>
</ol>
</div>
<div class="section" id="etat-par-kibana">
<h2>10.1.2. Etat par Kibana<a class="headerlink" href="#etat-par-kibana" title="Lien permanent vers ce titre">¶</a></h2>
<p>Se connecter à Kibana, aller dans «&nbsp;Dashboards&nbsp;». Cliquer sur le bouton «&nbsp;Load Saved Dashboard&nbsp;» et sélectionner «&nbsp;Composants VITAM&nbsp;».
Eventuellement, changer la résolution (en haut à droite, par défaut, réglé sur les 15 dernières minutes).</p>
<p>Sur «&nbsp;pie-logback-error-level&nbsp;», cliquer sur la section de camembert d’intérêt (ERROR) et regarder, en bas de page, les éventuelles erreurs remontées dans Kibana.</p>
</div>
</div>
<div class="section" id="playbook-ansible-pour-echanger-avec-le-support">
<h1>10.2. Playbook ansible pour échanger avec le support<a class="headerlink" href="#playbook-ansible-pour-echanger-avec-le-support" title="Lien permanent vers ce titre">¶</a></h1>
<p>Afin de simplifier et minimiser les échanges, un playbook à fins d’exploitation/support a été développé.</p>
<p>Celui-ci comprend :</p>
<blockquote>
<div><ul class="simple">
<li>la récupération des informations machines de la solution logicielle <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a></li>
<li>l’état Consul des composants</li>
<li>la récupération des traces applicatives (fichiers log) de moins de 2 jours</li>
<li>l’état des clusters Elasticsearch</li>
<li>la possibilité, au choix de l’exploitant, de fournir également les clés publiques des certificats</li>
</ul>
</div></blockquote>
<p>et compacte l’ensemble des données collectées, tout en purgeant le répertoire temporaire de récupération des données. Ce fichier est alors à envoyer par <em>mail</em> au support.</p>
<p>La commande pour générer le fichier est à lancer depuis le répertoire <code class="docutils literal notranslate"><span class="pre">deployment</span></code> :</p>
<p><code class="docutils literal notranslate"><span class="pre">ansible-playbook</span> <span class="pre">-i</span> <span class="pre">environments/&lt;fichier</span> <span class="pre">d'inventaire&gt;</span> <span class="pre">ansible-vitam-exploitation/troubleshoot.yml</span> <span class="pre">--vault-password-file</span> <span class="pre">vault_pass.txt</span></code></p>
</div>
<div class="section" id="identification-des-au-non-conformes">
<h1>10.3. Identification des AU non conformes<a class="headerlink" href="#identification-des-au-non-conformes" title="Lien permanent vers ce titre">¶</a></h1>
<p>Le schéma JSON des AU a été corrigé et rationalisé. Toute donnée issue d’un Ingest d’une release précédente est conforme à cette expression corrigée du schéma. Dans les versions précédentes, le DSL autorisait des modifications non conformes au SEDA. Ce n’est plus possible dans la présente version.</p>
<p>Si des modifications non conformes ont eu lieu, alors des AU non conformes peuvent donc se retrouver en base. Lorsque cela arrive :
* L’export DIP de l’AU peut échouer.
* La modification d’un champ A rapportera une erreur sur un champs B non-conforme. La correction de ce problème se fera avec une requête DSL qui modifie le champ A et le champs B (en lui donnant une valeur
conforme).
* Maintenant les champs SEDA sont soit des tableaux, soit des valeurs simples (string ou objet). Certains champs qui pouvaient s’écrire sous forme de valeurs non tabulaires, doivent maintenant être écrits sous forme de tableau, même s’ils n’ont qu’un seul élément. Ex : Coverage.Spatial.</p>
<p>Cette procédure scriptée permet de détecter l’ensemble des AU non conformes. Les retours associés pourront être transmis au support VITAM (<a class="reference external" href="mailto:assistance&#37;&#52;&#48;programmevitam&#46;fr">assistance<span>&#64;</span>programmevitam<span>&#46;</span>fr</a>).</p>
<p>La commande pour générer le fichier est à lancer depuis le répertoire <code class="docutils literal notranslate"><span class="pre">deployment</span></code> :</p>
<p><code class="docutils literal notranslate"><span class="pre">ansible-playbook</span> <span class="pre">-i</span> <span class="pre">environments/&lt;fichier</span> <span class="pre">d'inventaire&gt;</span> <span class="pre">ansible-vitam-exploitation/check_unit_compatibility.yml</span> <span class="pre">--vault-password-file</span> <span class="pre">vault_pass.txt</span></code></p>
<p>A l’issue, si des <a class="reference internal" href="../introduction.html#term-au"><span class="xref std std-term">AU</span></a> sont considérées en erreur, se rapprocher du métier pour réaliser une première analyse / tentative de correction, par correction des données incorrectes.</p>
<p>Si l’erreur persiste, contacter le support.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../FAQ/_toc.html" class="btn btn-neutral float-right" title="11. Questions Fréquemment Posées" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="_toc.html" class="btn btn-neutral float-left" title="10. Aide à l’exploitation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Ce document est distribué sous les termes de la Licence Ouverte V2.0

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
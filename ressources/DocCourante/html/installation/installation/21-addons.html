

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="fr" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="fr" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4.2.4. Paramétrages supplémentaires &mdash; Documentation VITAM - Documentation d&#39;installation 2.1.1</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="4.2.5. Procédure de première installation" href="30-installation.html" />
    <link rel="prev" title="4.2.3.4. Génération des magasins de certificats" href="certificats/keystores.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> VITAM - Documentation d'installation
          

          
            
            <img src="../_static/logo_vitam.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2.1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html#rappels">2. Rappels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pre_install/_toc.html">3. Prérequis à l’installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="_toc.html">4. Procédures d’installation / mise à jour</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="_toc.html#verifications-prealables">4.1. Vérifications préalables</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="_toc.html#procedures">4.2. Procédures</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="05_multisite.html">4.2.1. Multi-sites</a></li>
<li class="toctree-l3"><a class="reference internal" href="10-configuration.html">4.2.2. Configuration du déploiement</a></li>
<li class="toctree-l3"><a class="reference internal" href="20-certificats.html">4.2.3. Gestion des certificats</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">4.2.4. Paramétrages supplémentaires</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tuning-jvm">4.2.4.1. Tuning JVM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#installation-des-greffons">4.2.4.2. Installation des greffons</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parametrage-de-l-antivirus-ingest-externe">4.2.4.3. Paramétrage de l’antivirus (ingest-externe)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parametrage-des-certificats-externes-externe">4.2.4.4. Paramétrage des certificats externes (*-externe)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#placer-hors-vitam-le-composant-ihm-demo">4.2.4.5. Placer «&nbsp;hors Vitam&nbsp;» le composant ihm-demo</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parametrage-de-la-centralisation-des-logs-vitam">4.2.4.6. Paramétrage de la centralisation des logs Vitam</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fichiers-complementaires">4.2.4.7. Fichiers complémentaires</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="30-installation.html">4.2.5. Procédure de première installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="80-extras.html">4.2.6. Elements extras de l’installation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../update/_toc.html">5. Procédures de mise à jour</a></li>
<li class="toctree-l1"><a class="reference internal" href="../post_install/_toc.html">6. Post installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../annexes/_toc.html">7. Annexes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">VITAM - Documentation d'installation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="_toc.html">4. Procédures d’installation / mise à jour</a> &raquo;</li>
        
      <li>4.2.4. Paramétrages supplémentaires</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/installation/21-addons.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="parametrages-supplementaires">
<h1>4.2.4. Paramétrages supplémentaires<a class="headerlink" href="#parametrages-supplementaires" title="Lien permanent vers ce titre">¶</a></h1>
<div class="section" id="tuning-jvm">
<span id="update-jvm"></span><h2>4.2.4.1. Tuning JVM<a class="headerlink" href="#tuning-jvm" title="Lien permanent vers ce titre">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Cette section est en cours de développement.</p>
</div>
<div class="admonition caution">
<p class="first admonition-title">Prudence</p>
<p class="last">en cas de colocalisation, bien prendre en compte la taille <a class="reference internal" href="../introduction.html#term-jvm"><span class="xref std std-term">JVM</span></a> de chaque composant (VITAM : -Xmx512m par défaut) pour éviter de <cite>swapper</cite>.</p>
</div>
<p>Un <cite>tuning</cite> fin des paramètres JVM de chaque composant <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> est possible.
Pour cela, il faut modifier le contenu du fichier <code class="docutils literal notranslate"><span class="pre">environments/group_vars/all/jvm_opts.yml</span></code></p>
<p>Pour chaque composant, il est possible de modifier ces 3 variables:</p>
<ul class="simple">
<li>memory: paramètres Xms et Xmx</li>
<li>gc: parmètres gc</li>
<li>java: autres paramètres java</li>
</ul>
</div>
<div class="section" id="installation-des-greffons">
<h2>4.2.4.2. Installation des greffons<a class="headerlink" href="#installation-des-greffons" title="Lien permanent vers ce titre">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Fonctionnalité apparue en R9.</p>
</div>
<p>Il est possible de choisir les greffons installables sur la plate-forme. Pour cela, il faut éditer le contenu du fichier <code class="docutils literal notranslate"><span class="pre">environments/group_vars/all/vitam-vars.yml</span></code> au niveau de la directive <code class="docutils literal notranslate"><span class="pre">vitam_griffins</span></code>. Cette action est à rapprocher de l’incorporation des binaires d’installation : les binaires d’installation des greffons doivent être accessibles par les machines hébergeant le composant <strong>worker</strong>.</p>
<p>Exemple:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vitam_griffins</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;vitam-imagemagick-griffin&quot;</span><span class="p">,</span> <span class="s2">&quot;vitam-jhove-griffin&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Voici la liste des greffons disponibles au moment de la présente publication :</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>vitam-imagemagick-griffin
vitam-jhove-griffin
</pre></div>
</div>
</div>
<div class="section" id="parametrage-de-l-antivirus-ingest-externe">
<h2>4.2.4.3. Paramétrage de l’antivirus (ingest-externe)<a class="headerlink" href="#parametrage-de-l-antivirus-ingest-externe" title="Lien permanent vers ce titre">¶</a></h2>
<p>L’antivirus utilisé par ingest-externe est modifiable (par défaut, ClamAV) ; pour cela :</p>
<ul>
<li><p class="first">Modifier le fichier <code class="docutils literal notranslate"><span class="pre">environments/group_vars/all/vitam_vars.yml</span></code> pour indiquer le nom de l’antivirus qui sera utilisé (norme : scan-&lt;nom indiqué dans vitam-vars.yml&gt;.sh)</p>
</li>
<li><p class="first">Créer un shell (dont l’extension doit être <code class="docutils literal notranslate"><span class="pre">.sh</span></code>) sous <code class="docutils literal notranslate"><span class="pre">environments/antivirus/</span></code> (norme : scan-&lt;nom indiqué dans vitam-vars.yml&gt;.sh) ; prendre comme modèle le fichier <code class="docutils literal notranslate"><span class="pre">scan-clamav.sh</span></code>. Ce script shell doit respecter le contrat suivant :</p>
<blockquote>
<div><ul class="simple">
<li>Argument : chemin absolu du fichier à analyser</li>
<li><dl class="first docutils">
<dt>Sémantique des codes de retour</dt>
<dd><ul class="first last">
<li>0 : Analyse OK - pas de virus</li>
<li>1 : Analyse OK - virus trouvé et corrigé</li>
<li>2 : Analyse OK - virus trouvé mais non corrigé</li>
<li>3 : Analyse NOK</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Contenu à écrire dans stdout / stderr</dt>
<dd><ul class="first last">
<li>stdout : Nom des virus trouvés, un par ligne ; Si échec (code 3) : raison de l’échec</li>
<li>stderr : Log «&nbsp;brut&nbsp;» de l’antivirus</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="admonition caution">
<p class="first admonition-title">Prudence</p>
<p class="last">En cas de remplacement de clamAV par un autre antivirus, l’installation de celui-ci devient dès lors un prérequis de l’installation et le script doit être testé.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Avertissement</p>
<p class="last">Sur plate-forme Debian, ClamAV est installé sans base de données. Pour que l’antivirus soit fonctionnel, il est nécessaire, durant l’installation, de la télécharger ; il est donc nécessaire de renseigner dans l’inventaire la directive <code class="docutils literal notranslate"><span class="pre">http_proxy_environnement</span></code>.</p>
</div>
</div>
<div class="section" id="parametrage-des-certificats-externes-externe">
<h2>4.2.4.4. Paramétrage des certificats externes (*-externe)<a class="headerlink" href="#parametrage-des-certificats-externes-externe" title="Lien permanent vers ce titre">¶</a></h2>
<p>Se reporter au chapitre dédié à la gestion des certificats: <a class="reference internal" href="20-certificats.html"><span class="doc">Gestion des certificats</span></a></p>
</div>
<div class="section" id="placer-hors-vitam-le-composant-ihm-demo">
<h2>4.2.4.5. Placer «&nbsp;hors Vitam&nbsp;» le composant ihm-demo<a class="headerlink" href="#placer-hors-vitam-le-composant-ihm-demo" title="Lien permanent vers ce titre">¶</a></h2>
<p>Sous <code class="docutils literal notranslate"><span class="pre">deployment/environments/host_vars</span></code>, créer ou éditer un fichier nommé par le nom de machine hébergeant le composant ihm-demo et ajouter le contenu ci-dessous</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">consul_disabled</span><span class="p">:</span> <span class="n">true</span>
</pre></div>
</div>
<p>A l’issue, le déploiement n’installera pas l’agent Consul. Le composant ihm-demo appellera, alors, par l’adresse IP de services les composants «&nbsp;access-external&nbsp;» et «&nbsp;ingest-external&nbsp;».</p>
<p>Il est également fortement recommandé de positionner la valeur de la directive <code class="docutils literal notranslate"><span class="pre">vitam.ihm_demo.metrics_enabled</span></code> à  <code class="docutils literal notranslate"><span class="pre">false</span></code> dans le fichier <code class="docutils literal notranslate"><span class="pre">deployment/environments/group_vars/all/vitam_vars.yml</span></code>, afin que ce composant ne tente pas d’envoyer de données sur «&nbsp;elasticsearch-log&nbsp;».</p>
</div>
<div class="section" id="parametrage-de-la-centralisation-des-logs-vitam">
<h2>4.2.4.6. Paramétrage de la centralisation des logs Vitam<a class="headerlink" href="#parametrage-de-la-centralisation-des-logs-vitam" title="Lien permanent vers ce titre">¶</a></h2>
<p>2 cas sont possibles :</p>
<ul class="simple">
<li>Utiliser le sous-système de gestion des logs fournis par la solution logicielle VITAM ;</li>
<li>Utiliser un SIEM tiers.</li>
</ul>
<div class="section" id="gestion-par-vitam">
<h3>4.2.4.6.1. Gestion par Vitam<a class="headerlink" href="#gestion-par-vitam" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="docutils">
<dt>Pour une gestion des logs par Vitam, il est nécessaire de déclarer les serveurs ad-hoc dans le fichier d’inventaire pour les 3 groupes suivants:</dt>
<dd><ul class="first last simple">
<li>hosts-logstash</li>
<li>hosts-kibana-log</li>
<li>hosts-elasticsearch-log</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="redirection-des-logs-sur-un-siem-tiers">
<h3>4.2.4.6.2. Redirection des logs sur un SIEM tiers<a class="headerlink" href="#redirection-des-logs-sur-un-siem-tiers" title="Lien permanent vers ce titre">¶</a></h3>
<p>En configuration par défaut, les logs Vitam sont tout d’abord routés vers un serveur rsyslog installé sur chaque machine.
Il est possible d’en modifier le routage, qui par défaut redirige vers le serveur logstash via le protocole syslog en TCP.</p>
<p>Pour cela, il est nécessaire de placer un fichier de configuration dédié dans le dossier <code class="docutils literal notranslate"><span class="pre">/etc/rsyslog.d/</span></code> ; ce fichier sera automatiquement pris en compte par rsyslog. Pour la syntaxe de ce fichier de configuration rsyslog, se référer à la <a class="reference external" href="http://www.rsyslog.com/doc/v7-stable/">documentation rsyslog</a>.</p>
<div class="admonition tip">
<p class="first admonition-title">Astuce</p>
<p class="last">Pour cela, il peut être utile de s’inspirer du fichier de référence VITAM <code class="docutils literal notranslate"><span class="pre">deployment/ansible-vitam/roles/rsyslog/templates/vitam_transport.conf.j2</span></code> (attention, il s’agit d’un fichier template ansible, non directement convertible en fichier de configuration sans en ôter les directives jinja2).</p>
</div>
</div>
</div>
<div class="section" id="fichiers-complementaires">
<h2>4.2.4.7. Fichiers complémentaires<a class="headerlink" href="#fichiers-complementaires" title="Lien permanent vers ce titre">¶</a></h2>
<p>A titre informatif, le positionnement des variables ainsi que des dérivations des déclarations de variables sont effectuées dans les fichiers suivants :</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">environments</span></code> <code class="docutils literal notranslate"><span class="pre">/group_vars/all/vitam_vars.yml</span></code>, comme suit :</p>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="c1">### global ###</span>

<span class="c1"># TODO MAYBE : permettre la surcharge avec une syntax du genre vitamopts.folder_root | default(vitam_default.folder_root) dans les templates ?</span>
<span class="nt">droid_filename</span><span class="p">:</span> <span class="s">&quot;DROID_SignatureFile_V94.xml&quot;</span>
<span class="nt">droid_container_filename</span><span class="p">:</span> <span class="s">&quot;container-signature-20180917.xml&quot;</span>

<span class="nt">vitam_defaults</span><span class="p">:</span>
    <span class="nt">folder</span><span class="p">:</span>
        <span class="nt">root_path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/vitam</span>
        <span class="nt">folder_permission</span><span class="p">:</span> <span class="s">&quot;0750&quot;</span>
        <span class="nt">conf_permission</span><span class="p">:</span> <span class="s">&quot;0640&quot;</span>
        <span class="nt">folder_upload_permission</span><span class="p">:</span> <span class="s">&quot;0770&quot;</span>
        <span class="nt">script_permission</span><span class="p">:</span> <span class="s">&quot;0750&quot;</span>
    <span class="nt">users</span><span class="p">:</span>
        <span class="nt">vitam</span><span class="p">:</span> <span class="s">&quot;vitam&quot;</span>
        <span class="nt">vitamdb</span><span class="p">:</span> <span class="s">&quot;vitamdb&quot;</span>
        <span class="nt">group</span><span class="p">:</span> <span class="s">&quot;vitam&quot;</span>
    <span class="nt">services</span><span class="p">:</span>
        <span class="c1"># Default log level for vitam components: logback values (TRACE, DEBUG, INFO, WARN, ERROR, OFF)</span>
        <span class="nt">log_level</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">WARN</span>
        <span class="nt">start_timeout</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">300</span>
        <span class="nt">stop_timeout</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3600</span>
        <span class="nt">port_service_timeout</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">86400</span>
        <span class="nt">api_call_timeout</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">120</span>
    <span class="c1"># Filter for the vitam package version to install</span>
    <span class="c1"># FIXME : commented as has to be removed becuase doesn&#39;t work under Debain</span>
    <span class="c1">#package_version: &quot;*&quot;</span>
    <span class="c1">### Trust X-SSL-CLIENT-CERT header for external api auth ? (true | false) ###</span>
    <span class="nt">vitam_ssl_user_header</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="c1">### Force chunk mode : set true if chunk header should be checked</span>
    <span class="nt">vitam_force_chunk_mode</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="c1"># syslog_facility</span>
    <span class="nt">syslog_facility</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">local0</span>

<span class="c1"># Used in ingest, unitary update, mass-update</span>
<span class="nt">classificationList</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;Non</span><span class="nv"> </span><span class="s">protégé&quot;</span><span class="p p-Indicator">,</span><span class="s">&quot;Secret</span><span class="nv"> </span><span class="s">Défense&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;Confidentiel</span><span class="nv"> </span><span class="s">Défense&quot;</span><span class="p p-Indicator">]</span>
<span class="c1"># Used in ingest, unitary update, mass-update</span>
<span class="nt">classificationLevelOptional</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>


<span class="c1">### consul ###</span>
<span class="c1"># FIXME: Consul à la racine pour le moment à cause de problèmes de récursivité dans le parsing yaml</span>
<span class="c1"># WARNING: consul_domain should be a supported domain name for your organization</span>
<span class="c1">#          You will have to generate server certificates with the same domain name and the service subdomain name</span>
<span class="c1">#          Example: consul_domain=vitam means you will have to generate some certificates with .service.vitam domain</span>
<span class="c1">#                   access-external.service.vitam, ingest-external.service.vitam, ...</span>
<span class="nt">consul_domain</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">consul</span>
<span class="nt">consul_component</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">consul</span>
<span class="nt">consul_folder_conf</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">vitam_defaults.folder.root_path</span><span class="nv"> </span><span class="s">}}/conf/{{</span><span class="nv"> </span><span class="s">consul_component</span><span class="nv"> </span><span class="s">}}&quot;</span>

<span class="c1"># Workspace should be useless but storage have a dependency to it...</span>
<span class="c1"># elastic-kibana-interceptor is present as kibana is present, if kibana-data &amp; interceptor are not needed in the secondary site, just do not add them in the hosts file</span>
<span class="nt">vitam_secondary_site_components</span><span class="p">:</span> <span class="p p-Indicator">[</span> <span class="s">&quot;logbook&quot;</span> <span class="p p-Indicator">,</span> <span class="s">&quot;metadata&quot;</span> <span class="p p-Indicator">,</span> <span class="s">&quot;functional-administration&quot;</span> <span class="p p-Indicator">,</span> <span class="s">&quot;storage&quot;</span> <span class="p p-Indicator">,</span> <span class="s">&quot;storageofferdefault&quot;</span> <span class="p p-Indicator">,</span> <span class="s">&quot;offer&quot;</span> <span class="p p-Indicator">,</span> <span class="s">&quot;elasticsearch-log&quot;</span> <span class="p p-Indicator">,</span> <span class="s">&quot;elasticsearch-data&quot;</span> <span class="p p-Indicator">,</span> <span class="s">&quot;logstash&quot;</span> <span class="p p-Indicator">,</span> <span class="s">&quot;kibana&quot;</span> <span class="p p-Indicator">,</span> <span class="s">&quot;mongoc&quot;</span> <span class="p p-Indicator">,</span> <span class="s">&quot;mongod&quot;</span> <span class="p p-Indicator">,</span> <span class="s">&quot;mongos&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;elastic-kibana-interceptor&quot;</span> <span class="p p-Indicator">]</span>

<span class="c1"># Vitams griffins required to launch preservation scenario</span>
<span class="nt">vitam_griffins</span><span class="p">:</span> <span class="p p-Indicator">[]</span>

<span class="c1">### Composants Vitam ###</span>

<span class="nt">vitam</span><span class="p">:</span>
    <span class="nt">accessexternal</span><span class="p">:</span>
        <span class="c1"># Component name: do not modify</span>
        <span class="nt">vitam_component</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">access-external</span>
        <span class="c1"># DNS record for the service:</span>
        <span class="c1"># Modify if ihm-demo is not using consul (typical production deployment)</span>
        <span class="nt">host</span><span class="p">:</span> <span class="s">&quot;access-external.service.{{</span><span class="nv"> </span><span class="s">consul_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">port_admin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">28102</span>
        <span class="nt">port_service</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8444</span>
        <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;access-external&quot;</span>
        <span class="nt">https_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="c1"># Use platform secret for this component ? : do not modify</span>
        <span class="nt">secret_platform</span><span class="p">:</span> <span class="s">&quot;false&quot;</span>
        <span class="c1"># Force the log level for this component: this are logback values (TRACE, DEBUG, INFO, WARN, ERROR, OFF)</span>
        <span class="c1"># If this var is not set, the default one will be used (vitam_defaults.services.log_level)</span>
        <span class="c1"># log_level: &quot;DEBUG&quot;</span>
        <span class="nt">metrics_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_rolling_policy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_max_file_size</span><span class="p">:</span> <span class="s">&quot;10MB&quot;</span>
        <span class="nt">logback_total_size_cap</span><span class="p">:</span> <span class="s">&quot;5GB&quot;</span>
        <span class="nt">jvm_log</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">accessinternal</span><span class="p">:</span>
        <span class="nt">vitam_component</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">access-internal</span>
        <span class="nt">host</span><span class="p">:</span> <span class="s">&quot;access-internal.service.{{</span><span class="nv"> </span><span class="s">consul_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">port_service</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8101</span>
        <span class="nt">port_admin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">28101</span>
        <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;access-internal&quot;</span>
        <span class="nt">https_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="nt">secret_platform</span><span class="p">:</span> <span class="s">&quot;true&quot;</span>
        <span class="c1"># log_level: &quot;DEBUG&quot;</span>
        <span class="nt">metrics_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_rolling_policy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_max_file_size</span><span class="p">:</span> <span class="s">&quot;10MB&quot;</span>
        <span class="nt">logback_total_size_cap</span><span class="p">:</span> <span class="s">&quot;5GB&quot;</span>
        <span class="nt">jvm_log</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">functional_administration</span><span class="p">:</span>
        <span class="nt">vitam_component</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">functional-administration</span>
        <span class="nt">host</span><span class="p">:</span> <span class="s">&quot;functional-administration.service.{{</span><span class="nv"> </span><span class="s">consul_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">port_service</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8004</span>
        <span class="nt">port_admin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">18004</span>
        <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;functional-administration&quot;</span>
        <span class="nt">https_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="nt">secret_platform</span><span class="p">:</span> <span class="s">&quot;true&quot;</span>
        <span class="nt">cluster_name</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">elasticsearch.data.cluster_name</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="c1"># log_level: &quot;DEBUG&quot;</span>
        <span class="nt">metrics_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_rolling_policy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_max_file_size</span><span class="p">:</span> <span class="s">&quot;10MB&quot;</span>
        <span class="nt">logback_total_size_cap</span><span class="p">:</span> <span class="s">&quot;5GB&quot;</span>
        <span class="nt">jvm_log</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">elastickibanainterceptor</span><span class="p">:</span>
        <span class="nt">vitam_component</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">elastic-kibana-interceptor</span>
        <span class="nt">host</span><span class="p">:</span> <span class="s">&quot;elastic-kibana-interceptor.service.{{</span><span class="nv"> </span><span class="s">consul_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">port_service</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8014</span>
        <span class="nt">port_admin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">18014</span>
        <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;&quot;</span>
        <span class="nt">https_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="nt">secret_platform</span><span class="p">:</span> <span class="s">&quot;false&quot;</span>
        <span class="nt">cluster_name</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">elasticsearch.data.cluster_name</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="c1"># log_level: &quot;DEBUG&quot;</span>
        <span class="nt">metrics_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_rolling_policy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_max_file_size</span><span class="p">:</span> <span class="s">&quot;10MB&quot;</span>
        <span class="nt">logback_total_size_cap</span><span class="p">:</span> <span class="s">&quot;5GB&quot;</span>
        <span class="nt">jvm_log</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">batchreport</span><span class="p">:</span>
        <span class="nt">vitam_component</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">batch-report</span>
        <span class="nt">host</span><span class="p">:</span> <span class="s">&quot;batch-report.service.{{</span><span class="nv"> </span><span class="s">consul_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">port_service</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8015</span>
        <span class="nt">port_admin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">18015</span>
        <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;batch-report&quot;</span>
        <span class="nt">https_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="nt">secret_platform</span><span class="p">:</span> <span class="s">&quot;false&quot;</span>
        <span class="c1"># log_level: &quot;DEBUG&quot;</span>
        <span class="nt">metrics_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_rolling_policy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_max_file_size</span><span class="p">:</span> <span class="s">&quot;10MB&quot;</span>
        <span class="nt">logback_total_size_cap</span><span class="p">:</span> <span class="s">&quot;5GB&quot;</span>
        <span class="nt">jvm_log</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">ingestexternal</span><span class="p">:</span>
        <span class="nt">vitam_component</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ingest-external</span>
        <span class="c1"># DNS record for the service:</span>
        <span class="c1"># Modify if ihm-demo is not using consul (typical production deployment)</span>
        <span class="nt">host</span><span class="p">:</span> <span class="s">&quot;ingest-external.service.{{</span><span class="nv"> </span><span class="s">consul_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">port_admin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">28001</span>
        <span class="nt">port_service</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8443</span>
        <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;ingest-external&quot;</span>
        <span class="nt">https_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">secret_platform</span><span class="p">:</span> <span class="s">&quot;false&quot;</span>
        <span class="nt">antivirus</span><span class="p">:</span> <span class="s">&quot;clamav&quot;</span>
        <span class="c1"># Directory where files should be placed for local ingest</span>
        <span class="nt">upload_dir</span><span class="p">:</span> <span class="s">&quot;/vitam/data/ingest-external/upload&quot;</span>
        <span class="c1"># Directory where successful ingested files will be moved to</span>
        <span class="nt">success_dir</span><span class="p">:</span> <span class="s">&quot;/vitam/data/ingest-external/upload/success&quot;</span>
        <span class="c1"># Directory where failed ingested files will be moved to</span>
        <span class="nt">fail_dir</span><span class="p">:</span> <span class="s">&quot;/vitam/data/ingest-external/upload/failure&quot;</span>
        <span class="c1"># Action done to file after local ingest (see below for further information)</span>
        <span class="nt">upload_final_action</span><span class="p">:</span> <span class="s">&quot;MOVE&quot;</span>
        <span class="c1"># log_level: &quot;DEBUG&quot;</span>
        <span class="c1"># upload_final_action can be set to three different values (lower or upper case does not matter)</span>
        <span class="c1">#   MOVE : After upload, the local file will be moved to either success_dir or fail_dir depending on the status of the ingest towards ingest-internal</span>
        <span class="c1">#   DELETE : After upload, the local file will be deleted if the upload succeeded</span>
        <span class="c1">#   NONE : After upload, nothing will be done to the local file (default option set if the value entered for upload_final_action does not exist)</span>
        <span class="nt">metrics_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_rolling_policy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_max_file_size</span><span class="p">:</span> <span class="s">&quot;10MB&quot;</span>
        <span class="nt">logback_total_size_cap</span><span class="p">:</span> <span class="s">&quot;5GB&quot;</span>
        <span class="nt">jvm_log</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">ingestinternal</span><span class="p">:</span>
        <span class="nt">vitam_component</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ingest-internal</span>
        <span class="nt">host</span><span class="p">:</span> <span class="s">&quot;ingest-internal.service.{{</span><span class="nv"> </span><span class="s">consul_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">port_service</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8100</span>
        <span class="nt">port_admin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">28100</span>
        <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;ingest-internal&quot;</span>
        <span class="nt">https_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="nt">secret_platform</span><span class="p">:</span> <span class="s">&quot;true&quot;</span>
        <span class="c1"># log_level: &quot;DEBUG&quot;</span>
        <span class="nt">metrics_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_rolling_policy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_max_file_size</span><span class="p">:</span> <span class="s">&quot;10MB&quot;</span>
        <span class="nt">logback_total_size_cap</span><span class="p">:</span> <span class="s">&quot;5GB&quot;</span>
        <span class="nt">jvm_log</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">ihm_demo</span><span class="p">:</span>
        <span class="nt">vitam_component</span><span class="p">:</span> <span class="s">&quot;ihm-demo&quot;</span>
        <span class="nt">host</span><span class="p">:</span> <span class="s">&quot;ihm-demo.service.{{</span><span class="nv"> </span><span class="s">consul_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">port_service</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8002</span>
        <span class="nt">port_admin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">28002</span>
        <span class="nt">baseurl</span><span class="p">:</span> <span class="s">&quot;/ihm-demo&quot;</span>
        <span class="nt">static_content</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">vitam_defaults.folder.root_path</span><span class="nv"> </span><span class="s">}}/app/ihm-demo/v2&quot;</span>
        <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;ihm-demo&quot;</span>
        <span class="nt">https_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="nt">secret_platform</span><span class="p">:</span> <span class="s">&quot;false&quot;</span>
        <span class="c1"># User session timeout in milliseconds (for shiro)</span>
        <span class="nt">session_timeout</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1800000</span>
        <span class="nt">secure_cookie</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="c1"># Specify here the realms you want to use for authentication in ihm-demo</span>
        <span class="c1"># You can set multiple realms, one per line</span>
        <span class="c1"># With multiple realms, the user will be able to choose between the allowed realms</span>
        <span class="c1"># Example: authentication_realms:</span>
        <span class="c1">#               - x509Realm</span>
        <span class="c1">#               - ldapRealm</span>
        <span class="c1"># Authorized values:</span>
        <span class="c1"># x509Realm: certificate</span>
        <span class="c1"># iniRealm: ini file</span>
        <span class="c1"># ldapRealm: ldap</span>
        <span class="nt">authentication_realms</span><span class="p">:</span>
            <span class="c1"># - x509Realm</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">iniRealm</span>
            <span class="c1"># - ldapRealm</span>
        <span class="c1"># log_level: &quot;DEBUG&quot;</span>
        <span class="nt">metrics_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_rolling_policy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_max_file_size</span><span class="p">:</span> <span class="s">&quot;10MB&quot;</span>
        <span class="nt">logback_total_size_cap</span><span class="p">:</span> <span class="s">&quot;5GB&quot;</span>
        <span class="nt">jvm_log</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">logbook</span><span class="p">:</span>
        <span class="nt">vitam_component</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">logbook</span>
        <span class="nt">host</span><span class="p">:</span> <span class="s">&quot;logbook.service.{{</span><span class="nv"> </span><span class="s">consul_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">port_service</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">9002</span>
        <span class="nt">port_admin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">29002</span>
        <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;logbook&quot;</span>
        <span class="nt">https_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="nt">secret_platform</span><span class="p">:</span> <span class="s">&quot;true&quot;</span>
        <span class="nt">cluster_name</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">elasticsearch.data.cluster_name</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="c1"># Temporization delay (in seconds) for recent logbook operation events.</span>
        <span class="c1"># Set it to a reasonable delay to cover max clock difference across servers + VM/GC pauses</span>
        <span class="nt">operationTraceabilityTemporizationDelay</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">300</span>
        <span class="c1"># Temporization delay (in seconds) for recent logbook lifecycle events.</span>
        <span class="c1"># Set it to a reasonable delay to cover max clock difference across servers + VM/GC pauses</span>
        <span class="nt">lifecycleTraceabilityTemporizationDelay</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">300</span>
        <span class="c1"># Max entries selected per (Unit or Object Group) LFC traceability operation</span>
        <span class="nt">lifecycleTraceabilityMaxEntries</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100000</span>
        <span class="c1"># log_level: &quot;DEBUG&quot;</span>
        <span class="nt">metrics_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_rolling_policy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_max_file_size</span><span class="p">:</span> <span class="s">&quot;10MB&quot;</span>
        <span class="nt">logback_total_size_cap</span><span class="p">:</span> <span class="s">&quot;5GB&quot;</span>
        <span class="nt">jvm_log</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">metadata</span><span class="p">:</span>
        <span class="nt">vitam_component</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">metadata</span>
        <span class="nt">host</span><span class="p">:</span> <span class="s">&quot;metadata.service.{{</span><span class="nv"> </span><span class="s">consul_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">port_service</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8200</span>
        <span class="nt">port_admin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">28200</span>
        <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;metadata&quot;</span>
        <span class="nt">https_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="nt">secret_platform</span><span class="p">:</span> <span class="s">&quot;true&quot;</span>
        <span class="nt">cluster_name</span><span class="p">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">elasticsearch.data.cluster_name</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="c1"># log_level: &quot;DEBUG&quot;</span>
        <span class="nt">metrics_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_rolling_policy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_max_file_size</span><span class="p">:</span> <span class="s">&quot;10MB&quot;</span>
        <span class="nt">logback_total_size_cap</span><span class="p">:</span> <span class="s">&quot;5GB&quot;</span>
        <span class="nt">jvm_log</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">processing</span><span class="p">:</span>
        <span class="nt">vitam_component</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">processing</span>
        <span class="nt">host</span><span class="p">:</span> <span class="s">&quot;processing.service.{{</span><span class="nv"> </span><span class="s">consul_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">port_service</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8203</span>
        <span class="nt">port_admin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">28203</span>
        <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;processing&quot;</span>
        <span class="nt">https_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="nt">secret_platform</span><span class="p">:</span> <span class="s">&quot;true&quot;</span>
        <span class="c1"># log_level: &quot;DEBUG&quot;</span>
        <span class="nt">metrics_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_rolling_policy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_max_file_size</span><span class="p">:</span> <span class="s">&quot;10MB&quot;</span>
        <span class="nt">logback_total_size_cap</span><span class="p">:</span> <span class="s">&quot;5GB&quot;</span>
        <span class="nt">jvm_log</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">security_internal</span><span class="p">:</span>
        <span class="nt">vitam_component</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">security-internal</span>
        <span class="nt">host</span><span class="p">:</span> <span class="s">&quot;security-internal.service.{{</span><span class="nv"> </span><span class="s">consul_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">port_service</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8005</span>
        <span class="nt">port_admin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">28005</span>
        <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;security-internal&quot;</span>
        <span class="nt">https_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="nt">secret_platform</span><span class="p">:</span> <span class="s">&quot;true&quot;</span>
        <span class="c1"># log_level: &quot;DEBUG&quot;</span>
        <span class="nt">metrics_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_rolling_policy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_max_file_size</span><span class="p">:</span> <span class="s">&quot;10MB&quot;</span>
        <span class="nt">logback_total_size_cap</span><span class="p">:</span> <span class="s">&quot;5GB&quot;</span>
        <span class="nt">jvm_log</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">storageengine</span><span class="p">:</span>
        <span class="nt">vitam_component</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">storage</span>
        <span class="nt">host</span><span class="p">:</span> <span class="s">&quot;storage.service.{{</span><span class="nv"> </span><span class="s">consul_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">port_service</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">9102</span>
        <span class="nt">port_admin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">29102</span>
        <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;storage-engine&quot;</span>
        <span class="nt">https_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="nt">secret_platform</span><span class="p">:</span> <span class="s">&quot;true&quot;</span>
        <span class="nt">storageTraceabilityOverlapDelay</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">300</span>
        <span class="nt">restoreBulkSize</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1000</span>
        <span class="c1"># batch thread pool size</span>
        <span class="nt">minBatchThreadPoolSize</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">4</span>
        <span class="nt">maxBatchThreadPoolSize</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">16</span>
        <span class="c1"># Digest computation timeout in seconds</span>
        <span class="nt">batchDigestComputationTimeout</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">300</span>
        <span class="c1"># Offer synchronization batch size &amp; thread pool size</span>
        <span class="nt">offerSynchronizationBulkSize</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1000</span>
        <span class="nt">offerSyncThreadPoolSize</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">32</span>
        <span class="c1"># log_level: &quot;DEBUG&quot;</span>
        <span class="nt">metrics_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_rolling_policy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_max_file_size</span><span class="p">:</span> <span class="s">&quot;10MB&quot;</span>
        <span class="nt">logback_total_size_cap</span><span class="p">:</span> <span class="s">&quot;5GB&quot;</span>
        <span class="nt">jvm_log</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">storageofferdefault</span><span class="p">:</span>
        <span class="nt">vitam_component</span><span class="p">:</span> <span class="s">&quot;offer&quot;</span>
        <span class="nt">port_service</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">9900</span>
        <span class="nt">port_admin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">29900</span>
        <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;storage-offer-default&quot;</span>
        <span class="nt">https_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="nt">secret_platform</span><span class="p">:</span> <span class="s">&quot;true&quot;</span>
        <span class="c1"># log_level: &quot;DEBUG&quot;</span>
        <span class="nt">metrics_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_rolling_policy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_max_file_size</span><span class="p">:</span> <span class="s">&quot;10MB&quot;</span>
        <span class="nt">logback_total_size_cap</span><span class="p">:</span> <span class="s">&quot;5GB&quot;</span>
        <span class="nt">jvm_log</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">worker</span><span class="p">:</span>
        <span class="nt">vitam_component</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">worker</span>
        <span class="nt">port_service</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">9104</span>
        <span class="nt">port_admin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">29104</span>
        <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;worker&quot;</span>
        <span class="nt">https_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="nt">secret_platform</span><span class="p">:</span> <span class="s">&quot;true&quot;</span>
        <span class="c1"># log_level: &quot;DEBUG&quot;</span>
        <span class="nt">metrics_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_rolling_policy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_max_file_size</span><span class="p">:</span> <span class="s">&quot;10MB&quot;</span>
        <span class="nt">logback_total_size_cap</span><span class="p">:</span> <span class="s">&quot;5GB&quot;</span>
        <span class="nt">jvm_log</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">workspace</span><span class="p">:</span>
        <span class="nt">vitam_component</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">workspace</span>
        <span class="nt">host</span><span class="p">:</span> <span class="s">&quot;workspace.service.{{</span><span class="nv"> </span><span class="s">consul_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">port_service</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8201</span>
        <span class="nt">port_admin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">28201</span>
        <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;workspace&quot;</span>
        <span class="nt">https_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="nt">secret_platform</span><span class="p">:</span> <span class="s">&quot;true&quot;</span>
        <span class="c1"># log_level: &quot;DEBUG&quot;</span>
        <span class="nt">metrics_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_rolling_policy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="nt">logback_max_file_size</span><span class="p">:</span> <span class="s">&quot;10MB&quot;</span>
        <span class="nt">logback_total_size_cap</span><span class="p">:</span> <span class="s">&quot;5GB&quot;</span>
        <span class="nt">jvm_log</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</td></tr></table></div>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Cas du composant ingest-external. Les directives <code class="docutils literal notranslate"><span class="pre">upload_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">success_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">fail_dir</span></code> et <code class="docutils literal notranslate"><span class="pre">upload_final_action</span></code> permettent de prendre en charge (ingest) des fichiers déposés dans <code class="docutils literal notranslate"><span class="pre">upload_dir</span></code> et appliquer une règle <code class="docutils literal notranslate"><span class="pre">upload_final_action</span></code> à l’issue du traitement (NONE, DELETE ou MOVE dans <code class="docutils literal notranslate"><span class="pre">success_dir</span></code> ou <code class="docutils literal notranslate"><span class="pre">fail_dir</span></code> selon le cas). Se référer au <a class="reference internal" href="../introduction.html#term-dex"><span class="xref std std-term">DEX</span></a> pour de plus amples détails. Se référer au manuel de développement pour plus de détails sur l’appel à ce cas.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Avertissement</p>
<p class="last">Selon les informations apportées par le métier, redéfinir les valeurs associées dans les directives <code class="docutils literal notranslate"><span class="pre">classificationList</span></code> et <code class="docutils literal notranslate"><span class="pre">classificationLevelOptional</span></code>. Cela permet de définir quels niveaux de protection du secret de la défense nationale supporte l’instance. Attention : une instance de niveau supérieur doit toujours supporter les niveaux inférieurs</p>
</div>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">environments</span></code> <code class="docutils literal notranslate"><span class="pre">/group_vars/all/cots_vars.yml</span></code>, comme suit :</p>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nn">---</span>

<span class="nt">consul</span><span class="p">:</span>
    <span class="nt">dns_port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">53</span>

<span class="nt">consul_remote_sites</span><span class="p">:</span>
    <span class="c1"># wan contains the wan addresses of the consul server instances of the external vitam sites</span>
    <span class="c1"># Exemple, if our local dc is dc1, we will need to set dc2 &amp; dc3 wan conf:</span>
    <span class="c1"># - dc2:</span>
    <span class="c1">#   wan: [&quot;10.10.10.10&quot;,&quot;1.1.1.1&quot;]</span>
    <span class="c1"># - dc3:</span>
    <span class="c1">#   wan: [&quot;10.10.10.11&quot;,&quot;1.1.1.1&quot;]</span>

<span class="nt">elasticsearch</span><span class="p">:</span>
    <span class="nt">log</span><span class="p">:</span>
        <span class="nt">host</span><span class="p">:</span> <span class="s">&quot;elasticsearch-log.service.{{</span><span class="nv"> </span><span class="s">consul_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="nt">port_http</span><span class="p">:</span> <span class="s">&quot;9201&quot;</span>
        <span class="nt">port_tcp</span><span class="p">:</span> <span class="s">&quot;9301&quot;</span>
        <span class="nt">groupe</span><span class="p">:</span> <span class="s">&quot;log&quot;</span>
        <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;elasticsearch-log&quot;</span>
        <span class="nt">cluster_name</span><span class="p">:</span> <span class="s">&quot;elasticsearch-log&quot;</span>
        <span class="nt">https_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="c1"># default index template</span>
        <span class="nt">index_templates</span><span class="p">:</span>
            <span class="nt">default</span><span class="p">:</span>
                <span class="nt">shards</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
                <span class="nt">replica</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class="nt">data</span><span class="p">:</span>
        <span class="nt">host</span><span class="p">:</span> <span class="s">&quot;elasticsearch-data.service.{{</span><span class="nv"> </span><span class="s">consul_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
        <span class="c1"># default is 0.1 (10%) and should be quite enough in most cases</span>
        <span class="c1">#index_buffer_size_ratio: &quot;0.15&quot;</span>
        <span class="nt">port_http</span><span class="p">:</span> <span class="s">&quot;9200&quot;</span>
        <span class="nt">port_tcp</span><span class="p">:</span> <span class="s">&quot;9300&quot;</span>
        <span class="nt">groupe</span><span class="p">:</span> <span class="s">&quot;data&quot;</span>
        <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;elasticsearch-data&quot;</span>
        <span class="nt">cluster_name</span><span class="p">:</span> <span class="s">&quot;elasticsearch-data&quot;</span>
        <span class="nt">https_enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="c1"># default index template</span>
        <span class="nt">index_templates</span><span class="p">:</span>
            <span class="nt">default</span><span class="p">:</span>
                <span class="nt">shards</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
                <span class="nt">replica</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2</span>

<span class="nt">mongodb</span><span class="p">:</span>
    <span class="nt">mongos_port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">27017</span>
    <span class="nt">mongoc_port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">27018</span>
    <span class="nt">mongod_port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">27019</span>
    <span class="nt">mongo_authentication</span><span class="p">:</span> <span class="s">&quot;true&quot;</span>
    <span class="nt">host</span><span class="p">:</span> <span class="s">&quot;mongos.service.{{</span><span class="nv"> </span><span class="s">consul_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>

<span class="nt">logstash</span><span class="p">:</span>
    <span class="nt">host</span><span class="p">:</span> <span class="s">&quot;logstash.service.{{</span><span class="nv"> </span><span class="s">consul_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
    <span class="nt">user</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">logstash</span>
    <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10514</span>
    <span class="nt">rest_port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">20514</span>

<span class="c1"># Curator units: days</span>
<span class="nt">curator</span><span class="p">:</span>
    <span class="nt">log</span><span class="p">:</span>
        <span class="nt">metrics</span><span class="p">:</span>
            <span class="nt">close</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
            <span class="nt">delete</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">30</span>
        <span class="nt">logstash</span><span class="p">:</span>
            <span class="nt">close</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
            <span class="nt">delete</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">30</span>
        <span class="nt">metricbeat</span><span class="p">:</span>
            <span class="nt">close</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
            <span class="nt">delete</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">30</span>
        <span class="nt">packetbeat</span><span class="p">:</span>
            <span class="nt">close</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
            <span class="nt">delete</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">30</span>

<span class="nt">kibana</span><span class="p">:</span>
    <span class="nt">header_value</span><span class="p">:</span> <span class="s">&quot;reporting&quot;</span>
    <span class="nt">import_delay</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
    <span class="nt">import_retries</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
    <span class="nt">log</span><span class="p">:</span>
        <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;kibana_log&quot;</span>
        <span class="nt">api_call_timeout</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">120</span>
        <span class="nt">groupe</span><span class="p">:</span> <span class="s">&quot;log&quot;</span>
        <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5601</span>
        <span class="nt">default_index_pattern</span><span class="p">:</span> <span class="s">&quot;logstash-vitam*&quot;</span>
        <span class="c1"># default shards &amp; replica</span>
        <span class="nt">shards</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
        <span class="nt">replica</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
        <span class="c1"># pour index logstash-*</span>
        <span class="nt">metrics</span><span class="p">:</span>
            <span class="nt">shards</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
            <span class="nt">replica</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
        <span class="c1"># pour index metrics-vitam-*</span>
        <span class="nt">logs</span><span class="p">:</span>
            <span class="nt">shards</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
            <span class="nt">replica</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
        <span class="c1"># pour index metricbeat-*</span>
        <span class="nt">metricbeat</span><span class="p">:</span>
            <span class="nt">shards</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span> <span class="c1"># must be a factor of 30</span>
            <span class="nt">replica</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class="nt">data</span><span class="p">:</span>
        <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;kibana_data&quot;</span>
        <span class="c1"># OMA : bugdette : api_call_timeout is used for retries ; should ceate a separate variable rather than this one</span>
        <span class="nt">api_call_timeout</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">120</span>
        <span class="nt">groupe</span><span class="p">:</span> <span class="s">&quot;data&quot;</span>
        <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5601</span>
        <span class="nt">default_index_pattern</span><span class="p">:</span> <span class="s">&quot;logbookoperation_*&quot;</span>
        <span class="c1"># index template for .kibana</span>
        <span class="nt">shards</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
        <span class="nt">replica</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>

<span class="nt">syslog</span><span class="p">:</span>
    <span class="c1"># value can be syslog-ng or rsyslog</span>
    <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;rsyslog&quot;</span>

<span class="nt">cerebro</span><span class="p">:</span>
    <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;cerebro&quot;</span>
    <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">9000</span>

<span class="nt">siegfried</span><span class="p">:</span>
    <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">19000</span>

<span class="nt">clamav</span><span class="p">:</span>
    <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3310</span>
    <span class="c1"># frequency freshclam for database update per day (from 0 to 24 - 24 meaning hourly check)</span>
    <span class="nt">db_update_periodicity</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>

<span class="nt">mongo_express</span><span class="p">:</span>
    <span class="nt">baseuri</span><span class="p">:</span> <span class="s">&quot;mongo-express&quot;</span>

<span class="nt">ldap_authentification</span><span class="p">:</span>
    <span class="nt">ldap_protocol</span><span class="p">:</span> <span class="s">&quot;ldap&quot;</span>
    <span class="nt">ldap_server</span><span class="p">:</span> <span class="s">&quot;{%</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">groups[&#39;ldap&#39;]|length</span><span class="nv"> </span><span class="s">&gt;</span><span class="nv"> </span><span class="s">0</span><span class="nv"> </span><span class="s">%}{{</span><span class="nv"> </span><span class="s">groups[&#39;ldap&#39;]|first</span><span class="nv"> </span><span class="s">}}{%</span><span class="nv"> </span><span class="s">endif</span><span class="nv"> </span><span class="s">%}&quot;</span>
    <span class="nt">ldap_port</span><span class="p">:</span> <span class="s">&quot;389&quot;</span>
    <span class="nt">ldap_base</span><span class="p">:</span> <span class="s">&quot;dc=programmevitam,dc=fr&quot;</span>
    <span class="nt">ldap_login</span><span class="p">:</span> <span class="s">&quot;cn=Manager,dc=programmevitam,dc=fr&quot;</span>
    <span class="nt">uid_field</span><span class="p">:</span> <span class="s">&quot;uid&quot;</span>
    <span class="nt">ldap_userDn_Template</span><span class="p">:</span> <span class="s">&quot;uid={0},ou=people,dc=programmevitam,dc=fr&quot;</span>
    <span class="nt">ldap_group_request</span><span class="p">:</span> <span class="s">&quot;(&amp;(objectClass=groupOfNames)(member={0}))&quot;</span>
    <span class="nt">ldap_admin_group</span><span class="p">:</span> <span class="s">&quot;cn=admin,ou=groups,dc=programmevitam,</span><span class="nv"> </span><span class="s">dc=fr&quot;</span>
    <span class="nt">ldap_user_group</span><span class="p">:</span> <span class="s">&quot;cn=user,ou=groups,dc=programmevitam,</span><span class="nv"> </span><span class="s">dc=fr&quot;</span>
    <span class="nt">ldap_guest_group</span><span class="p">:</span> <span class="s">&quot;cn=guest,ou=groups,dc=programmevitam,</span><span class="nv"> </span><span class="s">dc=fr&quot;</span>
</pre></div>
</td></tr></table></div>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">installation multi-sites. Déclarer dans <code class="docutils literal notranslate"><span class="pre">consul_remote_sites</span></code> les datacenters Consul des autres site ; se référer à l’exemple fourni pour renseigner les informations.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Concernant Curator, en environnement de production, il est recommandé de procéder à la fermeture des index au bout d’une semaine pour les index de type «&nbsp;logstash&nbsp;» ( 3 jours pour les index «&nbsp;metrics&nbsp;»), qui sont le reflet des traces applicatives des composants de la solution logicielle <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a>. Il est alors recommandé de lancer le <em>delete</em> de ces index au bout de la durée minimale de rétention : 1 an (il n’y a pas de durée de rétention minimale légale sur les index «&nbsp;metrics&nbsp;», qui ont plus une vocation technique et, éventuellement, d’investigations).</p>
</div>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">environments</span></code> <code class="docutils literal notranslate"><span class="pre">/group_vars/all/jvm_vars.yml</span></code>, comme suit :</p>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nn">---</span>

<span class="nt">vitam</span><span class="p">:</span>
    <span class="nt">accessinternal</span><span class="p">:</span>
        <span class="nt">jvm_opts</span><span class="p">:</span>
            <span class="c1"># memory: &quot;-Xms512m -Xmx512m&quot;</span>
            <span class="c1"># gc: &quot;&quot;</span>
            <span class="c1"># java: &quot;&quot;</span>
    <span class="nt">accessexternal</span><span class="p">:</span>
        <span class="nt">jvm_opts</span><span class="p">:</span>
            <span class="c1"># memory: &quot;-Xms512m -Xmx512m&quot;</span>
            <span class="c1"># gc: &quot;&quot;</span>
            <span class="c1"># java: &quot;&quot;</span>
    <span class="nt">elastickibanainterceptor</span><span class="p">:</span>
        <span class="nt">jvm_opts</span><span class="p">:</span>
            <span class="c1"># memory: &quot;-Xms512m -Xmx512m&quot;</span>
            <span class="c1"># gc: &quot;&quot;</span>
            <span class="c1"># java: &quot;&quot;</span>
    <span class="nt">batchreport</span><span class="p">:</span>
          <span class="nt">jvm_opts</span><span class="p">:</span>
              <span class="c1"># memory: &quot;-Xms512m -Xmx512m&quot;</span>
              <span class="c1"># gc: &quot;&quot;</span>
              <span class="c1"># java: &quot;&quot;</span>
    <span class="nt">ingestinternal</span><span class="p">:</span>
        <span class="nt">jvm_opts</span><span class="p">:</span>
            <span class="c1"># memory: &quot;-Xms512m -Xmx512m&quot;</span>
            <span class="c1"># gc: &quot;&quot;</span>
            <span class="c1"># java: &quot;&quot;</span>
    <span class="nt">ingestexternal</span><span class="p">:</span>
        <span class="nt">jvm_opts</span><span class="p">:</span>
            <span class="c1"># memory: &quot;-Xms512m -Xmx512m&quot;</span>
            <span class="c1"># gc: &quot;&quot;</span>
            <span class="c1"># java: &quot;&quot;</span>
    <span class="nt">metadata</span><span class="p">:</span>
        <span class="nt">jvm_opts</span><span class="p">:</span>
            <span class="c1"># memory: &quot;-Xms512m -Xmx512m&quot;</span>
            <span class="c1"># gc: &quot;&quot;</span>
            <span class="c1"># java: &quot;&quot;</span>
    <span class="nt">ihm_demo</span><span class="p">:</span>
        <span class="nt">jvm_opts</span><span class="p">:</span>
            <span class="c1"># memory: &quot;-Xms512m -Xmx512m&quot;</span>
            <span class="c1"># gc: &quot;&quot;</span>
            <span class="c1"># java: &quot;&quot;</span>
    <span class="nt">ihm_recette</span><span class="p">:</span>
        <span class="nt">jvm_opts</span><span class="p">:</span>
            <span class="c1"># memory: &quot;-Xms512m -Xmx512m&quot;</span>
            <span class="c1"># gc: &quot;&quot;</span>
            <span class="c1"># java: &quot;&quot;</span>
    <span class="nt">logbook</span><span class="p">:</span>
        <span class="nt">jvm_opts</span><span class="p">:</span>
            <span class="c1"># memory: &quot;-Xms512m -Xmx512m&quot;</span>
            <span class="c1"># gc: &quot;&quot;</span>
            <span class="c1"># java: &quot;&quot;</span>
    <span class="nt">workspace</span><span class="p">:</span>
        <span class="nt">jvm_opts</span><span class="p">:</span>
            <span class="c1"># memory: &quot;-Xms512m -Xmx512m&quot;</span>
            <span class="c1"># gc: &quot;&quot;</span>
            <span class="c1"># java: &quot;&quot;</span>
    <span class="nt">processing</span><span class="p">:</span>
        <span class="nt">jvm_opts</span><span class="p">:</span>
            <span class="c1"># memory: &quot;-Xms512m -Xmx512m&quot;</span>
            <span class="c1"># gc: &quot;&quot;</span>
            <span class="c1"># java: &quot;&quot;</span>
    <span class="nt">worker</span><span class="p">:</span>
        <span class="nt">jvm_opts</span><span class="p">:</span>
            <span class="c1"># memory: &quot;-Xms512m -Xmx512m&quot;</span>
            <span class="c1"># gc: &quot;&quot;</span>
            <span class="c1"># java: &quot;&quot;</span>
    <span class="nt">storageengine</span><span class="p">:</span>
        <span class="nt">jvm_opts</span><span class="p">:</span>
            <span class="c1"># memory: &quot;-Xms512m -Xmx512m&quot;</span>
            <span class="c1"># gc: &quot;&quot;</span>
            <span class="c1"># java: &quot;&quot;</span>
    <span class="nt">storageofferdefault</span><span class="p">:</span>
        <span class="nt">jvm_opts</span><span class="p">:</span>
            <span class="c1"># memory: &quot;-Xms512m -Xmx512m&quot;</span>
            <span class="c1"># gc: &quot;&quot;</span>
            <span class="c1"># java: &quot;&quot;</span>
    <span class="nt">functional_administration</span><span class="p">:</span>
        <span class="nt">jvm_opts</span><span class="p">:</span>
            <span class="c1"># memory: &quot;-Xms512m -Xmx512m&quot;</span>
            <span class="c1"># gc: &quot;&quot;</span>
            <span class="c1"># java: &quot;&quot;</span>
    <span class="nt">security_internal</span><span class="p">:</span>
        <span class="nt">jvm_opts</span><span class="p">:</span>
            <span class="c1"># memory: &quot;-Xms512m -Xmx512m&quot;</span>
            <span class="c1"># gc: &quot;&quot;</span>
            <span class="c1"># java: &quot;&quot;</span>
    <span class="nt">library</span><span class="p">:</span>
        <span class="nt">jvm_opts</span><span class="p">:</span>
            <span class="nt">memory</span><span class="p">:</span> <span class="s">&quot;-Xms32m</span><span class="nv"> </span><span class="s">-Xmx128m&quot;</span>
            <span class="c1"># gc: &quot;&quot;</span>
            <span class="c1"># java: &quot;&quot;</span>
</pre></div>
</td></tr></table></div>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Cette configuration est appliquée à la solution logicielle <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a>  ; il est possible de créer un tuning par «&nbsp;groupe&nbsp;» défini dans ansible.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="30-installation.html" class="btn btn-neutral float-right" title="4.2.5. Procédure de première installation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="certificats/keystores.html" class="btn btn-neutral" title="4.2.3.4. Génération des magasins de certificats" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Ce document est distribué sous les termes de la Licence Ouverte V2.0

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'2.1.1',
              LANGUAGE:'fr',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
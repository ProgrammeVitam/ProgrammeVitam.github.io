<!DOCTYPE html>
<html class="writer-html4" lang="fr" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>5.7. Interruption / maintenance &mdash; Documentation VITAM - Documentation d&#39;exploitation 6.1</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="5.8. Sauvegarde / restauration" href="16-backup_restore.html" />
    <link rel="prev" title="5.6. Déploiement / mises à jour" href="14-miseajour.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            VITAM - Documentation d'exploitation
              <img src="../_static/logo_vitam.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                6.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html#rappels">2. Rappels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prerequis-competences.html">3. Expertises requises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">4. Architecture de la solution logicielle VITAM</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="_toc.html">5. Exploitation globale</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="10-accessgrants.html">5.1. Gestion des accès</a></li>
<li class="toctree-l2"><a class="reference internal" href="100-auditDataConsistency.html">5.2. Audit de cohérence de données entre MongoDb et Elasticsearch</a></li>
<li class="toctree-l2"><a class="reference internal" href="101-objectGroup-blackList-fields-in-search.html">5.3. Configuration des champs ObjectGroup devant être exclus de la recherche</a></li>
<li class="toctree-l2"><a class="reference internal" href="11-adminportals.html">5.4. Portails d’administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="12-appconfig.html">5.5. Paramétrage &amp; configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="14-miseajour.html">5.6. Déploiement / mises à jour</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.7. Interruption / maintenance</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#procedure-d-arret-complet">5.7.1. Procédure d’arrêt complet</a></li>
<li class="toctree-l3"><a class="reference internal" href="#procedure-de-demarrage-complet">5.7.2. Procédure de démarrage complet</a></li>
<li class="toctree-l3"><a class="reference internal" href="#procedure-de-statut">5.7.3. Procédure de statut</a></li>
<li class="toctree-l3"><a class="reference internal" href="#autres-cas">5.7.4. Autres cas</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#procedure-de-maintenance-indisponibilite-de-vitam">5.7.4.1. Procédure de maintenance / indisponibilité de VITAM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#procedure-de-maintenance-liee-aux-timers-systemd">5.7.4.2. Procédure de maintenance liée aux <cite>timers systemD</cite></a></li>
<li class="toctree-l4"><a class="reference internal" href="#procedure-de-maintenance-sur-les-composants-d-administration">5.7.4.3. Procédure de maintenance sur les composants d’administration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#procedure-de-maintenance-des-ihm">5.7.4.4. Procédure de maintenance des <cite>IHM</cite></a></li>
<li class="toctree-l4"><a class="reference internal" href="#procedure-de-maintenance-des-bases-de-donnees-metier">5.7.4.5. Procédure de maintenance des <cite>Bases de données métier</cite></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="16-backup_restore.html">5.8. Sauvegarde / restauration</a></li>
<li class="toctree-l2"><a class="reference internal" href="17-backup_restore_gros_volume.html">5.9. Sauvegarde et restauration de mongodb gros volumes</a></li>
<li class="toctree-l2"><a class="reference internal" href="18-securityprofile.html">5.10. Gestion des profils de sécurité</a></li>
<li class="toctree-l2"><a class="reference internal" href="19-certificatpersonae.html">5.11. Certificats personae</a></li>
<li class="toctree-l2"><a class="reference internal" href="19-grouped_tenants.html">5.12. Gestion des indexes Elasticseach dans un contexte massivement multi-tenants</a></li>
<li class="toctree-l2"><a class="reference internal" href="20-batchs.html">5.13. Batchs et traitements</a></li>
<li class="toctree-l2"><a class="reference internal" href="21-graphstorage.html">5.14. Sauvegarde des données graphe (Log shipping)</a></li>
<li class="toctree-l2"><a class="reference internal" href="22-graphcompute.html">5.15. Recalcul des données graphe</a></li>
<li class="toctree-l2"><a class="reference internal" href="23-siegfried_signature.html">5.16. Montée de version du fichier de signature de Siegfried</a></li>
<li class="toctree-l2"><a class="reference internal" href="24-griffins.html">5.17. Griffins</a></li>
<li class="toctree-l2"><a class="reference internal" href="30-reconstruction.html">5.18. Reconstruction</a></li>
<li class="toctree-l2"><a class="reference internal" href="31-pra.html">5.19. Plan de Reprise d’Activité (<code class="docutils literal notranslate"><span class="pre">PRA</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="40-resynchronisation.html">5.20. Resynchronisation d’une offre</a></li>
<li class="toctree-l2"><a class="reference internal" href="45-offerdiff.html">5.21. Audit comparatif entre 2 offres de stockage miroirs</a></li>
<li class="toctree-l2"><a class="reference internal" href="50-ontologies.html">5.22. Procédure d’exploitation suite à la création ou la modification d’une ontologie</a></li>
<li class="toctree-l2"><a class="reference internal" href="50-ontologies.html#l-ontologie-externe-suite-a-la-montee-de-version-de-vitam">5.23. L’ontologie externe suite à la montée de version de <code class="docutils literal notranslate"><span class="pre">VITAM</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="60-forcedpause.html">5.24. Procédure d’exploitation pour la mise en pause forcée d’une opération</a></li>
<li class="toctree-l2"><a class="reference internal" href="60-reindexation.html">5.25. Réindexation</a></li>
<li class="toctree-l2"><a class="reference internal" href="65-ingest-cleanup.html">5.26. Nettoyage des ingests incomplets</a></li>
<li class="toctree-l2"><a class="reference internal" href="66-dip-cleanup.html">5.27. Suppression des DIP et des fichiers de transfert</a></li>
<li class="toctree-l2"><a class="reference internal" href="70-certificate-revocation.html">5.28. Procédure d’exploitation pour la révocation des certificats SIA et Personae</a></li>
<li class="toctree-l2"><a class="reference internal" href="80-offer-activation.html">5.29. Activation/désactivation d’une offre</a></li>
<li class="toctree-l2"><a class="reference internal" href="90-environment-cleaning.html">5.30. Nettoyage d’un environnement</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../monitoring/_toc.html">6. Suivi de l’état du système</a></li>
<li class="toctree-l1"><a class="reference internal" href="../composants/_toc.html">7. Exploitation des COTS de la solution logicielle VITAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../include/_toc.html">8. Exploitation des composants de la solution logicielle VITAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../external_app.html">9. Intégration d’une application externe dans Vitam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshoot/_toc.html">10. Aide à l’exploitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FAQ/_toc.html">11. Questions Fréquemment Posées</a></li>
<li class="toctree-l1"><a class="reference internal" href="../annexes/_toc.html">12. Annexes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">VITAM - Documentation d'exploitation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="_toc.html">5. Exploitation globale</a></li>
      <li class="breadcrumb-item active">5.7. Interruption / maintenance</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/topics/15-maintenance.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="interruption-maintenance">
<h1>5.7. Interruption / maintenance<a class="headerlink" href="#interruption-maintenance" title="Lien permanent vers ce titre">¶</a></h1>
<div class="section" id="procedure-d-arret-complet">
<h2>5.7.1. Procédure d’arrêt complet<a class="headerlink" href="#procedure-d-arret-complet" title="Lien permanent vers ce titre">¶</a></h2>
<p>Un playbook ansible d’arrêt complet de la solution logicielle <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> est fourni, sous <code class="docutils literal notranslate"><span class="pre">deployment/ansible-vitam-exploitation/stop_vitam.yml</span></code>, pour réaliser de façon automatisée les actions nécessaires. Ce playbook arrête aussi les timers systemD associés aux composants <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a>.</p>
<div class="admonition warning">
<p class="first admonition-title">Avertissement</p>
<p class="last">Ce script, en l’état, permet un <cite>EMERGENCY BREAK</cite>, autrement dit un arrêt brutal des composants, ne permettant pas de garantir, à l’issue, une cohérence des données. Il est donc fortement recommandé de positionner les traitements courants en pause avant de lancer la procédure d’arrêt.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Une confirmation est demandée pour lancer ce script d’arrêt de la solution logicielle VITAM. Cette confirmation peut être automatisée en utilisant les extra-vars d’ansible <code class="docutils literal notranslate"><span class="pre">-e</span> <span class="pre">&quot;confirmation=yes&quot;</span></code></p>
</div>
</div>
<div class="section" id="procedure-de-demarrage-complet">
<h2>5.7.2. Procédure de démarrage complet<a class="headerlink" href="#procedure-de-demarrage-complet" title="Lien permanent vers ce titre">¶</a></h2>
<p>Les machines hébergeant la solution logicielle <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> doivent être allumées et en état de fonctionnement pour exécuter cette procédure.</p>
<p>Un playbook ansible de démarrage complet de la solution logicielle <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> est fourni, sous <code class="docutils literal notranslate"><span class="pre">deployment/ansible-vitam-exploitation/start_vitam.yml</span></code>, pour réaliser de façon automatisée les actions nécessaires. Ce playbook démarre aussi les timers systemD associés aux composants <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a>.</p>
</div>
<div class="section" id="procedure-de-statut">
<h2>5.7.3. Procédure de statut<a class="headerlink" href="#procedure-de-statut" title="Lien permanent vers ce titre">¶</a></h2>
<p>Un playbook ansible est fourni, sous <code class="docutils literal notranslate"><span class="pre">deployment/ansible-vitam-exploitation/status_vitam.yml</span></code>, pour réaliser de façon automatisée les «&nbsp;autotest&nbsp;» intégrés dans la solution logicielle <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a>.</p>
</div>
<div class="section" id="autres-cas">
<h2>5.7.4. Autres cas<a class="headerlink" href="#autres-cas" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="procedure-de-maintenance-indisponibilite-de-vitam">
<h3>5.7.4.1. Procédure de maintenance / indisponibilité de VITAM<a class="headerlink" href="#procedure-de-maintenance-indisponibilite-de-vitam" title="Lien permanent vers ce titre">¶</a></h3>
<p>Deux playbooks ansible sont fournis dans <code class="docutils literal notranslate"><span class="pre">deployment/ansible-vitam-exploitation</span></code> :</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">stop_external.yml</span></code> : permettant d’arrêter uniquement les composants <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> <strong>ingest-external</strong> et <strong>access-external</strong></li>
<li><code class="docutils literal notranslate"><span class="pre">start_external.yml</span></code> : permettant de démarrer uniquement les composants <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> <strong>ingest-external</strong> et <strong>access-external</strong></li>
</ul>
<p>Ces playbooks permettent d’empêcher l’accès à la solution logicielle <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> par les services versants, tout en laissant opérationnel le reste de la solution logicielle. Ils peuvent être utiles, voire nécessaires, dans le cadre d’une migration de données ou de maintenance de la solution logicielle <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a>.</p>
<p>Ils ne stoppent donc pas:</p>
<ul class="simple">
<li>Les versements qui sont encore en cours de traitement (il est toutefois possible de les mettre en pause via ihm-demo par exemple)</li>
<li>Les timers qui lancent divers traitements comme des sécurisations, pour cela, se référer au chapitre suivant</li>
</ul>
</div>
<div class="section" id="procedure-de-maintenance-liee-aux-timers-systemd">
<h3>5.7.4.2. Procédure de maintenance liée aux <cite>timers systemD</cite><a class="headerlink" href="#procedure-de-maintenance-liee-aux-timers-systemd" title="Lien permanent vers ce titre">¶</a></h3>
<p>Deux playbooks ansible sont fournis dans <code class="docutils literal notranslate"><span class="pre">deployment/ansible-vitam-exploitation</span></code> :</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">stop_vitam_scheduling.yml</span></code> : permettant d’arrêter uniquement les <cite>Jobs Vitam</cite></li>
<li><code class="docutils literal notranslate"><span class="pre">start_vitam_scheduling.yml</span></code> : permettant de démarrer uniquement les <cite>Jobs Vitam</cite>. Ce playbook est à lancer une fois le démarrage des services correctement réalisé.</li>
</ul>
</div>
<div class="section" id="procedure-de-maintenance-sur-les-composants-d-administration">
<h3>5.7.4.3. Procédure de maintenance sur les composants d’administration<a class="headerlink" href="#procedure-de-maintenance-sur-les-composants-d-administration" title="Lien permanent vers ce titre">¶</a></h3>
<p>Deux playbooks sont fournis dans <code class="docutils literal notranslate"><span class="pre">deployment/ansible-vitam-exploitation</span></code> :</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">stop_vitam_admin.yml</span></code> : permettant d’arrêter sélectivement les composants Consul, la chaine de log (logstash / cluster elasticsearch-log / kibana-log), cerebro et les docker mongo-express et elasticsearch-head</li>
<li><code class="docutils literal notranslate"><span class="pre">start_vitam_admin.yml</span></code> : permettant de démarrer sélectivement les composants Consul, la chaine de log (logstash / cluster elasticsearch-log / kibana-log), cerebro et les docker mongo-express et elasticsearch-head</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Avertissement</p>
<p class="last">En passant le playbook d’arrêt, l’ensemble de la solution logicielle <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> devient inutilisable.</p>
</div>
</div>
<div class="section" id="procedure-de-maintenance-des-ihm">
<h3>5.7.4.4. Procédure de maintenance des <cite>IHM</cite><a class="headerlink" href="#procedure-de-maintenance-des-ihm" title="Lien permanent vers ce titre">¶</a></h3>
<p>Deux playbooks sont fournis dans <code class="docutils literal notranslate"><span class="pre">deployment/ansible-vitam-exploitation</span></code> :</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">stop_vitam_ihm.yml</span></code> : permettant d’arrêter sélectivement les composants <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> <a class="reference internal" href="../introduction.html#term-ihm"><span class="xref std std-term">IHM</span></a> ihm-demo et ihm-recette</li>
<li><code class="docutils literal notranslate"><span class="pre">start_vitam_ihm.yml</span></code> : permettant de démarrer sélectivement les composants <a class="reference internal" href="../introduction.html#term-vitam"><span class="xref std std-term">VITAM</span></a> <a class="reference internal" href="../introduction.html#term-ihm"><span class="xref std std-term">IHM</span></a> ihm-demo et ihm-recette</li>
</ul>
</div>
<div class="section" id="procedure-de-maintenance-des-bases-de-donnees-metier">
<h3>5.7.4.5. Procédure de maintenance des <cite>Bases de données métier</cite><a class="headerlink" href="#procedure-de-maintenance-des-bases-de-donnees-metier" title="Lien permanent vers ce titre">¶</a></h3>
<p>Quatre playbooks sont fournis dans <code class="docutils literal notranslate"><span class="pre">deployment/ansible-vitam-exploitation</span></code> :</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">start_elasticsearch_data.yml</span></code> : pemettant de démarrer le cluster elasticsearch-data</li>
<li><code class="docutils literal notranslate"><span class="pre">start_mongodb.yml</span></code> : permettant de démarrer les clusters mongodb (mongo-data &amp; mongo-offer)</li>
<li><code class="docutils literal notranslate"><span class="pre">stop_elasticsearch_data.yml</span></code> : permettant d’arrêter le cluster elasticsearch-data</li>
<li><code class="docutils literal notranslate"><span class="pre">stop_mongodb.yml</span></code> : permettant d’arrêter les clusters mongodb (mongo-data &amp; mongo-offer)</li>
</ul>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="14-miseajour.html" class="btn btn-neutral float-left" title="5.6. Déploiement / mises à jour" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="16-backup_restore.html" class="btn btn-neutral float-right" title="5.8. Sauvegarde / restauration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Ce document est distribué sous les termes de la Licence Ouverte V2.0.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
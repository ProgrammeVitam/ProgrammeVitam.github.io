

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ingest-external-antivirus &mdash; documentation VITAM - Manuel de développement 0.11.1</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Recherche" href="../../search.html"/>
    <link rel="top" title="documentation VITAM - Manuel de développement 0.11.1" href="../../index.html"/>
        <link rel="up" title="Ingest" href="_toc.html"/>
        <link rel="next" title="Logbook" href="../logbook/_toc.html"/>
        <link rel="prev" title="ingest-external-client" href="ingest-external-client.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> VITAM - Manuel de développement
          

          
            
            <img src="../../_static/LogoVitamGrand2.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.11.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../_toc.html">Détails par composant</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../access/_toc.html">Access</a></li>
<li class="toctree-l2"><a class="reference internal" href="../common/_toc.html">Common</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functional-administration/_toc.html">Functional administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ihm-demo/_toc.html">IHM demo</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="_toc.html">Ingest</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="ingest-internal-dat.html">DAT : module ingest-internal</a></li>
<li class="toctree-l3"><a class="reference internal" href="ingest-internal-client.html">ingest-internal-client</a></li>
<li class="toctree-l3"><a class="reference internal" href="ingest-internal-client.html#utilisation">Utilisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="ingest-external-client.html">ingest-external-client</a></li>
<li class="toctree-l3"><a class="reference internal" href="ingest-external-client.html#utilisation">Utilisation</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">ingest-external-antivirus</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../logbook/_toc.html">Logbook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metadata/_toc.html">Metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../processing/_toc.html">Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../storage/_toc.html">Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../technical-administration/_toc.html">Technical administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../worker/_toc.html">Worker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../workspace/_toc.html">Workspace</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../parallisation_tests.html">Parallélisation des tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parallisation_tests.html#separation-des-tests-tdd-et-tests-d-integration">Séparation des tests TDD et tests d&#8217;intégration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parallisation_tests.html#parallelisation-de-tests-unitaires">Parallélisation de tests unitaires</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parallisation_tests.html#configuration-de-build-avec-les-options-de-tests">Configuration de build avec les options de tests</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">VITAM - Manuel de développement</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../_toc.html">Détails par composant</a> &raquo;</li>
      
          <li><a href="_toc.html">Ingest</a> &raquo;</li>
      
    <li>ingest-external-antivirus</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/include/ingest/ingest-external-antivirus.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ingest-external-antivirus">
<h1>ingest-external-antivirus<a class="headerlink" href="#ingest-external-antivirus" title="Lien permanent vers ce titre">¶</a></h1>
<p>Dans cette section, nous expliquons comment utiliser et configurer le script d&#8217;antivirus
pour le service ingest-external.</p>
<ol class="arabic">
<li><dl class="first docutils">
<dt>Configuration pour ingest-external</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ingest-external.conf</span><dd><p class="first">Dans ce fichier de configuration, nous précisons le nom de la script antivirus utilisé et
le temps limité pour le scan. pour le moment, nous utilisons le script de scan scan-clamav.sh
utilisant l’antivirus ClamAV.</p>
<blockquote class="last">
<div><p>antiVirusScriptName : scan-clamav.sh
timeoutScanDelay : 60000</p>
</div></blockquote>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Script d&#8217;antivirus scan-clamav.sh</dt>
<dd><p class="first">Le script permettant de lancer d&#8217;un scan d’un fichier envoyé avec l’antivirus ClamAV et
retourner le résulat :</p>
<blockquote>
<div><p>0: Analyse OK - no virus
1: Virus trouvé et corrigé
2: Virus trouvé mais non corrigé
3: Analyse NOK</p>
</div></blockquote>
<p class="last">Ce fichier est mis dans le répertoire vitam/conf avec le droit d&#8217;exécution.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Lancer le script en Java et intégration</dt>
<dd><blockquote class="first">
<div><p>JavaExecuteScript.java (se trouve dans ingest-external-common) permettant de lancer le script de clamav
en Java en prenant des paramètres d&#8217;entrées : le script utilisé, le chemin du fichier à scanner et
le temps limité d&#8217;un scan</p>
<p>Pour l&#8217;intégration dans ingest-external, ce script est appelé dans l&#8217;implémentation des APIs de ingest-externe.</p>
</div></blockquote>
<p>la section suivant montre comment on appelle le script depuis ingest-external en Code.</p>
<p>........Java Code...................................................................................</p>
<p>antiVirusResult = JavaExecuteScript.executeCommand(antiVirusScriptName, filePath, timeoutScanDelay);</p>
<dl class="last docutils">
<dt>switch (antiVirusResult) {</dt>
<dd><blockquote class="first last">
<div><dl class="docutils">
<dt>case 0:</dt>
<dd><p class="first">LOGGER.info(IngestExternalOutcomeMessage.OK_VIRUS.toString());
endParameters.setStatus(LogbookOutcome.OK);
endParameters.putParameterValue(LogbookParameterName.outcomeDetailMessage,</p>
<blockquote>
<div><p>IngestExternalOutcomeMessage.OK_VIRUS.value());</p>
</div></blockquote>
<p class="last">break;</p>
</dd>
<dt>case 1:</dt>
<dd><p class="first">LOGGER.debug(IngestExternalOutcomeMessage.OK_VIRUS.toString());
endParameters.setStatus(LogbookOutcome.OK);
endParameters.putParameterValue(LogbookParameterName.outcomeDetailMessage,</p>
<blockquote>
<div><p>IngestExternalOutcomeMessage.KO_VIRUS.value());</p>
</div></blockquote>
<p class="last">break;</p>
</dd>
<dt>case 2:</dt>
<dd><p class="first">LOGGER.error(IngestExternalOutcomeMessage.KO_VIRUS.toString());
endParameters.setStatus(LogbookOutcome.KO);
endParameters.putParameterValue(LogbookParameterName.outcomeDetailMessage,</p>
<blockquote>
<div><p>IngestExternalOutcomeMessage.KO_VIRUS.value());</p>
</div></blockquote>
<p class="last">isFileInfected = true;
break;</p>
</dd>
<dt>default:</dt>
<dd><p class="first">LOGGER.error(IngestExternalOutcomeMessage.KO_VIRUS.toString());
endParameters.setStatus(LogbookOutcome.FATAL);
endParameters.putParameterValue(LogbookParameterName.outcomeDetailMessage,</p>
<blockquote>
<div><p>IngestExternalOutcomeMessage.KO_VIRUS.value());</p>
</div></blockquote>
<p class="last">isFileInfected = true;</p>
</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</dd>
</dl>
</li>
</ol>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../logbook/_toc.html" class="btn btn-neutral float-right" title="Logbook" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ingest-external-client.html" class="btn btn-neutral" title="ingest-external-client" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Ce document est distribué sous les termes de la licence Creative Commons Attribution - Partage dans les Mêmes Conditions 3.0 France (CC BY-SA 3.0 FR).

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.11.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
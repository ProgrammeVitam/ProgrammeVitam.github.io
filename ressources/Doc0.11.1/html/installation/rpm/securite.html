

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>9.2.1. Configuration de sécurité &mdash; documentation VITAM - Documentation d&#39;installation 0.11.1</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Recherche" href="../search.html"/>
    <link rel="top" title="documentation VITAM - Documentation d&#39;installation 0.11.1" href="../index.html"/>
        <link rel="up" title="9. Procédures d’installation / mise à jour : Package RPM" href="_toc.html"/>
        <link rel="next" title="9.2.2. Explications relatives à la PKI" href="pki.html"/>
        <link rel="prev" title="9. Procédures d’installation / mise à jour : Package RPM" href="_toc.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> VITAM - Documentation d'installation
          

          
            
            <img src="../_static/LogoVitamGrand2.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.11.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html#rappels">2. Rappels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">3. Architecture de la solution logicielle VITAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prerequis.html">4. Pré-requis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10-it-services.html">5. Dépendances aux services d&#8217;infrastructures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fiche_type.html">6. Fiche type de déploiement VITAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fiche_type.html#guidelines-de-deploiement">7. Guidelines de déploiement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_version.html">8. Récupération de la version</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="_toc.html">9. Procédures d&#8217;installation / mise à jour : Package RPM</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="_toc.html#pre-requis-supplementaire">9.1. Pré-requis supplémentaire</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="_toc.html#procedures">9.2. Procédures</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">9.2.1. Configuration de sécurité</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#authentification-du-compte-utilisateur-utilise-pour-la-connexion-ssh">9.2.1.1. Authentification du compte utilisateur utilisé pour la connexion SSH</a></li>
<li class="toctree-l4"><a class="reference internal" href="#authentification-des-hotes">9.2.1.2. Authentification des hôtes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#elevation-de-privileges">9.2.1.3. Elevation de privilèges</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pki.html">9.2.2. Explications relatives à la PKI</a></li>
<li class="toctree-l3"><a class="reference internal" href="fresh_install.html">9.2.3. Procédure de première installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="update.html">9.2.4. Procédure de mise à niveau</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../validation_deploiement.html">10. Validation de la procédure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">11. Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extras.html">12. Elements extras de l&#8217;installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contacts.html">13. Contacts et support</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">VITAM - Documentation d'installation</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="_toc.html">9. Procédures d&#8217;installation / mise à jour : Package RPM</a> &raquo;</li>
      
    <li>9.2.1. Configuration de sécurité</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/rpm/securite.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="configuration-de-securite">
<h1>9.2.1. Configuration de sécurité<a class="headerlink" href="#configuration-de-securite" title="Lien permanent vers ce titre">¶</a></h1>
<p>En fonction de la méthode d&#8217;authentification sur les serveurs et d&#8217;élevation de privilège, il faut rajouter des options aux lignes de commande ansible. Ces options seront à rajouter pour toutes les commandes ansible du document .</p>
<p>Pour chacune des 3 sections suivantes, vous devez être dans l&#8217;un des cas décrits</p>
<div class="section" id="authentification-du-compte-utilisateur-utilise-pour-la-connexion-ssh">
<h2>9.2.1.1. Authentification du compte utilisateur utilisé pour la connexion SSH<a class="headerlink" href="#authentification-du-compte-utilisateur-utilise-pour-la-connexion-ssh" title="Lien permanent vers ce titre">¶</a></h2>
<p>Pour le login du compte utilisateur, voir le paragraphe décrivant le fichier d&#8217;inventaire</p>
<div class="section" id="par-cle-ssh-avec-passphrase">
<h3>9.2.1.1.1. Par clé SSH avec passphrase<a class="headerlink" href="#par-cle-ssh-avec-passphrase" title="Lien permanent vers ce titre">¶</a></h3>
<p>Dans le cas d&#8217;une authentification par clé avec passphrase, il est nécessaire d&#8217;utiliser ssh-agent pour mémoriser la clé privée. Pour ce faire, il faut :</p>
<blockquote>
<div><ul class="simple">
<li>exécuter la commande <code class="docutils literal"><span class="pre">ssh-agent</span> <span class="pre">&lt;shell</span> <span class="pre">utilisé&gt;</span></code> (exemple <code class="docutils literal"><span class="pre">ssh-agent</span> <span class="pre">/bin/bash</span></code>) pour lancer un shell avec un agent de mémorisation de la clé privée associé à ce shell</li>
<li>exécuter la commande <code class="docutils literal"><span class="pre">ssh-add</span></code> et renseigner la passphrase de la clé privée</li>
</ul>
</div></blockquote>
<p>Vous pouvez maintenant lancer les commandes ansible comme décrites dans ce document.</p>
<p>A noter : ssh-agent est un démon qui va stocker les clés privées (déchiffrées) en mémoire et que le client ssh va interroger pour récupérer les informations privées pour initier la connexion. La liaison se fait par un socket UNIX présent dans /tmp (avec les droits 600 pour l&#8217;utilisateur qui a lancé le ssh-agent). Cet agent disparaît avec le shell qui l&#8217;a lancé.</p>
</div>
<div class="section" id="par-login-mot-de-passe">
<h3>9.2.1.1.2. Par login/mot de passe<a class="headerlink" href="#par-login-mot-de-passe" title="Lien permanent vers ce titre">¶</a></h3>
<p>Dans le cas d&#8217;une authentificatioon par login/mot de passe, il est nécessaire de spécifier l&#8217;option &#8211;ask-pass (ou -k en raccourci) aux commandes ansible ou ansible-playbook de ce document .</p>
<p>Au lancement de la commande <code class="docutils literal"><span class="pre">ansible</span></code> (ou <code class="docutils literal"><span class="pre">ansible-playbook</span></code>), il sera demandé le mot de passe</p>
</div>
<div class="section" id="par-cle-ssh-sans-passphrase">
<h3>9.2.1.1.3. Par clé SSH sans passphrase<a class="headerlink" href="#par-cle-ssh-sans-passphrase" title="Lien permanent vers ce titre">¶</a></h3>
<p>Dans ce cas, il n&#8217;y a pas de paramétrage particulier à effectuer.</p>
</div>
</div>
<div class="section" id="authentification-des-hotes">
<h2>9.2.1.2. Authentification des hôtes<a class="headerlink" href="#authentification-des-hotes" title="Lien permanent vers ce titre">¶</a></h2>
<p>Pour éviter les attaques de type <a class="reference internal" href="../introduction.html#term-mitm"><span class="xref std std-term">MitM</span></a>, le client SSH cherche à authentifier le serveur sur lequel il se connecte. Ceci se base généralement sur le stockage des clés publiques des serveurs auxquels il faut faire confiance (~/.ssh/known_hosts).</p>
<p>Il existe différentes méthodes pour remplir ce fichier (vérification humaine à la première connexion, gestion centralisée, <a class="reference internal" href="../introduction.html#term-dnssec"><span class="xref std std-term">DNSSEC</span></a>). La gestion de fichier est hors périmètre Vitam mais c&#8217;est un pré-requis pour le lancement d&#8217;ansible.</p>
</div>
<div class="section" id="elevation-de-privileges">
<h2>9.2.1.3. Elevation de privilèges<a class="headerlink" href="#elevation-de-privileges" title="Lien permanent vers ce titre">¶</a></h2>
<p>Une fois que l&#8217;on est connecté  sur le serveur cible, il faut définir la méthode pour accéder aux droits root</p>
<div class="section" id="par-sudo-avec-mot-de-passe">
<h3>9.2.1.3.1. Par sudo avec mot de passe<a class="headerlink" href="#par-sudo-avec-mot-de-passe" title="Lien permanent vers ce titre">¶</a></h3>
<p>Dans ce cas, il faut rajouter les options &#8211;ask-sudo-pass</p>
<p>Au lancement de la commande ansible (ou ansible-playbook), il sera demandé le mot de passe demandé par sudo</p>
</div>
<div class="section" id="par-su">
<h3>9.2.1.3.2. Par su<a class="headerlink" href="#par-su" title="Lien permanent vers ce titre">¶</a></h3>
<p>Dans ce cas, il faut rajouter les options &#8211;become-method=su &#8211;ask-su-pass</p>
<p>Au lancement de la commande ansible (ou ansible-playbook), il sera demandé le mot de passe root</p>
</div>
<div class="section" id="par-sudo-sans-mot-de-passe">
<h3>9.2.1.3.3. Par sudo sans mot de passe<a class="headerlink" href="#par-sudo-sans-mot-de-passe" title="Lien permanent vers ce titre">¶</a></h3>
<p>Il n&#8217;y a pas d&#8217;option à rajouter (l&#8217;élévation par sudo est la configuration par défaut)</p>
</div>
<div class="section" id="deja-root">
<h3>9.2.1.3.4. Déjà Root<a class="headerlink" href="#deja-root" title="Lien permanent vers ce titre">¶</a></h3>
<p>Dans ce cas, il n&#8217;y a pas de paramétrages supplémentaire</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pki.html" class="btn btn-neutral float-right" title="9.2.2. Explications relatives à la PKI" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="_toc.html" class="btn btn-neutral" title="9. Procédures d’installation / mise à jour : Package RPM" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Ce document est distribué sous les termes de la licence Creative Commons Attribution - Partage dans les Mêmes Conditions 3.0 France (CC BY-SA 3.0 FR).

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.11.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>